{
	"cases": [
		{
			"note": "refheads/single-value",
			"query": "data.test.p = x",
			"modules": [
				"package test\n\np.q.r := 1\n\np.q.s := 2\n"
			],
			"want_result": [
				{
					"x": {
						"q": {
							"r": 1,
							"s": 2
						}
					}
				}
			],
			"entrypoints": [
				"test"
			],
			"plan": {
				"funcs": {
					"funcs": [
						{
							"blocks": [
								{
									"stmts": [
										{
											"stmt": {
												"col": 1,
												"file": 0,
												"row": 3,
												"target": 3
											},
											"type": "ResetLocalStmt"
										},
										{
											"stmt": {
												"Index": 4,
												"col": 1,
												"file": 0,
												"row": 3,
												"target": 4
											},
											"type": "MakeNumberRefStmt"
										},
										{
											"stmt": {
												"col": 1,
												"file": 0,
												"row": 3,
												"source": {
													"type": "local",
													"value": 4
												},
												"target": 3
											},
											"type": "AssignVarOnceStmt"
										}
									]
								},
								{
									"stmts": [
										{
											"stmt": {
												"col": 1,
												"file": 0,
												"row": 3,
												"source": 3
											},
											"type": "IsDefinedStmt"
										},
										{
											"stmt": {
												"col": 1,
												"file": 0,
												"row": 3,
												"source": {
													"type": "local",
													"value": 3
												},
												"target": 2
											},
											"type": "AssignVarOnceStmt"
										}
									]
								},
								{
									"stmts": [
										{
											"stmt": {
												"col": 1,
												"file": 0,
												"row": 3,
												"source": 2
											},
											"type": "ReturnLocalStmt"
										}
									]
								}
							],
							"name": "g0.data.test.p.q.r",
							"params": [
								0,
								1
							],
							"path": [
								"g0",
								"test",
								"p",
								"q",
								"r"
							],
							"return": 2
						},
						{
							"blocks": [
								{
									"stmts": [
										{
											"stmt": {
												"col": 1,
												"file": 0,
												"row": 5,
												"target": 3
											},
											"type": "ResetLocalStmt"
										},
										{
											"stmt": {
												"Index": 6,
												"col": 1,
												"file": 0,
												"row": 5,
												"target": 4
											},
											"type": "MakeNumberRefStmt"
										},
										{
											"stmt": {
												"col": 1,
												"file": 0,
												"row": 5,
												"source": {
													"type": "local",
													"value": 4
												},
												"target": 3
											},
											"type": "AssignVarOnceStmt"
										}
									]
								},
								{
									"stmts": [
										{
											"stmt": {
												"col": 1,
												"file": 0,
												"row": 5,
												"source": 3
											},
											"type": "IsDefinedStmt"
										},
										{
											"stmt": {
												"col": 1,
												"file": 0,
												"row": 5,
												"source": {
													"type": "local",
													"value": 3
												},
												"target": 2
											},
											"type": "AssignVarOnceStmt"
										}
									]
								},
								{
									"stmts": [
										{
											"stmt": {
												"col": 1,
												"file": 0,
												"row": 5,
												"source": 2
											},
											"type": "ReturnLocalStmt"
										}
									]
								}
							],
							"name": "g0.data.test.p.q.s",
							"params": [
								0,
								1
							],
							"path": [
								"g0",
								"test",
								"p",
								"q",
								"s"
							],
							"return": 2
						}
					]
				},
				"plans": {
					"plans": [
						{
							"blocks": [
								{
									"stmts": [
										{
											"stmt": {
												"col": 0,
												"file": 0,
												"row": 0,
												"target": 2
											},
											"type": "MakeObjectStmt"
										},
										{
											"stmt": {
												"col": 0,
												"file": 0,
												"row": 0,
												"target": 3
											},
											"type": "MakeObjectStmt"
										},
										{
											"stmt": {
												"col": 0,
												"file": 0,
												"row": 0,
												"target": 4
											},
											"type": "MakeObjectStmt"
										},
										{
											"stmt": {
												"blocks": [
													{
														"stmts": [
															{
																"stmt": {
																	"args": [
																		{
																			"type": "local",
																			"value": 0
																		},
																		{
																			"type": "local",
																			"value": 1
																		}
																	],
																	"col": 0,
																	"file": 0,
																	"func": "g0.data.test.p.q.r",
																	"result": 5,
																	"row": 0
																},
																"type": "CallStmt"
															},
															{
																"stmt": {
																	"col": 0,
																	"file": 0,
																	"key": {
																		"type": "string_index",
																		"value": 3
																	},
																	"object": 4,
																	"row": 0,
																	"value": {
																		"type": "local",
																		"value": 5
																	}
																},
																"type": "ObjectInsertStmt"
															}
														]
													}
												],
												"col": 0,
												"file": 0,
												"row": 0
											},
											"type": "BlockStmt"
										},
										{
											"stmt": {
												"blocks": [
													{
														"stmts": [
															{
																"stmt": {
																	"args": [
																		{
																			"type": "local",
																			"value": 0
																		},
																		{
																			"type": "local",
																			"value": 1
																		}
																	],
																	"col": 0,
																	"file": 0,
																	"func": "g0.data.test.p.q.s",
																	"result": 6,
																	"row": 0
																},
																"type": "CallStmt"
															},
															{
																"stmt": {
																	"col": 0,
																	"file": 0,
																	"key": {
																		"type": "string_index",
																		"value": 5
																	},
																	"object": 4,
																	"row": 0,
																	"value": {
																		"type": "local",
																		"value": 6
																	}
																},
																"type": "ObjectInsertStmt"
															}
														]
													}
												],
												"col": 0,
												"file": 0,
												"row": 0
											},
											"type": "BlockStmt"
										},
										{
											"stmt": {
												"col": 0,
												"file": 0,
												"key": {
													"type": "string_index",
													"value": 2
												},
												"object": 3,
												"row": 0,
												"value": {
													"type": "local",
													"value": 4
												}
											},
											"type": "ObjectInsertStmt"
										},
										{
											"stmt": {
												"col": 0,
												"file": 0,
												"key": {
													"type": "string_index",
													"value": 1
												},
												"object": 2,
												"row": 0,
												"value": {
													"type": "local",
													"value": 3
												}
											},
											"type": "ObjectInsertStmt"
										},
										{
											"stmt": {
												"blocks": [
													{
														"stmts": [
															{
																"stmt": {
																	"blocks": [
																		{
																			"stmts": [
																				{
																					"stmt": {
																						"col": 0,
																						"file": 0,
																						"key": {
																							"type": "string_index",
																							"value": 7
																						},
																						"row": 0,
																						"source": {
																							"type": "local",
																							"value": 1
																						},
																						"target": 8
																					},
																					"type": "DotStmt"
																				},
																				{
																					"stmt": {
																						"a": 8,
																						"b": 2,
																						"col": 0,
																						"file": 0,
																						"row": 0,
																						"target": 7
																					},
																					"type": "ObjectMergeStmt"
																				},
																				{
																					"stmt": {
																						"col": 0,
																						"file": 0,
																						"index": 1,
																						"row": 0
																					},
																					"type": "BreakStmt"
																				}
																			]
																		}
																	],
																	"col": 0,
																	"file": 0,
																	"row": 0
																},
																"type": "BlockStmt"
															},
															{
																"stmt": {
																	"col": 0,
																	"file": 0,
																	"row": 0,
																	"source": {
																		"type": "local",
																		"value": 2
																	},
																	"target": 7
																},
																"type": "AssignVarStmt"
															}
														]
													}
												],
												"col": 0,
												"file": 0,
												"row": 0
											},
											"type": "BlockStmt"
										},
										{
											"stmt": {
												"col": 0,
												"file": 0,
												"row": 0,
												"source": {
													"type": "local",
													"value": 7
												},
												"target": 9
											},
											"type": "AssignVarStmt"
										},
										{
											"stmt": {
												"col": 0,
												"file": 0,
												"row": 0,
												"target": 10
											},
											"type": "MakeObjectStmt"
										},
										{
											"stmt": {
												"col": 0,
												"file": 0,
												"key": {
													"type": "string_index",
													"value": 0
												},
												"object": 10,
												"row": 0,
												"value": {
													"type": "local",
													"value": 9
												}
											},
											"type": "ObjectInsertStmt"
										},
										{
											"stmt": {
												"col": 0,
												"file": 0,
												"row": 0,
												"value": 10
											},
											"type": "ResultSetAddStmt"
										}
									]
								}
							],
							"name": "test"
						}
					]
				},
				"static": {
					"files": [
						{
							"value": "mod_0"
						}
					],
					"strings": [
						{
							"value": "result"
						},
						{
							"value": "p"
						},
						{
							"value": "q"
						},
						{
							"value": "r"
						},
						{
							"value": "1"
						},
						{
							"value": "s"
						},
						{
							"value": "2"
						},
						{
							"value": "test"
						}
					]
				}
			},
			"want_plan_result": {
				"data_test": {
					"p": {
						"q": {
							"r": 1,
							"s": 2
						}
					}
				}
			}
		},
		{
			"note": "refheads/single-value, with var",
			"query": "data.test.p = x",
			"modules": [
				"package test\n\np.q.r := 1\n\np.q[s] := 2 if s := \"s\"\n"
			],
			"want_result": [
				{
					"x": {
						"q": {
							"r": 1,
							"s": 2
						}
					}
				}
			],
			"entrypoints": [
				"test"
			],
			"plan": {
				"funcs": {
					"funcs": [
						{
							"blocks": [
								{
									"stmts": [
										{
											"stmt": {
												"col": 1,
												"file": 0,
												"row": 3,
												"target": 2
											},
											"type": "MakeObjectStmt"
										}
									]
								},
								{
									"stmts": [
										{
											"stmt": {
												"col": 1,
												"file": 0,
												"row": 3,
												"target": 3
											},
											"type": "ResetLocalStmt"
										},
										{
											"stmt": {
												"Index": 3,
												"col": 1,
												"file": 0,
												"row": 3,
												"target": 4
											},
											"type": "MakeNumberRefStmt"
										},
										{
											"stmt": {
												"col": 1,
												"file": 0,
												"key": {
													"type": "string_index",
													"value": 4
												},
												"object": 2,
												"row": 3,
												"value": {
													"type": "local",
													"value": 4
												}
											},
											"type": "ObjectInsertOnceStmt"
										}
									]
								},
								{
									"stmts": [
										{
											"stmt": {
												"col": 1,
												"file": 0,
												"row": 5,
												"target": 3
											},
											"type": "ResetLocalStmt"
										},
										{
											"stmt": {
												"col": 16,
												"file": 0,
												"row": 5,
												"source": {
													"type": "string_index",
													"value": 5
												},
												"target": 4
											},
											"type": "AssignVarStmt"
										},
										{
											"stmt": {
												"Index": 6,
												"col": 1,
												"file": 0,
												"row": 5,
												"target": 5
											},
											"type": "MakeNumberRefStmt"
										},
										{
											"stmt": {
												"col": 1,
												"file": 0,
												"key": {
													"type": "local",
													"value": 4
												},
												"object": 2,
												"row": 5,
												"value": {
													"type": "local",
													"value": 5
												}
											},
											"type": "ObjectInsertOnceStmt"
										}
									]
								},
								{
									"stmts": [
										{
											"stmt": {
												"col": 1,
												"file": 0,
												"row": 3,
												"source": 2
											},
											"type": "ReturnLocalStmt"
										}
									]
								}
							],
							"name": "g0.data.test.p.q",
							"params": [
								0,
								1
							],
							"path": [
								"g0",
								"test",
								"p",
								"q"
							],
							"return": 2
						}
					]
				},
				"plans": {
					"plans": [
						{
							"blocks": [
								{
									"stmts": [
										{
											"stmt": {
												"col": 0,
												"file": 0,
												"row": 0,
												"target": 2
											},
											"type": "MakeObjectStmt"
										},
										{
											"stmt": {
												"col": 0,
												"file": 0,
												"row": 0,
												"target": 3
											},
											"type": "MakeObjectStmt"
										},
										{
											"stmt": {
												"blocks": [
													{
														"stmts": [
															{
																"stmt": {
																	"args": [
																		{
																			"type": "local",
																			"value": 0
																		},
																		{
																			"type": "local",
																			"value": 1
																		}
																	],
																	"col": 0,
																	"file": 0,
																	"func": "g0.data.test.p.q",
																	"result": 4,
																	"row": 0
																},
																"type": "CallStmt"
															},
															{
																"stmt": {
																	"col": 0,
																	"file": 0,
																	"key": {
																		"type": "string_index",
																		"value": 2
																	},
																	"object": 3,
																	"row": 0,
																	"value": {
																		"type": "local",
																		"value": 4
																	}
																},
																"type": "ObjectInsertStmt"
															}
														]
													}
												],
												"col": 0,
												"file": 0,
												"row": 0
											},
											"type": "BlockStmt"
										},
										{
											"stmt": {
												"col": 0,
												"file": 0,
												"key": {
													"type": "string_index",
													"value": 1
												},
												"object": 2,
												"row": 0,
												"value": {
													"type": "local",
													"value": 3
												}
											},
											"type": "ObjectInsertStmt"
										},
										{
											"stmt": {
												"blocks": [
													{
														"stmts": [
															{
																"stmt": {
																	"blocks": [
																		{
																			"stmts": [
																				{
																					"stmt": {
																						"col": 0,
																						"file": 0,
																						"key": {
																							"type": "string_index",
																							"value": 7
																						},
																						"row": 0,
																						"source": {
																							"type": "local",
																							"value": 1
																						},
																						"target": 6
																					},
																					"type": "DotStmt"
																				},
																				{
																					"stmt": {
																						"a": 6,
																						"b": 2,
																						"col": 0,
																						"file": 0,
																						"row": 0,
																						"target": 5
																					},
																					"type": "ObjectMergeStmt"
																				},
																				{
																					"stmt": {
																						"col": 0,
																						"file": 0,
																						"index": 1,
																						"row": 0
																					},
																					"type": "BreakStmt"
																				}
																			]
																		}
																	],
																	"col": 0,
																	"file": 0,
																	"row": 0
																},
																"type": "BlockStmt"
															},
															{
																"stmt": {
																	"col": 0,
																	"file": 0,
																	"row": 0,
																	"source": {
																		"type": "local",
																		"value": 2
																	},
																	"target": 5
																},
																"type": "AssignVarStmt"
															}
														]
													}
												],
												"col": 0,
												"file": 0,
												"row": 0
											},
											"type": "BlockStmt"
										},
										{
											"stmt": {
												"col": 0,
												"file": 0,
												"row": 0,
												"source": {
													"type": "local",
													"value": 5
												},
												"target": 7
											},
											"type": "AssignVarStmt"
										},
										{
											"stmt": {
												"col": 0,
												"file": 0,
												"row": 0,
												"target": 8
											},
											"type": "MakeObjectStmt"
										},
										{
											"stmt": {
												"col": 0,
												"file": 0,
												"key": {
													"type": "string_index",
													"value": 0
												},
												"object": 8,
												"row": 0,
												"value": {
													"type": "local",
													"value": 7
												}
											},
											"type": "ObjectInsertStmt"
										},
										{
											"stmt": {
												"col": 0,
												"file": 0,
												"row": 0,
												"value": 8
											},
											"type": "ResultSetAddStmt"
										}
									]
								}
							],
							"name": "test"
						}
					]
				},
				"static": {
					"files": [
						{
							"value": "mod_0"
						}
					],
					"strings": [
						{
							"value": "result"
						},
						{
							"value": "p"
						},
						{
							"value": "q"
						},
						{
							"value": "1"
						},
						{
							"value": "r"
						},
						{
							"value": "s"
						},
						{
							"value": "2"
						},
						{
							"value": "test"
						}
					]
				}
			},
			"want_plan_result": {
				"data_test": {
					"p": {
						"q": {
							"r": 1,
							"s": 2
						}
					}
				}
			}
		},
		{
			"note": "refheads/single-value, with var, conflict",
			"query": "data.test.p.q = x",
			"modules": [
				"package test\n\np.q.r := 1\n\np.q[s] := 2 if s := \"r\"\n"
			],
			"want_error_code": "eval_conflict_error",
			"want_error": "object keys must be unique",
			"entrypoints": [
				"test"
			],
			"plan": {
				"funcs": {
					"funcs": [
						{
							"blocks": [
								{
									"stmts": [
										{
											"stmt": {
												"col": 1,
												"file": 0,
												"row": 3,
												"target": 2
											},
											"type": "MakeObjectStmt"
										}
									]
								},
								{
									"stmts": [
										{
											"stmt": {
												"col": 1,
												"file": 0,
												"row": 3,
												"target": 3
											},
											"type": "ResetLocalStmt"
										},
										{
											"stmt": {
												"Index": 3,
												"col": 1,
												"file": 0,
												"row": 3,
												"target": 4
											},
											"type": "MakeNumberRefStmt"
										},
										{
											"stmt": {
												"col": 1,
												"file": 0,
												"key": {
													"type": "string_index",
													"value": 4
												},
												"object": 2,
												"row": 3,
												"value": {
													"type": "local",
													"value": 4
												}
											},
											"type": "ObjectInsertOnceStmt"
										}
									]
								},
								{
									"stmts": [
										{
											"stmt": {
												"col": 1,
												"file": 0,
												"row": 5,
												"target": 3
											},
											"type": "ResetLocalStmt"
										},
										{
											"stmt": {
												"col": 16,
												"file": 0,
												"row": 5,
												"source": {
													"type": "string_index",
													"value": 4
												},
												"target": 4
											},
											"type": "AssignVarStmt"
										},
										{
											"stmt": {
												"Index": 5,
												"col": 1,
												"file": 0,
												"row": 5,
												"target": 5
											},
											"type": "MakeNumberRefStmt"
										},
										{
											"stmt": {
												"col": 1,
												"file": 0,
												"key": {
													"type": "local",
													"value": 4
												},
												"object": 2,
												"row": 5,
												"value": {
													"type": "local",
													"value": 5
												}
											},
											"type": "ObjectInsertOnceStmt"
										}
									]
								},
								{
									"stmts": [
										{
											"stmt": {
												"col": 1,
												"file": 0,
												"row": 3,
												"source": 2
											},
											"type": "ReturnLocalStmt"
										}
									]
								}
							],
							"name": "g0.data.test.p.q",
							"params": [
								0,
								1
							],
							"path": [
								"g0",
								"test",
								"p",
								"q"
							],
							"return": 2
						}
					]
				},
				"plans": {
					"plans": [
						{
							"blocks": [
								{
									"stmts": [
										{
											"stmt": {
												"col": 0,
												"file": 0,
												"row": 0,
												"target": 2
											},
											"type": "MakeObjectStmt"
										},
										{
											"stmt": {
												"col": 0,
												"file": 0,
												"row": 0,
												"target": 3
											},
											"type": "MakeObjectStmt"
										},
										{
											"stmt": {
												"blocks": [
													{
														"stmts": [
															{
																"stmt": {
																	"args": [
																		{
																			"type": "local",
																			"value": 0
																		},
																		{
																			"type": "local",
																			"value": 1
																		}
																	],
																	"col": 0,
																	"file": 0,
																	"func": "g0.data.test.p.q",
																	"result": 4,
																	"row": 0
																},
																"type": "CallStmt"
															},
															{
																"stmt": {
																	"col": 0,
																	"file": 0,
																	"key": {
																		"type": "string_index",
																		"value": 2
																	},
																	"object": 3,
																	"row": 0,
																	"value": {
																		"type": "local",
																		"value": 4
																	}
																},
																"type": "ObjectInsertStmt"
															}
														]
													}
												],
												"col": 0,
												"file": 0,
												"row": 0
											},
											"type": "BlockStmt"
										},
										{
											"stmt": {
												"col": 0,
												"file": 0,
												"key": {
													"type": "string_index",
													"value": 1
												},
												"object": 2,
												"row": 0,
												"value": {
													"type": "local",
													"value": 3
												}
											},
											"type": "ObjectInsertStmt"
										},
										{
											"stmt": {
												"blocks": [
													{
														"stmts": [
															{
																"stmt": {
																	"blocks": [
																		{
																			"stmts": [
																				{
																					"stmt": {
																						"col": 0,
																						"file": 0,
																						"key": {
																							"type": "string_index",
																							"value": 6
																						},
																						"row": 0,
																						"source": {
																							"type": "local",
																							"value": 1
																						},
																						"target": 6
																					},
																					"type": "DotStmt"
																				},
																				{
																					"stmt": {
																						"a": 6,
																						"b": 2,
																						"col": 0,
																						"file": 0,
																						"row": 0,
																						"target": 5
																					},
																					"type": "ObjectMergeStmt"
																				},
																				{
																					"stmt": {
																						"col": 0,
																						"file": 0,
																						"index": 1,
																						"row": 0
																					},
																					"type": "BreakStmt"
																				}
																			]
																		}
																	],
																	"col": 0,
																	"file": 0,
																	"row": 0
																},
																"type": "BlockStmt"
															},
															{
																"stmt": {
																	"col": 0,
																	"file": 0,
																	"row": 0,
																	"source": {
																		"type": "local",
																		"value": 2
																	},
																	"target": 5
																},
																"type": "AssignVarStmt"
															}
														]
													}
												],
												"col": 0,
												"file": 0,
												"row": 0
											},
											"type": "BlockStmt"
										},
										{
											"stmt": {
												"col": 0,
												"file": 0,
												"row": 0,
												"source": {
													"type": "local",
													"value": 5
												},
												"target": 7
											},
											"type": "AssignVarStmt"
										},
										{
											"stmt": {
												"col": 0,
												"file": 0,
												"row": 0,
												"target": 8
											},
											"type": "MakeObjectStmt"
										},
										{
											"stmt": {
												"col": 0,
												"file": 0,
												"key": {
													"type": "string_index",
													"value": 0
												},
												"object": 8,
												"row": 0,
												"value": {
													"type": "local",
													"value": 7
												}
											},
											"type": "ObjectInsertStmt"
										},
										{
											"stmt": {
												"col": 0,
												"file": 0,
												"row": 0,
												"value": 8
											},
											"type": "ResultSetAddStmt"
										}
									]
								}
							],
							"name": "test"
						}
					]
				},
				"static": {
					"files": [
						{
							"value": "mod_0"
						}
					],
					"strings": [
						{
							"value": "result"
						},
						{
							"value": "p"
						},
						{
							"value": "q"
						},
						{
							"value": "1"
						},
						{
							"value": "r"
						},
						{
							"value": "2"
						},
						{
							"value": "test"
						}
					]
				}
			},
			"want_plan_result": null
		},
		{
			"note": "refheads/complete: direct query",
			"query": "data.test.a.b.c.p = x",
			"modules": [
				"package test\n\na.b.c.p := true\n"
			],
			"want_result": [
				{
					"x": true
				}
			],
			"entrypoints": [
				"test"
			],
			"plan": {
				"funcs": {
					"funcs": [
						{
							"blocks": [
								{
									"stmts": [
										{
											"stmt": {
												"col": 1,
												"file": 0,
												"row": 3,
												"target": 3
											},
											"type": "ResetLocalStmt"
										},
										{
											"stmt": {
												"col": 1,
												"file": 0,
												"row": 3,
												"source": {
													"type": "bool",
													"value": true
												},
												"target": 3
											},
											"type": "AssignVarOnceStmt"
										}
									]
								},
								{
									"stmts": [
										{
											"stmt": {
												"col": 1,
												"file": 0,
												"row": 3,
												"source": 3
											},
											"type": "IsDefinedStmt"
										},
										{
											"stmt": {
												"col": 1,
												"file": 0,
												"row": 3,
												"source": {
													"type": "local",
													"value": 3
												},
												"target": 2
											},
											"type": "AssignVarOnceStmt"
										}
									]
								},
								{
									"stmts": [
										{
											"stmt": {
												"col": 1,
												"file": 0,
												"row": 3,
												"source": 2
											},
											"type": "ReturnLocalStmt"
										}
									]
								}
							],
							"name": "g0.data.test.a.b.c.p",
							"params": [
								0,
								1
							],
							"path": [
								"g0",
								"test",
								"a",
								"b",
								"c",
								"p"
							],
							"return": 2
						}
					]
				},
				"plans": {
					"plans": [
						{
							"blocks": [
								{
									"stmts": [
										{
											"stmt": {
												"col": 0,
												"file": 0,
												"row": 0,
												"target": 2
											},
											"type": "MakeObjectStmt"
										},
										{
											"stmt": {
												"col": 0,
												"file": 0,
												"row": 0,
												"target": 3
											},
											"type": "MakeObjectStmt"
										},
										{
											"stmt": {
												"col": 0,
												"file": 0,
												"row": 0,
												"target": 4
											},
											"type": "MakeObjectStmt"
										},
										{
											"stmt": {
												"col": 0,
												"file": 0,
												"row": 0,
												"target": 5
											},
											"type": "MakeObjectStmt"
										},
										{
											"stmt": {
												"blocks": [
													{
														"stmts": [
															{
																"stmt": {
																	"args": [
																		{
																			"type": "local",
																			"value": 0
																		},
																		{
																			"type": "local",
																			"value": 1
																		}
																	],
																	"col": 0,
																	"file": 0,
																	"func": "g0.data.test.a.b.c.p",
																	"result": 6,
																	"row": 0
																},
																"type": "CallStmt"
															},
															{
																"stmt": {
																	"col": 0,
																	"file": 0,
																	"key": {
																		"type": "string_index",
																		"value": 4
																	},
																	"object": 5,
																	"row": 0,
																	"value": {
																		"type": "local",
																		"value": 6
																	}
																},
																"type": "ObjectInsertStmt"
															}
														]
													}
												],
												"col": 0,
												"file": 0,
												"row": 0
											},
											"type": "BlockStmt"
										},
										{
											"stmt": {
												"col": 0,
												"file": 0,
												"key": {
													"type": "string_index",
													"value": 3
												},
												"object": 4,
												"row": 0,
												"value": {
													"type": "local",
													"value": 5
												}
											},
											"type": "ObjectInsertStmt"
										},
										{
											"stmt": {
												"col": 0,
												"file": 0,
												"key": {
													"type": "string_index",
													"value": 2
												},
												"object": 3,
												"row": 0,
												"value": {
													"type": "local",
													"value": 4
												}
											},
											"type": "ObjectInsertStmt"
										},
										{
											"stmt": {
												"col": 0,
												"file": 0,
												"key": {
													"type": "string_index",
													"value": 1
												},
												"object": 2,
												"row": 0,
												"value": {
													"type": "local",
													"value": 3
												}
											},
											"type": "ObjectInsertStmt"
										},
										{
											"stmt": {
												"blocks": [
													{
														"stmts": [
															{
																"stmt": {
																	"blocks": [
																		{
																			"stmts": [
																				{
																					"stmt": {
																						"col": 0,
																						"file": 0,
																						"key": {
																							"type": "string_index",
																							"value": 5
																						},
																						"row": 0,
																						"source": {
																							"type": "local",
																							"value": 1
																						},
																						"target": 8
																					},
																					"type": "DotStmt"
																				},
																				{
																					"stmt": {
																						"a": 8,
																						"b": 2,
																						"col": 0,
																						"file": 0,
																						"row": 0,
																						"target": 7
																					},
																					"type": "ObjectMergeStmt"
																				},
																				{
																					"stmt": {
																						"col": 0,
																						"file": 0,
																						"index": 1,
																						"row": 0
																					},
																					"type": "BreakStmt"
																				}
																			]
																		}
																	],
																	"col": 0,
																	"file": 0,
																	"row": 0
																},
																"type": "BlockStmt"
															},
															{
																"stmt": {
																	"col": 0,
																	"file": 0,
																	"row": 0,
																	"source": {
																		"type": "local",
																		"value": 2
																	},
																	"target": 7
																},
																"type": "AssignVarStmt"
															}
														]
													}
												],
												"col": 0,
												"file": 0,
												"row": 0
											},
											"type": "BlockStmt"
										},
										{
											"stmt": {
												"col": 0,
												"file": 0,
												"row": 0,
												"source": {
													"type": "local",
													"value": 7
												},
												"target": 9
											},
											"type": "AssignVarStmt"
										},
										{
											"stmt": {
												"col": 0,
												"file": 0,
												"row": 0,
												"target": 10
											},
											"type": "MakeObjectStmt"
										},
										{
											"stmt": {
												"col": 0,
												"file": 0,
												"key": {
													"type": "string_index",
													"value": 0
												},
												"object": 10,
												"row": 0,
												"value": {
													"type": "local",
													"value": 9
												}
											},
											"type": "ObjectInsertStmt"
										},
										{
											"stmt": {
												"col": 0,
												"file": 0,
												"row": 0,
												"value": 10
											},
											"type": "ResultSetAddStmt"
										}
									]
								}
							],
							"name": "test"
						}
					]
				},
				"static": {
					"files": [
						{
							"value": "mod_0"
						}
					],
					"strings": [
						{
							"value": "result"
						},
						{
							"value": "a"
						},
						{
							"value": "b"
						},
						{
							"value": "c"
						},
						{
							"value": "p"
						},
						{
							"value": "test"
						}
					]
				}
			},
			"want_plan_result": {
				"data_test": {
					"a": {
						"b": {
							"c": {
								"p": true
							}
						}
					}
				}
			}
		},
		{
			"note": "refheads/complete: direct query q",
			"query": "data.test.q = x",
			"modules": [
				"package test\n\nq := 0\n"
			],
			"want_result": [
				{
					"x": 0
				}
			],
			"entrypoints": [
				"test"
			],
			"plan": {
				"funcs": {
					"funcs": [
						{
							"blocks": [
								{
									"stmts": [
										{
											"stmt": {
												"col": 1,
												"file": 0,
												"row": 3,
												"target": 3
											},
											"type": "ResetLocalStmt"
										},
										{
											"stmt": {
												"Index": 2,
												"col": 1,
												"file": 0,
												"row": 3,
												"target": 4
											},
											"type": "MakeNumberRefStmt"
										},
										{
											"stmt": {
												"col": 1,
												"file": 0,
												"row": 3,
												"source": {
													"type": "local",
													"value": 4
												},
												"target": 3
											},
											"type": "AssignVarOnceStmt"
										}
									]
								},
								{
									"stmts": [
										{
											"stmt": {
												"col": 1,
												"file": 0,
												"row": 3,
												"source": 3
											},
											"type": "IsDefinedStmt"
										},
										{
											"stmt": {
												"col": 1,
												"file": 0,
												"row": 3,
												"source": {
													"type": "local",
													"value": 3
												},
												"target": 2
											},
											"type": "AssignVarOnceStmt"
										}
									]
								},
								{
									"stmts": [
										{
											"stmt": {
												"col": 1,
												"file": 0,
												"row": 3,
												"source": 2
											},
											"type": "ReturnLocalStmt"
										}
									]
								}
							],
							"name": "g0.data.test.q",
							"params": [
								0,
								1
							],
							"path": [
								"g0",
								"test",
								"q"
							],
							"return": 2
						}
					]
				},
				"plans": {
					"plans": [
						{
							"blocks": [
								{
									"stmts": [
										{
											"stmt": {
												"col": 0,
												"file": 0,
												"row": 0,
												"target": 2
											},
											"type": "MakeObjectStmt"
										},
										{
											"stmt": {
												"blocks": [
													{
														"stmts": [
															{
																"stmt": {
																	"args": [
																		{
																			"type": "local",
																			"value": 0
																		},
																		{
																			"type": "local",
																			"value": 1
																		}
																	],
																	"col": 0,
																	"file": 0,
																	"func": "g0.data.test.q",
																	"result": 3,
																	"row": 0
																},
																"type": "CallStmt"
															},
															{
																"stmt": {
																	"col": 0,
																	"file": 0,
																	"key": {
																		"type": "string_index",
																		"value": 1
																	},
																	"object": 2,
																	"row": 0,
																	"value": {
																		"type": "local",
																		"value": 3
																	}
																},
																"type": "ObjectInsertStmt"
															}
														]
													}
												],
												"col": 0,
												"file": 0,
												"row": 0
											},
											"type": "BlockStmt"
										},
										{
											"stmt": {
												"blocks": [
													{
														"stmts": [
															{
																"stmt": {
																	"blocks": [
																		{
																			"stmts": [
																				{
																					"stmt": {
																						"col": 0,
																						"file": 0,
																						"key": {
																							"type": "string_index",
																							"value": 3
																						},
																						"row": 0,
																						"source": {
																							"type": "local",
																							"value": 1
																						},
																						"target": 5
																					},
																					"type": "DotStmt"
																				},
																				{
																					"stmt": {
																						"a": 5,
																						"b": 2,
																						"col": 0,
																						"file": 0,
																						"row": 0,
																						"target": 4
																					},
																					"type": "ObjectMergeStmt"
																				},
																				{
																					"stmt": {
																						"col": 0,
																						"file": 0,
																						"index": 1,
																						"row": 0
																					},
																					"type": "BreakStmt"
																				}
																			]
																		}
																	],
																	"col": 0,
																	"file": 0,
																	"row": 0
																},
																"type": "BlockStmt"
															},
															{
																"stmt": {
																	"col": 0,
																	"file": 0,
																	"row": 0,
																	"source": {
																		"type": "local",
																		"value": 2
																	},
																	"target": 4
																},
																"type": "AssignVarStmt"
															}
														]
													}
												],
												"col": 0,
												"file": 0,
												"row": 0
											},
											"type": "BlockStmt"
										},
										{
											"stmt": {
												"col": 0,
												"file": 0,
												"row": 0,
												"source": {
													"type": "local",
													"value": 4
												},
												"target": 6
											},
											"type": "AssignVarStmt"
										},
										{
											"stmt": {
												"col": 0,
												"file": 0,
												"row": 0,
												"target": 7
											},
											"type": "MakeObjectStmt"
										},
										{
											"stmt": {
												"col": 0,
												"file": 0,
												"key": {
													"type": "string_index",
													"value": 0
												},
												"object": 7,
												"row": 0,
												"value": {
													"type": "local",
													"value": 6
												}
											},
											"type": "ObjectInsertStmt"
										},
										{
											"stmt": {
												"col": 0,
												"file": 0,
												"row": 0,
												"value": 7
											},
											"type": "ResultSetAddStmt"
										}
									]
								}
							],
							"name": "test"
						}
					]
				},
				"static": {
					"files": [
						{
							"value": "mod_0"
						}
					],
					"strings": [
						{
							"value": "result"
						},
						{
							"value": "q"
						},
						{
							"value": "0"
						},
						{
							"value": "test"
						}
					]
				}
			},
			"want_plan_result": {
				"data_test": {
					"q": 0
				}
			}
		},
		{
			"note": "refheads/complete: full package extent",
			"query": "data.test = x",
			"modules": [
				"package test\n\na.b.c.p := true\n"
			],
			"want_result": [
				{
					"x": {
						"a": {
							"b": {
								"c": {
									"p": true
								}
							}
						}
					}
				}
			],
			"entrypoints": [
				"test"
			],
			"plan": {
				"funcs": {
					"funcs": [
						{
							"blocks": [
								{
									"stmts": [
										{
											"stmt": {
												"col": 1,
												"file": 0,
												"row": 3,
												"target": 3
											},
											"type": "ResetLocalStmt"
										},
										{
											"stmt": {
												"col": 1,
												"file": 0,
												"row": 3,
												"source": {
													"type": "bool",
													"value": true
												},
												"target": 3
											},
											"type": "AssignVarOnceStmt"
										}
									]
								},
								{
									"stmts": [
										{
											"stmt": {
												"col": 1,
												"file": 0,
												"row": 3,
												"source": 3
											},
											"type": "IsDefinedStmt"
										},
										{
											"stmt": {
												"col": 1,
												"file": 0,
												"row": 3,
												"source": {
													"type": "local",
													"value": 3
												},
												"target": 2
											},
											"type": "AssignVarOnceStmt"
										}
									]
								},
								{
									"stmts": [
										{
											"stmt": {
												"col": 1,
												"file": 0,
												"row": 3,
												"source": 2
											},
											"type": "ReturnLocalStmt"
										}
									]
								}
							],
							"name": "g0.data.test.a.b.c.p",
							"params": [
								0,
								1
							],
							"path": [
								"g0",
								"test",
								"a",
								"b",
								"c",
								"p"
							],
							"return": 2
						}
					]
				},
				"plans": {
					"plans": [
						{
							"blocks": [
								{
									"stmts": [
										{
											"stmt": {
												"col": 0,
												"file": 0,
												"row": 0,
												"target": 2
											},
											"type": "MakeObjectStmt"
										},
										{
											"stmt": {
												"col": 0,
												"file": 0,
												"row": 0,
												"target": 3
											},
											"type": "MakeObjectStmt"
										},
										{
											"stmt": {
												"col": 0,
												"file": 0,
												"row": 0,
												"target": 4
											},
											"type": "MakeObjectStmt"
										},
										{
											"stmt": {
												"col": 0,
												"file": 0,
												"row": 0,
												"target": 5
											},
											"type": "MakeObjectStmt"
										},
										{
											"stmt": {
												"blocks": [
													{
														"stmts": [
															{
																"stmt": {
																	"args": [
																		{
																			"type": "local",
																			"value": 0
																		},
																		{
																			"type": "local",
																			"value": 1
																		}
																	],
																	"col": 0,
																	"file": 0,
																	"func": "g0.data.test.a.b.c.p",
																	"result": 6,
																	"row": 0
																},
																"type": "CallStmt"
															},
															{
																"stmt": {
																	"col": 0,
																	"file": 0,
																	"key": {
																		"type": "string_index",
																		"value": 4
																	},
																	"object": 5,
																	"row": 0,
																	"value": {
																		"type": "local",
																		"value": 6
																	}
																},
																"type": "ObjectInsertStmt"
															}
														]
													}
												],
												"col": 0,
												"file": 0,
												"row": 0
											},
											"type": "BlockStmt"
										},
										{
											"stmt": {
												"col": 0,
												"file": 0,
												"key": {
													"type": "string_index",
													"value": 3
												},
												"object": 4,
												"row": 0,
												"value": {
													"type": "local",
													"value": 5
												}
											},
											"type": "ObjectInsertStmt"
										},
										{
											"stmt": {
												"col": 0,
												"file": 0,
												"key": {
													"type": "string_index",
													"value": 2
												},
												"object": 3,
												"row": 0,
												"value": {
													"type": "local",
													"value": 4
												}
											},
											"type": "ObjectInsertStmt"
										},
										{
											"stmt": {
												"col": 0,
												"file": 0,
												"key": {
													"type": "string_index",
													"value": 1
												},
												"object": 2,
												"row": 0,
												"value": {
													"type": "local",
													"value": 3
												}
											},
											"type": "ObjectInsertStmt"
										},
										{
											"stmt": {
												"blocks": [
													{
														"stmts": [
															{
																"stmt": {
																	"blocks": [
																		{
																			"stmts": [
																				{
																					"stmt": {
																						"col": 0,
																						"file": 0,
																						"key": {
																							"type": "string_index",
																							"value": 5
																						},
																						"row": 0,
																						"source": {
																							"type": "local",
																							"value": 1
																						},
																						"target": 8
																					},
																					"type": "DotStmt"
																				},
																				{
																					"stmt": {
																						"a": 8,
																						"b": 2,
																						"col": 0,
																						"file": 0,
																						"row": 0,
																						"target": 7
																					},
																					"type": "ObjectMergeStmt"
																				},
																				{
																					"stmt": {
																						"col": 0,
																						"file": 0,
																						"index": 1,
																						"row": 0
																					},
																					"type": "BreakStmt"
																				}
																			]
																		}
																	],
																	"col": 0,
																	"file": 0,
																	"row": 0
																},
																"type": "BlockStmt"
															},
															{
																"stmt": {
																	"col": 0,
																	"file": 0,
																	"row": 0,
																	"source": {
																		"type": "local",
																		"value": 2
																	},
																	"target": 7
																},
																"type": "AssignVarStmt"
															}
														]
													}
												],
												"col": 0,
												"file": 0,
												"row": 0
											},
											"type": "BlockStmt"
										},
										{
											"stmt": {
												"col": 0,
												"file": 0,
												"row": 0,
												"source": {
													"type": "local",
													"value": 7
												},
												"target": 9
											},
											"type": "AssignVarStmt"
										},
										{
											"stmt": {
												"col": 0,
												"file": 0,
												"row": 0,
												"target": 10
											},
											"type": "MakeObjectStmt"
										},
										{
											"stmt": {
												"col": 0,
												"file": 0,
												"key": {
													"type": "string_index",
													"value": 0
												},
												"object": 10,
												"row": 0,
												"value": {
													"type": "local",
													"value": 9
												}
											},
											"type": "ObjectInsertStmt"
										},
										{
											"stmt": {
												"col": 0,
												"file": 0,
												"row": 0,
												"value": 10
											},
											"type": "ResultSetAddStmt"
										}
									]
								}
							],
							"name": "test"
						}
					]
				},
				"static": {
					"files": [
						{
							"value": "mod_0"
						}
					],
					"strings": [
						{
							"value": "result"
						},
						{
							"value": "a"
						},
						{
							"value": "b"
						},
						{
							"value": "c"
						},
						{
							"value": "p"
						},
						{
							"value": "test"
						}
					]
				}
			},
			"want_plan_result": {
				"data_test": {
					"a": {
						"b": {
							"c": {
								"p": true
							}
						}
					}
				}
			}
		},
		{
			"note": "refheads/complete+mixed",
			"query": "data.test.p = x",
			"modules": [
				"package test\n\na.b.c.p := 1\n\nq := 0\n\na.b.d := 3\n\np if {\n\tq == 0\n\ta.b.c.p == 1\n\ta.b.d == 3\n}\n"
			],
			"want_result": [
				{
					"x": true
				}
			],
			"entrypoints": [
				"test"
			],
			"plan": {
				"funcs": {
					"funcs": [
						{
							"blocks": [
								{
									"stmts": [
										{
											"stmt": {
												"col": 1,
												"file": 0,
												"row": 3,
												"target": 3
											},
											"type": "ResetLocalStmt"
										},
										{
											"stmt": {
												"Index": 5,
												"col": 1,
												"file": 0,
												"row": 3,
												"target": 4
											},
											"type": "MakeNumberRefStmt"
										},
										{
											"stmt": {
												"col": 1,
												"file": 0,
												"row": 3,
												"source": {
													"type": "local",
													"value": 4
												},
												"target": 3
											},
											"type": "AssignVarOnceStmt"
										}
									]
								},
								{
									"stmts": [
										{
											"stmt": {
												"col": 1,
												"file": 0,
												"row": 3,
												"source": 3
											},
											"type": "IsDefinedStmt"
										},
										{
											"stmt": {
												"col": 1,
												"file": 0,
												"row": 3,
												"source": {
													"type": "local",
													"value": 3
												},
												"target": 2
											},
											"type": "AssignVarOnceStmt"
										}
									]
								},
								{
									"stmts": [
										{
											"stmt": {
												"col": 1,
												"file": 0,
												"row": 3,
												"source": 2
											},
											"type": "ReturnLocalStmt"
										}
									]
								}
							],
							"name": "g0.data.test.a.b.c.p",
							"params": [
								0,
								1
							],
							"path": [
								"g0",
								"test",
								"a",
								"b",
								"c",
								"p"
							],
							"return": 2
						},
						{
							"blocks": [
								{
									"stmts": [
										{
											"stmt": {
												"col": 1,
												"file": 0,
												"row": 7,
												"target": 3
											},
											"type": "ResetLocalStmt"
										},
										{
											"stmt": {
												"Index": 7,
												"col": 1,
												"file": 0,
												"row": 7,
												"target": 4
											},
											"type": "MakeNumberRefStmt"
										},
										{
											"stmt": {
												"col": 1,
												"file": 0,
												"row": 7,
												"source": {
													"type": "local",
													"value": 4
												},
												"target": 3
											},
											"type": "AssignVarOnceStmt"
										}
									]
								},
								{
									"stmts": [
										{
											"stmt": {
												"col": 1,
												"file": 0,
												"row": 7,
												"source": 3
											},
											"type": "IsDefinedStmt"
										},
										{
											"stmt": {
												"col": 1,
												"file": 0,
												"row": 7,
												"source": {
													"type": "local",
													"value": 3
												},
												"target": 2
											},
											"type": "AssignVarOnceStmt"
										}
									]
								},
								{
									"stmts": [
										{
											"stmt": {
												"col": 1,
												"file": 0,
												"row": 7,
												"source": 2
											},
											"type": "ReturnLocalStmt"
										}
									]
								}
							],
							"name": "g0.data.test.a.b.d",
							"params": [
								0,
								1
							],
							"path": [
								"g0",
								"test",
								"a",
								"b",
								"d"
							],
							"return": 2
						},
						{
							"blocks": [
								{
									"stmts": [
										{
											"stmt": {
												"col": 1,
												"file": 0,
												"row": 5,
												"target": 3
											},
											"type": "ResetLocalStmt"
										},
										{
											"stmt": {
												"Index": 8,
												"col": 1,
												"file": 0,
												"row": 5,
												"target": 4
											},
											"type": "MakeNumberRefStmt"
										},
										{
											"stmt": {
												"col": 1,
												"file": 0,
												"row": 5,
												"source": {
													"type": "local",
													"value": 4
												},
												"target": 3
											},
											"type": "AssignVarOnceStmt"
										}
									]
								},
								{
									"stmts": [
										{
											"stmt": {
												"col": 1,
												"file": 0,
												"row": 5,
												"source": 3
											},
											"type": "IsDefinedStmt"
										},
										{
											"stmt": {
												"col": 1,
												"file": 0,
												"row": 5,
												"source": {
													"type": "local",
													"value": 3
												},
												"target": 2
											},
											"type": "AssignVarOnceStmt"
										}
									]
								},
								{
									"stmts": [
										{
											"stmt": {
												"col": 1,
												"file": 0,
												"row": 5,
												"source": 2
											},
											"type": "ReturnLocalStmt"
										}
									]
								}
							],
							"name": "g0.data.test.q",
							"params": [
								0,
								1
							],
							"path": [
								"g0",
								"test",
								"q"
							],
							"return": 2
						},
						{
							"blocks": [
								{
									"stmts": [
										{
											"stmt": {
												"col": 1,
												"file": 0,
												"row": 9,
												"target": 3
											},
											"type": "ResetLocalStmt"
										},
										{
											"stmt": {
												"args": [
													{
														"type": "local",
														"value": 0
													},
													{
														"type": "local",
														"value": 1
													}
												],
												"col": 2,
												"file": 0,
												"func": "g0.data.test.q",
												"result": 4,
												"row": 10
											},
											"type": "CallStmt"
										},
										{
											"stmt": {
												"Index": 8,
												"col": 2,
												"file": 0,
												"row": 10,
												"target": 5
											},
											"type": "MakeNumberRefStmt"
										},
										{
											"stmt": {
												"a": {
													"type": "local",
													"value": 4
												},
												"b": {
													"type": "local",
													"value": 5
												},
												"col": 2,
												"file": 0,
												"row": 10
											},
											"type": "EqualStmt"
										},
										{
											"stmt": {
												"args": [
													{
														"type": "local",
														"value": 0
													},
													{
														"type": "local",
														"value": 1
													}
												],
												"col": 2,
												"file": 0,
												"func": "g0.data.test.a.b.c.p",
												"result": 6,
												"row": 11
											},
											"type": "CallStmt"
										},
										{
											"stmt": {
												"Index": 5,
												"col": 2,
												"file": 0,
												"row": 11,
												"target": 7
											},
											"type": "MakeNumberRefStmt"
										},
										{
											"stmt": {
												"a": {
													"type": "local",
													"value": 6
												},
												"b": {
													"type": "local",
													"value": 7
												},
												"col": 2,
												"file": 0,
												"row": 11
											},
											"type": "EqualStmt"
										},
										{
											"stmt": {
												"args": [
													{
														"type": "local",
														"value": 0
													},
													{
														"type": "local",
														"value": 1
													}
												],
												"col": 2,
												"file": 0,
												"func": "g0.data.test.a.b.d",
												"result": 8,
												"row": 12
											},
											"type": "CallStmt"
										},
										{
											"stmt": {
												"Index": 7,
												"col": 2,
												"file": 0,
												"row": 12,
												"target": 9
											},
											"type": "MakeNumberRefStmt"
										},
										{
											"stmt": {
												"a": {
													"type": "local",
													"value": 8
												},
												"b": {
													"type": "local",
													"value": 9
												},
												"col": 2,
												"file": 0,
												"row": 12
											},
											"type": "EqualStmt"
										},
										{
											"stmt": {
												"col": 1,
												"file": 0,
												"row": 9,
												"source": {
													"type": "bool",
													"value": true
												},
												"target": 3
											},
											"type": "AssignVarOnceStmt"
										}
									]
								},
								{
									"stmts": [
										{
											"stmt": {
												"col": 1,
												"file": 0,
												"row": 9,
												"source": 3
											},
											"type": "IsDefinedStmt"
										},
										{
											"stmt": {
												"col": 1,
												"file": 0,
												"row": 9,
												"source": {
													"type": "local",
													"value": 3
												},
												"target": 2
											},
											"type": "AssignVarOnceStmt"
										}
									]
								},
								{
									"stmts": [
										{
											"stmt": {
												"col": 1,
												"file": 0,
												"row": 9,
												"source": 2
											},
											"type": "ReturnLocalStmt"
										}
									]
								}
							],
							"name": "g0.data.test.p",
							"params": [
								0,
								1
							],
							"path": [
								"g0",
								"test",
								"p"
							],
							"return": 2
						}
					]
				},
				"plans": {
					"plans": [
						{
							"blocks": [
								{
									"stmts": [
										{
											"stmt": {
												"col": 0,
												"file": 0,
												"row": 0,
												"target": 2
											},
											"type": "MakeObjectStmt"
										},
										{
											"stmt": {
												"col": 0,
												"file": 0,
												"row": 0,
												"target": 3
											},
											"type": "MakeObjectStmt"
										},
										{
											"stmt": {
												"col": 0,
												"file": 0,
												"row": 0,
												"target": 4
											},
											"type": "MakeObjectStmt"
										},
										{
											"stmt": {
												"col": 0,
												"file": 0,
												"row": 0,
												"target": 5
											},
											"type": "MakeObjectStmt"
										},
										{
											"stmt": {
												"blocks": [
													{
														"stmts": [
															{
																"stmt": {
																	"args": [
																		{
																			"type": "local",
																			"value": 0
																		},
																		{
																			"type": "local",
																			"value": 1
																		}
																	],
																	"col": 0,
																	"file": 0,
																	"func": "g0.data.test.a.b.c.p",
																	"result": 6,
																	"row": 0
																},
																"type": "CallStmt"
															},
															{
																"stmt": {
																	"col": 0,
																	"file": 0,
																	"key": {
																		"type": "string_index",
																		"value": 4
																	},
																	"object": 5,
																	"row": 0,
																	"value": {
																		"type": "local",
																		"value": 6
																	}
																},
																"type": "ObjectInsertStmt"
															}
														]
													}
												],
												"col": 0,
												"file": 0,
												"row": 0
											},
											"type": "BlockStmt"
										},
										{
											"stmt": {
												"col": 0,
												"file": 0,
												"key": {
													"type": "string_index",
													"value": 3
												},
												"object": 4,
												"row": 0,
												"value": {
													"type": "local",
													"value": 5
												}
											},
											"type": "ObjectInsertStmt"
										},
										{
											"stmt": {
												"blocks": [
													{
														"stmts": [
															{
																"stmt": {
																	"args": [
																		{
																			"type": "local",
																			"value": 0
																		},
																		{
																			"type": "local",
																			"value": 1
																		}
																	],
																	"col": 0,
																	"file": 0,
																	"func": "g0.data.test.a.b.d",
																	"result": 7,
																	"row": 0
																},
																"type": "CallStmt"
															},
															{
																"stmt": {
																	"col": 0,
																	"file": 0,
																	"key": {
																		"type": "string_index",
																		"value": 6
																	},
																	"object": 4,
																	"row": 0,
																	"value": {
																		"type": "local",
																		"value": 7
																	}
																},
																"type": "ObjectInsertStmt"
															}
														]
													}
												],
												"col": 0,
												"file": 0,
												"row": 0
											},
											"type": "BlockStmt"
										},
										{
											"stmt": {
												"col": 0,
												"file": 0,
												"key": {
													"type": "string_index",
													"value": 2
												},
												"object": 3,
												"row": 0,
												"value": {
													"type": "local",
													"value": 4
												}
											},
											"type": "ObjectInsertStmt"
										},
										{
											"stmt": {
												"col": 0,
												"file": 0,
												"key": {
													"type": "string_index",
													"value": 1
												},
												"object": 2,
												"row": 0,
												"value": {
													"type": "local",
													"value": 3
												}
											},
											"type": "ObjectInsertStmt"
										},
										{
											"stmt": {
												"blocks": [
													{
														"stmts": [
															{
																"stmt": {
																	"args": [
																		{
																			"type": "local",
																			"value": 0
																		},
																		{
																			"type": "local",
																			"value": 1
																		}
																	],
																	"col": 0,
																	"file": 0,
																	"func": "g0.data.test.p",
																	"result": 8,
																	"row": 0
																},
																"type": "CallStmt"
															},
															{
																"stmt": {
																	"col": 0,
																	"file": 0,
																	"key": {
																		"type": "string_index",
																		"value": 4
																	},
																	"object": 2,
																	"row": 0,
																	"value": {
																		"type": "local",
																		"value": 8
																	}
																},
																"type": "ObjectInsertStmt"
															}
														]
													}
												],
												"col": 0,
												"file": 0,
												"row": 0
											},
											"type": "BlockStmt"
										},
										{
											"stmt": {
												"blocks": [
													{
														"stmts": [
															{
																"stmt": {
																	"args": [
																		{
																			"type": "local",
																			"value": 0
																		},
																		{
																			"type": "local",
																			"value": 1
																		}
																	],
																	"col": 0,
																	"file": 0,
																	"func": "g0.data.test.q",
																	"result": 9,
																	"row": 0
																},
																"type": "CallStmt"
															},
															{
																"stmt": {
																	"col": 0,
																	"file": 0,
																	"key": {
																		"type": "string_index",
																		"value": 9
																	},
																	"object": 2,
																	"row": 0,
																	"value": {
																		"type": "local",
																		"value": 9
																	}
																},
																"type": "ObjectInsertStmt"
															}
														]
													}
												],
												"col": 0,
												"file": 0,
												"row": 0
											},
											"type": "BlockStmt"
										},
										{
											"stmt": {
												"blocks": [
													{
														"stmts": [
															{
																"stmt": {
																	"blocks": [
																		{
																			"stmts": [
																				{
																					"stmt": {
																						"col": 0,
																						"file": 0,
																						"key": {
																							"type": "string_index",
																							"value": 10
																						},
																						"row": 0,
																						"source": {
																							"type": "local",
																							"value": 1
																						},
																						"target": 11
																					},
																					"type": "DotStmt"
																				},
																				{
																					"stmt": {
																						"a": 11,
																						"b": 2,
																						"col": 0,
																						"file": 0,
																						"row": 0,
																						"target": 10
																					},
																					"type": "ObjectMergeStmt"
																				},
																				{
																					"stmt": {
																						"col": 0,
																						"file": 0,
																						"index": 1,
																						"row": 0
																					},
																					"type": "BreakStmt"
																				}
																			]
																		}
																	],
																	"col": 0,
																	"file": 0,
																	"row": 0
																},
																"type": "BlockStmt"
															},
															{
																"stmt": {
																	"col": 0,
																	"file": 0,
																	"row": 0,
																	"source": {
																		"type": "local",
																		"value": 2
																	},
																	"target": 10
																},
																"type": "AssignVarStmt"
															}
														]
													}
												],
												"col": 0,
												"file": 0,
												"row": 0
											},
											"type": "BlockStmt"
										},
										{
											"stmt": {
												"col": 0,
												"file": 0,
												"row": 0,
												"source": {
													"type": "local",
													"value": 10
												},
												"target": 12
											},
											"type": "AssignVarStmt"
										},
										{
											"stmt": {
												"col": 0,
												"file": 0,
												"row": 0,
												"target": 13
											},
											"type": "MakeObjectStmt"
										},
										{
											"stmt": {
												"col": 0,
												"file": 0,
												"key": {
													"type": "string_index",
													"value": 0
												},
												"object": 13,
												"row": 0,
												"value": {
													"type": "local",
													"value": 12
												}
											},
											"type": "ObjectInsertStmt"
										},
										{
											"stmt": {
												"col": 0,
												"file": 0,
												"row": 0,
												"value": 13
											},
											"type": "ResultSetAddStmt"
										}
									]
								}
							],
							"name": "test"
						}
					]
				},
				"static": {
					"files": [
						{
							"value": "mod_0"
						}
					],
					"strings": [
						{
							"value": "result"
						},
						{
							"value": "a"
						},
						{
							"value": "b"
						},
						{
							"value": "c"
						},
						{
							"value": "p"
						},
						{
							"value": "1"
						},
						{
							"value": "d"
						},
						{
							"value": "3"
						},
						{
							"value": "0"
						},
						{
							"value": "q"
						},
						{
							"value": "test"
						}
					]
				}
			},
			"want_plan_result": {
				"data_test": {
					"a": {
						"b": {
							"c": {
								"p": 1
							},
							"d": 3
						}
					},
					"p": true,
					"q": 0
				}
			}
		},
		{
			"note": "refheads/single-value rule",
			"query": "data.test.a = x",
			"modules": [
				"package test\n\na.b[x] := y if {\n\tx := \"c\"\n\ty := \"d\"\n}\n"
			],
			"want_result": [
				{
					"x": {
						"b": {
							"c": "d"
						}
					}
				}
			],
			"entrypoints": [
				"test"
			],
			"plan": {
				"funcs": {
					"funcs": [
						{
							"blocks": [
								{
									"stmts": [
										{
											"stmt": {
												"col": 1,
												"file": 0,
												"row": 3,
												"target": 2
											},
											"type": "MakeObjectStmt"
										}
									]
								},
								{
									"stmts": [
										{
											"stmt": {
												"col": 1,
												"file": 0,
												"row": 3,
												"target": 3
											},
											"type": "ResetLocalStmt"
										},
										{
											"stmt": {
												"col": 2,
												"file": 0,
												"row": 4,
												"source": {
													"type": "string_index",
													"value": 3
												},
												"target": 4
											},
											"type": "AssignVarStmt"
										},
										{
											"stmt": {
												"col": 2,
												"file": 0,
												"row": 5,
												"source": {
													"type": "string_index",
													"value": 4
												},
												"target": 5
											},
											"type": "AssignVarStmt"
										},
										{
											"stmt": {
												"col": 1,
												"file": 0,
												"key": {
													"type": "local",
													"value": 4
												},
												"object": 2,
												"row": 3,
												"value": {
													"type": "local",
													"value": 5
												}
											},
											"type": "ObjectInsertOnceStmt"
										}
									]
								},
								{
									"stmts": [
										{
											"stmt": {
												"col": 1,
												"file": 0,
												"row": 3,
												"source": 2
											},
											"type": "ReturnLocalStmt"
										}
									]
								}
							],
							"name": "g0.data.test.a.b",
							"params": [
								0,
								1
							],
							"path": [
								"g0",
								"test",
								"a",
								"b"
							],
							"return": 2
						}
					]
				},
				"plans": {
					"plans": [
						{
							"blocks": [
								{
									"stmts": [
										{
											"stmt": {
												"col": 0,
												"file": 0,
												"row": 0,
												"target": 2
											},
											"type": "MakeObjectStmt"
										},
										{
											"stmt": {
												"col": 0,
												"file": 0,
												"row": 0,
												"target": 3
											},
											"type": "MakeObjectStmt"
										},
										{
											"stmt": {
												"blocks": [
													{
														"stmts": [
															{
																"stmt": {
																	"args": [
																		{
																			"type": "local",
																			"value": 0
																		},
																		{
																			"type": "local",
																			"value": 1
																		}
																	],
																	"col": 0,
																	"file": 0,
																	"func": "g0.data.test.a.b",
																	"result": 4,
																	"row": 0
																},
																"type": "CallStmt"
															},
															{
																"stmt": {
																	"col": 0,
																	"file": 0,
																	"key": {
																		"type": "string_index",
																		"value": 2
																	},
																	"object": 3,
																	"row": 0,
																	"value": {
																		"type": "local",
																		"value": 4
																	}
																},
																"type": "ObjectInsertStmt"
															}
														]
													}
												],
												"col": 0,
												"file": 0,
												"row": 0
											},
											"type": "BlockStmt"
										},
										{
											"stmt": {
												"col": 0,
												"file": 0,
												"key": {
													"type": "string_index",
													"value": 1
												},
												"object": 2,
												"row": 0,
												"value": {
													"type": "local",
													"value": 3
												}
											},
											"type": "ObjectInsertStmt"
										},
										{
											"stmt": {
												"blocks": [
													{
														"stmts": [
															{
																"stmt": {
																	"blocks": [
																		{
																			"stmts": [
																				{
																					"stmt": {
																						"col": 0,
																						"file": 0,
																						"key": {
																							"type": "string_index",
																							"value": 5
																						},
																						"row": 0,
																						"source": {
																							"type": "local",
																							"value": 1
																						},
																						"target": 6
																					},
																					"type": "DotStmt"
																				},
																				{
																					"stmt": {
																						"a": 6,
																						"b": 2,
																						"col": 0,
																						"file": 0,
																						"row": 0,
																						"target": 5
																					},
																					"type": "ObjectMergeStmt"
																				},
																				{
																					"stmt": {
																						"col": 0,
																						"file": 0,
																						"index": 1,
																						"row": 0
																					},
																					"type": "BreakStmt"
																				}
																			]
																		}
																	],
																	"col": 0,
																	"file": 0,
																	"row": 0
																},
																"type": "BlockStmt"
															},
															{
																"stmt": {
																	"col": 0,
																	"file": 0,
																	"row": 0,
																	"source": {
																		"type": "local",
																		"value": 2
																	},
																	"target": 5
																},
																"type": "AssignVarStmt"
															}
														]
													}
												],
												"col": 0,
												"file": 0,
												"row": 0
											},
											"type": "BlockStmt"
										},
										{
											"stmt": {
												"col": 0,
												"file": 0,
												"row": 0,
												"source": {
													"type": "local",
													"value": 5
												},
												"target": 7
											},
											"type": "AssignVarStmt"
										},
										{
											"stmt": {
												"col": 0,
												"file": 0,
												"row": 0,
												"target": 8
											},
											"type": "MakeObjectStmt"
										},
										{
											"stmt": {
												"col": 0,
												"file": 0,
												"key": {
													"type": "string_index",
													"value": 0
												},
												"object": 8,
												"row": 0,
												"value": {
													"type": "local",
													"value": 7
												}
											},
											"type": "ObjectInsertStmt"
										},
										{
											"stmt": {
												"col": 0,
												"file": 0,
												"row": 0,
												"value": 8
											},
											"type": "ResultSetAddStmt"
										}
									]
								}
							],
							"name": "test"
						}
					]
				},
				"static": {
					"files": [
						{
							"value": "mod_0"
						}
					],
					"strings": [
						{
							"value": "result"
						},
						{
							"value": "a"
						},
						{
							"value": "b"
						},
						{
							"value": "c"
						},
						{
							"value": "d"
						},
						{
							"value": "test"
						}
					]
				}
			},
			"want_plan_result": {
				"data_test": {
					"a": {
						"b": {
							"c": "d"
						}
					}
				}
			}
		},
		{
			"note": "refheads/multi-value",
			"query": "data.test.a = x",
			"modules": [
				"package test\n\na.b contains x if some x in [1, 2, 3]\n"
			],
			"want_result": [
				{
					"x": {
						"b": [
							1,
							2,
							3
						]
					}
				}
			],
			"entrypoints": [
				"test"
			],
			"plan": {
				"funcs": {
					"funcs": [
						{
							"blocks": [
								{
									"stmts": [
										{
											"stmt": {
												"col": 1,
												"file": 0,
												"row": 3,
												"target": 2
											},
											"type": "MakeSetStmt"
										}
									]
								},
								{
									"stmts": [
										{
											"stmt": {
												"col": 1,
												"file": 0,
												"row": 3,
												"target": 3
											},
											"type": "ResetLocalStmt"
										},
										{
											"stmt": {
												"capacity": 3,
												"col": 29,
												"file": 0,
												"row": 3,
												"target": 4
											},
											"type": "MakeArrayStmt"
										},
										{
											"stmt": {
												"Index": 3,
												"col": 29,
												"file": 0,
												"row": 3,
												"target": 5
											},
											"type": "MakeNumberRefStmt"
										},
										{
											"stmt": {
												"array": 4,
												"col": 29,
												"file": 0,
												"row": 3,
												"value": {
													"type": "local",
													"value": 5
												}
											},
											"type": "ArrayAppendStmt"
										},
										{
											"stmt": {
												"Index": 4,
												"col": 29,
												"file": 0,
												"row": 3,
												"target": 6
											},
											"type": "MakeNumberRefStmt"
										},
										{
											"stmt": {
												"array": 4,
												"col": 29,
												"file": 0,
												"row": 3,
												"value": {
													"type": "local",
													"value": 6
												}
											},
											"type": "ArrayAppendStmt"
										},
										{
											"stmt": {
												"Index": 5,
												"col": 29,
												"file": 0,
												"row": 3,
												"target": 7
											},
											"type": "MakeNumberRefStmt"
										},
										{
											"stmt": {
												"array": 4,
												"col": 29,
												"file": 0,
												"row": 3,
												"value": {
													"type": "local",
													"value": 7
												}
											},
											"type": "ArrayAppendStmt"
										},
										{
											"stmt": {
												"col": 29,
												"file": 0,
												"row": 3,
												"source": {
													"type": "local",
													"value": 4
												},
												"target": 8
											},
											"type": "AssignVarStmt"
										},
										{
											"stmt": {
												"block": {
													"stmts": [
														{
															"stmt": {
																"col": 19,
																"file": 0,
																"row": 3,
																"source": {
																	"type": "local",
																	"value": 9
																},
																"target": 11
															},
															"type": "AssignVarStmt"
														},
														{
															"stmt": {
																"col": 19,
																"file": 0,
																"row": 3,
																"source": {
																	"type": "local",
																	"value": 10
																},
																"target": 12
															},
															"type": "AssignVarStmt"
														},
														{
															"stmt": {
																"col": 1,
																"file": 0,
																"row": 3,
																"set": 2,
																"value": {
																	"type": "local",
																	"value": 12
																}
															},
															"type": "SetAddStmt"
														}
													]
												},
												"col": 19,
												"file": 0,
												"key": 9,
												"row": 3,
												"source": 8,
												"value": 10
											},
											"type": "ScanStmt"
										}
									]
								},
								{
									"stmts": [
										{
											"stmt": {
												"col": 1,
												"file": 0,
												"row": 3,
												"source": 2
											},
											"type": "ReturnLocalStmt"
										}
									]
								}
							],
							"name": "g0.data.test.a.b",
							"params": [
								0,
								1
							],
							"path": [
								"g0",
								"test",
								"a",
								"b"
							],
							"return": 2
						}
					]
				},
				"plans": {
					"plans": [
						{
							"blocks": [
								{
									"stmts": [
										{
											"stmt": {
												"col": 0,
												"file": 0,
												"row": 0,
												"target": 2
											},
											"type": "MakeObjectStmt"
										},
										{
											"stmt": {
												"col": 0,
												"file": 0,
												"row": 0,
												"target": 3
											},
											"type": "MakeObjectStmt"
										},
										{
											"stmt": {
												"blocks": [
													{
														"stmts": [
															{
																"stmt": {
																	"args": [
																		{
																			"type": "local",
																			"value": 0
																		},
																		{
																			"type": "local",
																			"value": 1
																		}
																	],
																	"col": 0,
																	"file": 0,
																	"func": "g0.data.test.a.b",
																	"result": 4,
																	"row": 0
																},
																"type": "CallStmt"
															},
															{
																"stmt": {
																	"col": 0,
																	"file": 0,
																	"key": {
																		"type": "string_index",
																		"value": 2
																	},
																	"object": 3,
																	"row": 0,
																	"value": {
																		"type": "local",
																		"value": 4
																	}
																},
																"type": "ObjectInsertStmt"
															}
														]
													}
												],
												"col": 0,
												"file": 0,
												"row": 0
											},
											"type": "BlockStmt"
										},
										{
											"stmt": {
												"col": 0,
												"file": 0,
												"key": {
													"type": "string_index",
													"value": 1
												},
												"object": 2,
												"row": 0,
												"value": {
													"type": "local",
													"value": 3
												}
											},
											"type": "ObjectInsertStmt"
										},
										{
											"stmt": {
												"blocks": [
													{
														"stmts": [
															{
																"stmt": {
																	"blocks": [
																		{
																			"stmts": [
																				{
																					"stmt": {
																						"col": 0,
																						"file": 0,
																						"key": {
																							"type": "string_index",
																							"value": 6
																						},
																						"row": 0,
																						"source": {
																							"type": "local",
																							"value": 1
																						},
																						"target": 6
																					},
																					"type": "DotStmt"
																				},
																				{
																					"stmt": {
																						"a": 6,
																						"b": 2,
																						"col": 0,
																						"file": 0,
																						"row": 0,
																						"target": 5
																					},
																					"type": "ObjectMergeStmt"
																				},
																				{
																					"stmt": {
																						"col": 0,
																						"file": 0,
																						"index": 1,
																						"row": 0
																					},
																					"type": "BreakStmt"
																				}
																			]
																		}
																	],
																	"col": 0,
																	"file": 0,
																	"row": 0
																},
																"type": "BlockStmt"
															},
															{
																"stmt": {
																	"col": 0,
																	"file": 0,
																	"row": 0,
																	"source": {
																		"type": "local",
																		"value": 2
																	},
																	"target": 5
																},
																"type": "AssignVarStmt"
															}
														]
													}
												],
												"col": 0,
												"file": 0,
												"row": 0
											},
											"type": "BlockStmt"
										},
										{
											"stmt": {
												"col": 0,
												"file": 0,
												"row": 0,
												"source": {
													"type": "local",
													"value": 5
												},
												"target": 7
											},
											"type": "AssignVarStmt"
										},
										{
											"stmt": {
												"col": 0,
												"file": 0,
												"row": 0,
												"target": 8
											},
											"type": "MakeObjectStmt"
										},
										{
											"stmt": {
												"col": 0,
												"file": 0,
												"key": {
													"type": "string_index",
													"value": 0
												},
												"object": 8,
												"row": 0,
												"value": {
													"type": "local",
													"value": 7
												}
											},
											"type": "ObjectInsertStmt"
										},
										{
											"stmt": {
												"col": 0,
												"file": 0,
												"row": 0,
												"value": 8
											},
											"type": "ResultSetAddStmt"
										}
									]
								}
							],
							"name": "test"
						}
					]
				},
				"static": {
					"files": [
						{
							"value": "mod_0"
						}
					],
					"strings": [
						{
							"value": "result"
						},
						{
							"value": "a"
						},
						{
							"value": "b"
						},
						{
							"value": "1"
						},
						{
							"value": "2"
						},
						{
							"value": "3"
						},
						{
							"value": "test"
						}
					]
				}
			},
			"want_plan_result": {
				"data_test": {
					"a": {
						"b": [
							1,
							2,
							3
						]
					}
				}
			}
		},
		{
			"note": "refheads/single-value: previously partial object",
			"query": "data.test.a.b = x",
			"modules": [
				"package test\n\na.b[x] := i if some i, x in [1, 2, 3]\n"
			],
			"want_result": [
				{
					"x": {
						"1": 0,
						"2": 1,
						"3": 2
					}
				}
			],
			"entrypoints": [
				"test"
			],
			"plan": {
				"funcs": {
					"funcs": [
						{
							"blocks": [
								{
									"stmts": [
										{
											"stmt": {
												"col": 1,
												"file": 0,
												"row": 3,
												"target": 2
											},
											"type": "MakeObjectStmt"
										}
									]
								},
								{
									"stmts": [
										{
											"stmt": {
												"col": 1,
												"file": 0,
												"row": 3,
												"target": 3
											},
											"type": "ResetLocalStmt"
										},
										{
											"stmt": {
												"capacity": 3,
												"col": 29,
												"file": 0,
												"row": 3,
												"target": 4
											},
											"type": "MakeArrayStmt"
										},
										{
											"stmt": {
												"Index": 3,
												"col": 29,
												"file": 0,
												"row": 3,
												"target": 5
											},
											"type": "MakeNumberRefStmt"
										},
										{
											"stmt": {
												"array": 4,
												"col": 29,
												"file": 0,
												"row": 3,
												"value": {
													"type": "local",
													"value": 5
												}
											},
											"type": "ArrayAppendStmt"
										},
										{
											"stmt": {
												"Index": 4,
												"col": 29,
												"file": 0,
												"row": 3,
												"target": 6
											},
											"type": "MakeNumberRefStmt"
										},
										{
											"stmt": {
												"array": 4,
												"col": 29,
												"file": 0,
												"row": 3,
												"value": {
													"type": "local",
													"value": 6
												}
											},
											"type": "ArrayAppendStmt"
										},
										{
											"stmt": {
												"Index": 5,
												"col": 29,
												"file": 0,
												"row": 3,
												"target": 7
											},
											"type": "MakeNumberRefStmt"
										},
										{
											"stmt": {
												"array": 4,
												"col": 29,
												"file": 0,
												"row": 3,
												"value": {
													"type": "local",
													"value": 7
												}
											},
											"type": "ArrayAppendStmt"
										},
										{
											"stmt": {
												"col": 29,
												"file": 0,
												"row": 3,
												"source": {
													"type": "local",
													"value": 4
												},
												"target": 8
											},
											"type": "AssignVarStmt"
										},
										{
											"stmt": {
												"block": {
													"stmts": [
														{
															"stmt": {
																"col": 16,
																"file": 0,
																"row": 3,
																"source": {
																	"type": "local",
																	"value": 9
																},
																"target": 11
															},
															"type": "AssignVarStmt"
														},
														{
															"stmt": {
																"col": 16,
																"file": 0,
																"row": 3,
																"source": {
																	"type": "local",
																	"value": 10
																},
																"target": 12
															},
															"type": "AssignVarStmt"
														},
														{
															"stmt": {
																"col": 1,
																"file": 0,
																"key": {
																	"type": "local",
																	"value": 12
																},
																"object": 2,
																"row": 3,
																"value": {
																	"type": "local",
																	"value": 11
																}
															},
															"type": "ObjectInsertOnceStmt"
														}
													]
												},
												"col": 16,
												"file": 0,
												"key": 9,
												"row": 3,
												"source": 8,
												"value": 10
											},
											"type": "ScanStmt"
										}
									]
								},
								{
									"stmts": [
										{
											"stmt": {
												"col": 1,
												"file": 0,
												"row": 3,
												"source": 2
											},
											"type": "ReturnLocalStmt"
										}
									]
								}
							],
							"name": "g0.data.test.a.b",
							"params": [
								0,
								1
							],
							"path": [
								"g0",
								"test",
								"a",
								"b"
							],
							"return": 2
						}
					]
				},
				"plans": {
					"plans": [
						{
							"blocks": [
								{
									"stmts": [
										{
											"stmt": {
												"col": 0,
												"file": 0,
												"row": 0,
												"target": 2
											},
											"type": "MakeObjectStmt"
										},
										{
											"stmt": {
												"col": 0,
												"file": 0,
												"row": 0,
												"target": 3
											},
											"type": "MakeObjectStmt"
										},
										{
											"stmt": {
												"blocks": [
													{
														"stmts": [
															{
																"stmt": {
																	"args": [
																		{
																			"type": "local",
																			"value": 0
																		},
																		{
																			"type": "local",
																			"value": 1
																		}
																	],
																	"col": 0,
																	"file": 0,
																	"func": "g0.data.test.a.b",
																	"result": 4,
																	"row": 0
																},
																"type": "CallStmt"
															},
															{
																"stmt": {
																	"col": 0,
																	"file": 0,
																	"key": {
																		"type": "string_index",
																		"value": 2
																	},
																	"object": 3,
																	"row": 0,
																	"value": {
																		"type": "local",
																		"value": 4
																	}
																},
																"type": "ObjectInsertStmt"
															}
														]
													}
												],
												"col": 0,
												"file": 0,
												"row": 0
											},
											"type": "BlockStmt"
										},
										{
											"stmt": {
												"col": 0,
												"file": 0,
												"key": {
													"type": "string_index",
													"value": 1
												},
												"object": 2,
												"row": 0,
												"value": {
													"type": "local",
													"value": 3
												}
											},
											"type": "ObjectInsertStmt"
										},
										{
											"stmt": {
												"blocks": [
													{
														"stmts": [
															{
																"stmt": {
																	"blocks": [
																		{
																			"stmts": [
																				{
																					"stmt": {
																						"col": 0,
																						"file": 0,
																						"key": {
																							"type": "string_index",
																							"value": 6
																						},
																						"row": 0,
																						"source": {
																							"type": "local",
																							"value": 1
																						},
																						"target": 6
																					},
																					"type": "DotStmt"
																				},
																				{
																					"stmt": {
																						"a": 6,
																						"b": 2,
																						"col": 0,
																						"file": 0,
																						"row": 0,
																						"target": 5
																					},
																					"type": "ObjectMergeStmt"
																				},
																				{
																					"stmt": {
																						"col": 0,
																						"file": 0,
																						"index": 1,
																						"row": 0
																					},
																					"type": "BreakStmt"
																				}
																			]
																		}
																	],
																	"col": 0,
																	"file": 0,
																	"row": 0
																},
																"type": "BlockStmt"
															},
															{
																"stmt": {
																	"col": 0,
																	"file": 0,
																	"row": 0,
																	"source": {
																		"type": "local",
																		"value": 2
																	},
																	"target": 5
																},
																"type": "AssignVarStmt"
															}
														]
													}
												],
												"col": 0,
												"file": 0,
												"row": 0
											},
											"type": "BlockStmt"
										},
										{
											"stmt": {
												"col": 0,
												"file": 0,
												"row": 0,
												"source": {
													"type": "local",
													"value": 5
												},
												"target": 7
											},
											"type": "AssignVarStmt"
										},
										{
											"stmt": {
												"col": 0,
												"file": 0,
												"row": 0,
												"target": 8
											},
											"type": "MakeObjectStmt"
										},
										{
											"stmt": {
												"col": 0,
												"file": 0,
												"key": {
													"type": "string_index",
													"value": 0
												},
												"object": 8,
												"row": 0,
												"value": {
													"type": "local",
													"value": 7
												}
											},
											"type": "ObjectInsertStmt"
										},
										{
											"stmt": {
												"col": 0,
												"file": 0,
												"row": 0,
												"value": 8
											},
											"type": "ResultSetAddStmt"
										}
									]
								}
							],
							"name": "test"
						}
					]
				},
				"static": {
					"files": [
						{
							"value": "mod_0"
						}
					],
					"strings": [
						{
							"value": "result"
						},
						{
							"value": "a"
						},
						{
							"value": "b"
						},
						{
							"value": "1"
						},
						{
							"value": "2"
						},
						{
							"value": "3"
						},
						{
							"value": "test"
						}
					]
				}
			},
			"want_plan_result": {
				"data_test": {
					"a": {
						"b": {
							"1": 0,
							"2": 1,
							"3": 2
						}
					}
				}
			}
		},
		{
			"note": "refheads/multi-value: same rule",
			"query": "data.test.a = x",
			"modules": [
				"package test\n\na.b.c.d contains 1\n",
				"package test.a\n\nb.c.d contains 2\n"
			],
			"want_result": [
				{
					"x": {
						"b": {
							"c": {
								"d": [
									1,
									2
								]
							}
						}
					}
				}
			],
			"entrypoints": [
				"test",
				"test/a"
			],
			"plan": {
				"funcs": {
					"funcs": [
						{
							"blocks": [
								{
									"stmts": [
										{
											"stmt": {
												"col": 1,
												"file": 0,
												"row": 3,
												"target": 2
											},
											"type": "MakeSetStmt"
										}
									]
								},
								{
									"stmts": [
										{
											"stmt": {
												"col": 1,
												"file": 0,
												"row": 3,
												"target": 3
											},
											"type": "ResetLocalStmt"
										},
										{
											"stmt": {
												"Index": 5,
												"col": 1,
												"file": 0,
												"row": 3,
												"target": 4
											},
											"type": "MakeNumberRefStmt"
										},
										{
											"stmt": {
												"col": 1,
												"file": 0,
												"row": 3,
												"set": 2,
												"value": {
													"type": "local",
													"value": 4
												}
											},
											"type": "SetAddStmt"
										}
									]
								},
								{
									"stmts": [
										{
											"stmt": {
												"col": 1,
												"file": 1,
												"row": 3,
												"target": 3
											},
											"type": "ResetLocalStmt"
										},
										{
											"stmt": {
												"Index": 6,
												"col": 1,
												"file": 1,
												"row": 3,
												"target": 4
											},
											"type": "MakeNumberRefStmt"
										},
										{
											"stmt": {
												"col": 1,
												"file": 1,
												"row": 3,
												"set": 2,
												"value": {
													"type": "local",
													"value": 4
												}
											},
											"type": "SetAddStmt"
										}
									]
								},
								{
									"stmts": [
										{
											"stmt": {
												"col": 1,
												"file": 0,
												"row": 3,
												"source": 2
											},
											"type": "ReturnLocalStmt"
										}
									]
								}
							],
							"name": "g0.data.test.a.b.c.d",
							"params": [
								0,
								1
							],
							"path": [
								"g0",
								"test",
								"a",
								"b",
								"c",
								"d"
							],
							"return": 2
						}
					]
				},
				"plans": {
					"plans": [
						{
							"blocks": [
								{
									"stmts": [
										{
											"stmt": {
												"col": 0,
												"file": 0,
												"row": 0,
												"target": 2
											},
											"type": "MakeObjectStmt"
										},
										{
											"stmt": {
												"col": 0,
												"file": 0,
												"row": 0,
												"target": 3
											},
											"type": "MakeObjectStmt"
										},
										{
											"stmt": {
												"col": 0,
												"file": 0,
												"row": 0,
												"target": 4
											},
											"type": "MakeObjectStmt"
										},
										{
											"stmt": {
												"col": 0,
												"file": 0,
												"row": 0,
												"target": 5
											},
											"type": "MakeObjectStmt"
										},
										{
											"stmt": {
												"blocks": [
													{
														"stmts": [
															{
																"stmt": {
																	"args": [
																		{
																			"type": "local",
																			"value": 0
																		},
																		{
																			"type": "local",
																			"value": 1
																		}
																	],
																	"col": 0,
																	"file": 0,
																	"func": "g0.data.test.a.b.c.d",
																	"result": 6,
																	"row": 0
																},
																"type": "CallStmt"
															},
															{
																"stmt": {
																	"col": 0,
																	"file": 0,
																	"key": {
																		"type": "string_index",
																		"value": 4
																	},
																	"object": 5,
																	"row": 0,
																	"value": {
																		"type": "local",
																		"value": 6
																	}
																},
																"type": "ObjectInsertStmt"
															}
														]
													}
												],
												"col": 0,
												"file": 0,
												"row": 0
											},
											"type": "BlockStmt"
										},
										{
											"stmt": {
												"col": 0,
												"file": 0,
												"key": {
													"type": "string_index",
													"value": 3
												},
												"object": 4,
												"row": 0,
												"value": {
													"type": "local",
													"value": 5
												}
											},
											"type": "ObjectInsertStmt"
										},
										{
											"stmt": {
												"col": 0,
												"file": 0,
												"key": {
													"type": "string_index",
													"value": 2
												},
												"object": 3,
												"row": 0,
												"value": {
													"type": "local",
													"value": 4
												}
											},
											"type": "ObjectInsertStmt"
										},
										{
											"stmt": {
												"col": 0,
												"file": 0,
												"key": {
													"type": "string_index",
													"value": 1
												},
												"object": 2,
												"row": 0,
												"value": {
													"type": "local",
													"value": 3
												}
											},
											"type": "ObjectInsertStmt"
										},
										{
											"stmt": {
												"blocks": [
													{
														"stmts": [
															{
																"stmt": {
																	"blocks": [
																		{
																			"stmts": [
																				{
																					"stmt": {
																						"col": 0,
																						"file": 0,
																						"key": {
																							"type": "string_index",
																							"value": 7
																						},
																						"row": 0,
																						"source": {
																							"type": "local",
																							"value": 1
																						},
																						"target": 8
																					},
																					"type": "DotStmt"
																				},
																				{
																					"stmt": {
																						"a": 8,
																						"b": 2,
																						"col": 0,
																						"file": 0,
																						"row": 0,
																						"target": 7
																					},
																					"type": "ObjectMergeStmt"
																				},
																				{
																					"stmt": {
																						"col": 0,
																						"file": 0,
																						"index": 1,
																						"row": 0
																					},
																					"type": "BreakStmt"
																				}
																			]
																		}
																	],
																	"col": 0,
																	"file": 0,
																	"row": 0
																},
																"type": "BlockStmt"
															},
															{
																"stmt": {
																	"col": 0,
																	"file": 0,
																	"row": 0,
																	"source": {
																		"type": "local",
																		"value": 2
																	},
																	"target": 7
																},
																"type": "AssignVarStmt"
															}
														]
													}
												],
												"col": 0,
												"file": 0,
												"row": 0
											},
											"type": "BlockStmt"
										},
										{
											"stmt": {
												"col": 0,
												"file": 0,
												"row": 0,
												"source": {
													"type": "local",
													"value": 7
												},
												"target": 9
											},
											"type": "AssignVarStmt"
										},
										{
											"stmt": {
												"col": 0,
												"file": 0,
												"row": 0,
												"target": 10
											},
											"type": "MakeObjectStmt"
										},
										{
											"stmt": {
												"col": 0,
												"file": 0,
												"key": {
													"type": "string_index",
													"value": 0
												},
												"object": 10,
												"row": 0,
												"value": {
													"type": "local",
													"value": 9
												}
											},
											"type": "ObjectInsertStmt"
										},
										{
											"stmt": {
												"col": 0,
												"file": 0,
												"row": 0,
												"value": 10
											},
											"type": "ResultSetAddStmt"
										}
									]
								}
							],
							"name": "test"
						},
						{
							"blocks": [
								{
									"stmts": [
										{
											"stmt": {
												"col": 0,
												"file": 0,
												"row": 0,
												"target": 11
											},
											"type": "MakeObjectStmt"
										},
										{
											"stmt": {
												"col": 0,
												"file": 0,
												"row": 0,
												"target": 12
											},
											"type": "MakeObjectStmt"
										},
										{
											"stmt": {
												"col": 0,
												"file": 0,
												"row": 0,
												"target": 13
											},
											"type": "MakeObjectStmt"
										},
										{
											"stmt": {
												"blocks": [
													{
														"stmts": [
															{
																"stmt": {
																	"args": [
																		{
																			"type": "local",
																			"value": 0
																		},
																		{
																			"type": "local",
																			"value": 1
																		}
																	],
																	"col": 0,
																	"file": 0,
																	"func": "g0.data.test.a.b.c.d",
																	"result": 14,
																	"row": 0
																},
																"type": "CallStmt"
															},
															{
																"stmt": {
																	"col": 0,
																	"file": 0,
																	"key": {
																		"type": "string_index",
																		"value": 4
																	},
																	"object": 13,
																	"row": 0,
																	"value": {
																		"type": "local",
																		"value": 14
																	}
																},
																"type": "ObjectInsertStmt"
															}
														]
													}
												],
												"col": 0,
												"file": 0,
												"row": 0
											},
											"type": "BlockStmt"
										},
										{
											"stmt": {
												"col": 0,
												"file": 0,
												"key": {
													"type": "string_index",
													"value": 3
												},
												"object": 12,
												"row": 0,
												"value": {
													"type": "local",
													"value": 13
												}
											},
											"type": "ObjectInsertStmt"
										},
										{
											"stmt": {
												"col": 0,
												"file": 0,
												"key": {
													"type": "string_index",
													"value": 2
												},
												"object": 11,
												"row": 0,
												"value": {
													"type": "local",
													"value": 12
												}
											},
											"type": "ObjectInsertStmt"
										},
										{
											"stmt": {
												"blocks": [
													{
														"stmts": [
															{
																"stmt": {
																	"blocks": [
																		{
																			"stmts": [
																				{
																					"stmt": {
																						"col": 0,
																						"file": 0,
																						"key": {
																							"type": "string_index",
																							"value": 7
																						},
																						"row": 0,
																						"source": {
																							"type": "local",
																							"value": 1
																						},
																						"target": 16
																					},
																					"type": "DotStmt"
																				},
																				{
																					"stmt": {
																						"col": 0,
																						"file": 0,
																						"key": {
																							"type": "string_index",
																							"value": 1
																						},
																						"row": 0,
																						"source": {
																							"type": "local",
																							"value": 16
																						},
																						"target": 17
																					},
																					"type": "DotStmt"
																				},
																				{
																					"stmt": {
																						"a": 17,
																						"b": 11,
																						"col": 0,
																						"file": 0,
																						"row": 0,
																						"target": 15
																					},
																					"type": "ObjectMergeStmt"
																				},
																				{
																					"stmt": {
																						"col": 0,
																						"file": 0,
																						"index": 1,
																						"row": 0
																					},
																					"type": "BreakStmt"
																				}
																			]
																		}
																	],
																	"col": 0,
																	"file": 0,
																	"row": 0
																},
																"type": "BlockStmt"
															},
															{
																"stmt": {
																	"col": 0,
																	"file": 0,
																	"row": 0,
																	"source": {
																		"type": "local",
																		"value": 11
																	},
																	"target": 15
																},
																"type": "AssignVarStmt"
															}
														]
													}
												],
												"col": 0,
												"file": 0,
												"row": 0
											},
											"type": "BlockStmt"
										},
										{
											"stmt": {
												"col": 0,
												"file": 0,
												"row": 0,
												"source": {
													"type": "local",
													"value": 15
												},
												"target": 18
											},
											"type": "AssignVarStmt"
										},
										{
											"stmt": {
												"col": 0,
												"file": 0,
												"row": 0,
												"target": 19
											},
											"type": "MakeObjectStmt"
										},
										{
											"stmt": {
												"col": 0,
												"file": 0,
												"key": {
													"type": "string_index",
													"value": 0
												},
												"object": 19,
												"row": 0,
												"value": {
													"type": "local",
													"value": 18
												}
											},
											"type": "ObjectInsertStmt"
										},
										{
											"stmt": {
												"col": 0,
												"file": 0,
												"row": 0,
												"value": 19
											},
											"type": "ResultSetAddStmt"
										}
									]
								}
							],
							"name": "test/a"
						}
					]
				},
				"static": {
					"files": [
						{
							"value": "mod_0"
						},
						{
							"value": "mod_1"
						}
					],
					"strings": [
						{
							"value": "result"
						},
						{
							"value": "a"
						},
						{
							"value": "b"
						},
						{
							"value": "c"
						},
						{
							"value": "d"
						},
						{
							"value": "1"
						},
						{
							"value": "2"
						},
						{
							"value": "test"
						}
					]
				}
			},
			"want_plan_result": {
				"data_test": {
					"a": {
						"b": {
							"c": {
								"d": [
									1,
									2
								]
							}
						}
					}
				},
				"data_test_a": {
					"b": {
						"c": {
							"d": [
								1,
								2
							]
						}
					}
				}
			}
		},
		{
			"note": "refheads/single-value default rule",
			"query": "data.test.a = x",
			"modules": [
				"package test\n\ndefault a.b.c := \"d\"\n"
			],
			"want_result": [
				{
					"x": {
						"b": {
							"c": "d"
						}
					}
				}
			],
			"entrypoints": [
				"test"
			],
			"plan": {
				"funcs": {
					"funcs": [
						{
							"blocks": [
								{
									"stmts": [
										{
											"stmt": {
												"col": 9,
												"file": 0,
												"row": 3,
												"source": 2
											},
											"type": "IsUndefinedStmt"
										},
										{
											"stmt": {
												"col": 9,
												"file": 0,
												"row": 3,
												"source": {
													"type": "string_index",
													"value": 4
												},
												"target": 2
											},
											"type": "AssignVarOnceStmt"
										}
									]
								},
								{
									"stmts": [
										{
											"stmt": {
												"col": 9,
												"file": 0,
												"row": 3,
												"source": 2
											},
											"type": "ReturnLocalStmt"
										}
									]
								}
							],
							"name": "g0.data.test.a.b.c",
							"params": [
								0,
								1
							],
							"path": [
								"g0",
								"test",
								"a",
								"b",
								"c"
							],
							"return": 2
						}
					]
				},
				"plans": {
					"plans": [
						{
							"blocks": [
								{
									"stmts": [
										{
											"stmt": {
												"col": 0,
												"file": 0,
												"row": 0,
												"target": 2
											},
											"type": "MakeObjectStmt"
										},
										{
											"stmt": {
												"col": 0,
												"file": 0,
												"row": 0,
												"target": 3
											},
											"type": "MakeObjectStmt"
										},
										{
											"stmt": {
												"col": 0,
												"file": 0,
												"row": 0,
												"target": 4
											},
											"type": "MakeObjectStmt"
										},
										{
											"stmt": {
												"blocks": [
													{
														"stmts": [
															{
																"stmt": {
																	"args": [
																		{
																			"type": "local",
																			"value": 0
																		},
																		{
																			"type": "local",
																			"value": 1
																		}
																	],
																	"col": 0,
																	"file": 0,
																	"func": "g0.data.test.a.b.c",
																	"result": 5,
																	"row": 0
																},
																"type": "CallStmt"
															},
															{
																"stmt": {
																	"col": 0,
																	"file": 0,
																	"key": {
																		"type": "string_index",
																		"value": 3
																	},
																	"object": 4,
																	"row": 0,
																	"value": {
																		"type": "local",
																		"value": 5
																	}
																},
																"type": "ObjectInsertStmt"
															}
														]
													}
												],
												"col": 0,
												"file": 0,
												"row": 0
											},
											"type": "BlockStmt"
										},
										{
											"stmt": {
												"col": 0,
												"file": 0,
												"key": {
													"type": "string_index",
													"value": 2
												},
												"object": 3,
												"row": 0,
												"value": {
													"type": "local",
													"value": 4
												}
											},
											"type": "ObjectInsertStmt"
										},
										{
											"stmt": {
												"col": 0,
												"file": 0,
												"key": {
													"type": "string_index",
													"value": 1
												},
												"object": 2,
												"row": 0,
												"value": {
													"type": "local",
													"value": 3
												}
											},
											"type": "ObjectInsertStmt"
										},
										{
											"stmt": {
												"blocks": [
													{
														"stmts": [
															{
																"stmt": {
																	"blocks": [
																		{
																			"stmts": [
																				{
																					"stmt": {
																						"col": 0,
																						"file": 0,
																						"key": {
																							"type": "string_index",
																							"value": 5
																						},
																						"row": 0,
																						"source": {
																							"type": "local",
																							"value": 1
																						},
																						"target": 7
																					},
																					"type": "DotStmt"
																				},
																				{
																					"stmt": {
																						"a": 7,
																						"b": 2,
																						"col": 0,
																						"file": 0,
																						"row": 0,
																						"target": 6
																					},
																					"type": "ObjectMergeStmt"
																				},
																				{
																					"stmt": {
																						"col": 0,
																						"file": 0,
																						"index": 1,
																						"row": 0
																					},
																					"type": "BreakStmt"
																				}
																			]
																		}
																	],
																	"col": 0,
																	"file": 0,
																	"row": 0
																},
																"type": "BlockStmt"
															},
															{
																"stmt": {
																	"col": 0,
																	"file": 0,
																	"row": 0,
																	"source": {
																		"type": "local",
																		"value": 2
																	},
																	"target": 6
																},
																"type": "AssignVarStmt"
															}
														]
													}
												],
												"col": 0,
												"file": 0,
												"row": 0
											},
											"type": "BlockStmt"
										},
										{
											"stmt": {
												"col": 0,
												"file": 0,
												"row": 0,
												"source": {
													"type": "local",
													"value": 6
												},
												"target": 8
											},
											"type": "AssignVarStmt"
										},
										{
											"stmt": {
												"col": 0,
												"file": 0,
												"row": 0,
												"target": 9
											},
											"type": "MakeObjectStmt"
										},
										{
											"stmt": {
												"col": 0,
												"file": 0,
												"key": {
													"type": "string_index",
													"value": 0
												},
												"object": 9,
												"row": 0,
												"value": {
													"type": "local",
													"value": 8
												}
											},
											"type": "ObjectInsertStmt"
										},
										{
											"stmt": {
												"col": 0,
												"file": 0,
												"row": 0,
												"value": 9
											},
											"type": "ResultSetAddStmt"
										}
									]
								}
							],
							"name": "test"
						}
					]
				},
				"static": {
					"files": [
						{
							"value": "mod_0"
						}
					],
					"strings": [
						{
							"value": "result"
						},
						{
							"value": "a"
						},
						{
							"value": "b"
						},
						{
							"value": "c"
						},
						{
							"value": "d"
						},
						{
							"value": "test"
						}
					]
				}
			},
			"want_plan_result": {
				"data_test": {
					"a": {
						"b": {
							"c": "d"
						}
					}
				}
			}
		},
		{
			"note": "refheads/single-value example",
			"query": "data.test.a = x",
			"modules": [
				"package test\n\nq[7] := 8\n\na[x] if q[x]\n"
			],
			"want_result": [
				{
					"x": {
						"7": true
					}
				}
			],
			"entrypoints": [
				"test"
			],
			"plan": {
				"funcs": {
					"funcs": [
						{
							"blocks": [
								{
									"stmts": [
										{
											"stmt": {
												"col": 1,
												"file": 0,
												"row": 3,
												"target": 2
											},
											"type": "MakeObjectStmt"
										}
									]
								},
								{
									"stmts": [
										{
											"stmt": {
												"col": 1,
												"file": 0,
												"row": 3,
												"target": 3
											},
											"type": "ResetLocalStmt"
										},
										{
											"stmt": {
												"Index": 2,
												"col": 1,
												"file": 0,
												"row": 3,
												"target": 4
											},
											"type": "MakeNumberRefStmt"
										},
										{
											"stmt": {
												"Index": 3,
												"col": 1,
												"file": 0,
												"row": 3,
												"target": 5
											},
											"type": "MakeNumberRefStmt"
										},
										{
											"stmt": {
												"col": 1,
												"file": 0,
												"key": {
													"type": "local",
													"value": 5
												},
												"object": 2,
												"row": 3,
												"value": {
													"type": "local",
													"value": 4
												}
											},
											"type": "ObjectInsertOnceStmt"
										}
									]
								},
								{
									"stmts": [
										{
											"stmt": {
												"col": 1,
												"file": 0,
												"row": 3,
												"source": 2
											},
											"type": "ReturnLocalStmt"
										}
									]
								}
							],
							"name": "g0.data.test.q",
							"params": [
								0,
								1
							],
							"path": [
								"g0",
								"test",
								"q"
							],
							"return": 2
						},
						{
							"blocks": [
								{
									"stmts": [
										{
											"stmt": {
												"col": 1,
												"file": 0,
												"row": 5,
												"target": 2
											},
											"type": "MakeObjectStmt"
										}
									]
								},
								{
									"stmts": [
										{
											"stmt": {
												"col": 1,
												"file": 0,
												"row": 5,
												"target": 3
											},
											"type": "ResetLocalStmt"
										},
										{
											"stmt": {
												"args": [
													{
														"type": "local",
														"value": 0
													},
													{
														"type": "local",
														"value": 1
													}
												],
												"col": 9,
												"file": 0,
												"func": "g0.data.test.q",
												"result": 4,
												"row": 5
											},
											"type": "CallStmt"
										},
										{
											"stmt": {
												"block": {
													"stmts": [
														{
															"stmt": {
																"col": 9,
																"file": 0,
																"row": 5,
																"source": {
																	"type": "local",
																	"value": 5
																},
																"target": 7
															},
															"type": "AssignVarStmt"
														},
														{
															"stmt": {
																"a": {
																	"type": "local",
																	"value": 6
																},
																"b": {
																	"type": "bool",
																	"value": false
																},
																"col": 9,
																"file": 0,
																"row": 5
															},
															"type": "NotEqualStmt"
														},
														{
															"stmt": {
																"col": 1,
																"file": 0,
																"key": {
																	"type": "local",
																	"value": 7
																},
																"object": 2,
																"row": 5,
																"value": {
																	"type": "bool",
																	"value": true
																}
															},
															"type": "ObjectInsertOnceStmt"
														}
													]
												},
												"col": 9,
												"file": 0,
												"key": 5,
												"row": 5,
												"source": 4,
												"value": 6
											},
											"type": "ScanStmt"
										}
									]
								},
								{
									"stmts": [
										{
											"stmt": {
												"col": 1,
												"file": 0,
												"row": 5,
												"source": 2
											},
											"type": "ReturnLocalStmt"
										}
									]
								}
							],
							"name": "g0.data.test.a",
							"params": [
								0,
								1
							],
							"path": [
								"g0",
								"test",
								"a"
							],
							"return": 2
						}
					]
				},
				"plans": {
					"plans": [
						{
							"blocks": [
								{
									"stmts": [
										{
											"stmt": {
												"col": 0,
												"file": 0,
												"row": 0,
												"target": 2
											},
											"type": "MakeObjectStmt"
										},
										{
											"stmt": {
												"blocks": [
													{
														"stmts": [
															{
																"stmt": {
																	"args": [
																		{
																			"type": "local",
																			"value": 0
																		},
																		{
																			"type": "local",
																			"value": 1
																		}
																	],
																	"col": 0,
																	"file": 0,
																	"func": "g0.data.test.a",
																	"result": 3,
																	"row": 0
																},
																"type": "CallStmt"
															},
															{
																"stmt": {
																	"col": 0,
																	"file": 0,
																	"key": {
																		"type": "string_index",
																		"value": 1
																	},
																	"object": 2,
																	"row": 0,
																	"value": {
																		"type": "local",
																		"value": 3
																	}
																},
																"type": "ObjectInsertStmt"
															}
														]
													}
												],
												"col": 0,
												"file": 0,
												"row": 0
											},
											"type": "BlockStmt"
										},
										{
											"stmt": {
												"blocks": [
													{
														"stmts": [
															{
																"stmt": {
																	"args": [
																		{
																			"type": "local",
																			"value": 0
																		},
																		{
																			"type": "local",
																			"value": 1
																		}
																	],
																	"col": 0,
																	"file": 0,
																	"func": "g0.data.test.q",
																	"result": 4,
																	"row": 0
																},
																"type": "CallStmt"
															},
															{
																"stmt": {
																	"col": 0,
																	"file": 0,
																	"key": {
																		"type": "string_index",
																		"value": 4
																	},
																	"object": 2,
																	"row": 0,
																	"value": {
																		"type": "local",
																		"value": 4
																	}
																},
																"type": "ObjectInsertStmt"
															}
														]
													}
												],
												"col": 0,
												"file": 0,
												"row": 0
											},
											"type": "BlockStmt"
										},
										{
											"stmt": {
												"blocks": [
													{
														"stmts": [
															{
																"stmt": {
																	"blocks": [
																		{
																			"stmts": [
																				{
																					"stmt": {
																						"col": 0,
																						"file": 0,
																						"key": {
																							"type": "string_index",
																							"value": 5
																						},
																						"row": 0,
																						"source": {
																							"type": "local",
																							"value": 1
																						},
																						"target": 6
																					},
																					"type": "DotStmt"
																				},
																				{
																					"stmt": {
																						"a": 6,
																						"b": 2,
																						"col": 0,
																						"file": 0,
																						"row": 0,
																						"target": 5
																					},
																					"type": "ObjectMergeStmt"
																				},
																				{
																					"stmt": {
																						"col": 0,
																						"file": 0,
																						"index": 1,
																						"row": 0
																					},
																					"type": "BreakStmt"
																				}
																			]
																		}
																	],
																	"col": 0,
																	"file": 0,
																	"row": 0
																},
																"type": "BlockStmt"
															},
															{
																"stmt": {
																	"col": 0,
																	"file": 0,
																	"row": 0,
																	"source": {
																		"type": "local",
																		"value": 2
																	},
																	"target": 5
																},
																"type": "AssignVarStmt"
															}
														]
													}
												],
												"col": 0,
												"file": 0,
												"row": 0
											},
											"type": "BlockStmt"
										},
										{
											"stmt": {
												"col": 0,
												"file": 0,
												"row": 0,
												"source": {
													"type": "local",
													"value": 5
												},
												"target": 7
											},
											"type": "AssignVarStmt"
										},
										{
											"stmt": {
												"col": 0,
												"file": 0,
												"row": 0,
												"target": 8
											},
											"type": "MakeObjectStmt"
										},
										{
											"stmt": {
												"col": 0,
												"file": 0,
												"key": {
													"type": "string_index",
													"value": 0
												},
												"object": 8,
												"row": 0,
												"value": {
													"type": "local",
													"value": 7
												}
											},
											"type": "ObjectInsertStmt"
										},
										{
											"stmt": {
												"col": 0,
												"file": 0,
												"row": 0,
												"value": 8
											},
											"type": "ResultSetAddStmt"
										}
									]
								}
							],
							"name": "test"
						}
					]
				},
				"static": {
					"files": [
						{
							"value": "mod_0"
						}
					],
					"strings": [
						{
							"value": "result"
						},
						{
							"value": "a"
						},
						{
							"value": "8"
						},
						{
							"value": "7"
						},
						{
							"value": "q"
						},
						{
							"value": "test"
						}
					]
				}
			},
			"want_plan_result": {
				"data_test": {
					"a": {
						"7": true
					},
					"q": {
						"7": 8
					}
				}
			}
		},
		{
			"note": "refheads/single-value example, false",
			"query": "data.test.a = x",
			"modules": [
				"package test\n\nq[7] := 8 if false\n\na[x] if q[x]\n"
			],
			"want_result": [
				{
					"x": {}
				}
			],
			"entrypoints": [
				"test"
			],
			"plan": {
				"funcs": {
					"funcs": [
						{
							"blocks": [
								{
									"stmts": [
										{
											"stmt": {
												"col": 1,
												"file": 0,
												"row": 3,
												"target": 2
											},
											"type": "MakeObjectStmt"
										}
									]
								},
								{
									"stmts": [
										{
											"stmt": {
												"col": 1,
												"file": 0,
												"row": 3,
												"target": 3
											},
											"type": "ResetLocalStmt"
										},
										{
											"stmt": {
												"col": 14,
												"file": 0,
												"index": 0,
												"row": 3
											},
											"type": "BreakStmt"
										},
										{
											"stmt": {
												"Index": 2,
												"col": 1,
												"file": 0,
												"row": 3,
												"target": 4
											},
											"type": "MakeNumberRefStmt"
										},
										{
											"stmt": {
												"Index": 3,
												"col": 1,
												"file": 0,
												"row": 3,
												"target": 5
											},
											"type": "MakeNumberRefStmt"
										},
										{
											"stmt": {
												"col": 1,
												"file": 0,
												"key": {
													"type": "local",
													"value": 5
												},
												"object": 2,
												"row": 3,
												"value": {
													"type": "local",
													"value": 4
												}
											},
											"type": "ObjectInsertOnceStmt"
										}
									]
								},
								{
									"stmts": [
										{
											"stmt": {
												"col": 1,
												"file": 0,
												"row": 3,
												"source": 2
											},
											"type": "ReturnLocalStmt"
										}
									]
								}
							],
							"name": "g0.data.test.q",
							"params": [
								0,
								1
							],
							"path": [
								"g0",
								"test",
								"q"
							],
							"return": 2
						},
						{
							"blocks": [
								{
									"stmts": [
										{
											"stmt": {
												"col": 1,
												"file": 0,
												"row": 5,
												"target": 2
											},
											"type": "MakeObjectStmt"
										}
									]
								},
								{
									"stmts": [
										{
											"stmt": {
												"col": 1,
												"file": 0,
												"row": 5,
												"target": 3
											},
											"type": "ResetLocalStmt"
										},
										{
											"stmt": {
												"args": [
													{
														"type": "local",
														"value": 0
													},
													{
														"type": "local",
														"value": 1
													}
												],
												"col": 9,
												"file": 0,
												"func": "g0.data.test.q",
												"result": 4,
												"row": 5
											},
											"type": "CallStmt"
										},
										{
											"stmt": {
												"block": {
													"stmts": [
														{
															"stmt": {
																"col": 9,
																"file": 0,
																"row": 5,
																"source": {
																	"type": "local",
																	"value": 5
																},
																"target": 7
															},
															"type": "AssignVarStmt"
														},
														{
															"stmt": {
																"a": {
																	"type": "local",
																	"value": 6
																},
																"b": {
																	"type": "bool",
																	"value": false
																},
																"col": 9,
																"file": 0,
																"row": 5
															},
															"type": "NotEqualStmt"
														},
														{
															"stmt": {
																"col": 1,
																"file": 0,
																"key": {
																	"type": "local",
																	"value": 7
																},
																"object": 2,
																"row": 5,
																"value": {
																	"type": "bool",
																	"value": true
																}
															},
															"type": "ObjectInsertOnceStmt"
														}
													]
												},
												"col": 9,
												"file": 0,
												"key": 5,
												"row": 5,
												"source": 4,
												"value": 6
											},
											"type": "ScanStmt"
										}
									]
								},
								{
									"stmts": [
										{
											"stmt": {
												"col": 1,
												"file": 0,
												"row": 5,
												"source": 2
											},
											"type": "ReturnLocalStmt"
										}
									]
								}
							],
							"name": "g0.data.test.a",
							"params": [
								0,
								1
							],
							"path": [
								"g0",
								"test",
								"a"
							],
							"return": 2
						}
					]
				},
				"plans": {
					"plans": [
						{
							"blocks": [
								{
									"stmts": [
										{
											"stmt": {
												"col": 0,
												"file": 0,
												"row": 0,
												"target": 2
											},
											"type": "MakeObjectStmt"
										},
										{
											"stmt": {
												"blocks": [
													{
														"stmts": [
															{
																"stmt": {
																	"args": [
																		{
																			"type": "local",
																			"value": 0
																		},
																		{
																			"type": "local",
																			"value": 1
																		}
																	],
																	"col": 0,
																	"file": 0,
																	"func": "g0.data.test.a",
																	"result": 3,
																	"row": 0
																},
																"type": "CallStmt"
															},
															{
																"stmt": {
																	"col": 0,
																	"file": 0,
																	"key": {
																		"type": "string_index",
																		"value": 1
																	},
																	"object": 2,
																	"row": 0,
																	"value": {
																		"type": "local",
																		"value": 3
																	}
																},
																"type": "ObjectInsertStmt"
															}
														]
													}
												],
												"col": 0,
												"file": 0,
												"row": 0
											},
											"type": "BlockStmt"
										},
										{
											"stmt": {
												"blocks": [
													{
														"stmts": [
															{
																"stmt": {
																	"args": [
																		{
																			"type": "local",
																			"value": 0
																		},
																		{
																			"type": "local",
																			"value": 1
																		}
																	],
																	"col": 0,
																	"file": 0,
																	"func": "g0.data.test.q",
																	"result": 4,
																	"row": 0
																},
																"type": "CallStmt"
															},
															{
																"stmt": {
																	"col": 0,
																	"file": 0,
																	"key": {
																		"type": "string_index",
																		"value": 4
																	},
																	"object": 2,
																	"row": 0,
																	"value": {
																		"type": "local",
																		"value": 4
																	}
																},
																"type": "ObjectInsertStmt"
															}
														]
													}
												],
												"col": 0,
												"file": 0,
												"row": 0
											},
											"type": "BlockStmt"
										},
										{
											"stmt": {
												"blocks": [
													{
														"stmts": [
															{
																"stmt": {
																	"blocks": [
																		{
																			"stmts": [
																				{
																					"stmt": {
																						"col": 0,
																						"file": 0,
																						"key": {
																							"type": "string_index",
																							"value": 5
																						},
																						"row": 0,
																						"source": {
																							"type": "local",
																							"value": 1
																						},
																						"target": 6
																					},
																					"type": "DotStmt"
																				},
																				{
																					"stmt": {
																						"a": 6,
																						"b": 2,
																						"col": 0,
																						"file": 0,
																						"row": 0,
																						"target": 5
																					},
																					"type": "ObjectMergeStmt"
																				},
																				{
																					"stmt": {
																						"col": 0,
																						"file": 0,
																						"index": 1,
																						"row": 0
																					},
																					"type": "BreakStmt"
																				}
																			]
																		}
																	],
																	"col": 0,
																	"file": 0,
																	"row": 0
																},
																"type": "BlockStmt"
															},
															{
																"stmt": {
																	"col": 0,
																	"file": 0,
																	"row": 0,
																	"source": {
																		"type": "local",
																		"value": 2
																	},
																	"target": 5
																},
																"type": "AssignVarStmt"
															}
														]
													}
												],
												"col": 0,
												"file": 0,
												"row": 0
											},
											"type": "BlockStmt"
										},
										{
											"stmt": {
												"col": 0,
												"file": 0,
												"row": 0,
												"source": {
													"type": "local",
													"value": 5
												},
												"target": 7
											},
											"type": "AssignVarStmt"
										},
										{
											"stmt": {
												"col": 0,
												"file": 0,
												"row": 0,
												"target": 8
											},
											"type": "MakeObjectStmt"
										},
										{
											"stmt": {
												"col": 0,
												"file": 0,
												"key": {
													"type": "string_index",
													"value": 0
												},
												"object": 8,
												"row": 0,
												"value": {
													"type": "local",
													"value": 7
												}
											},
											"type": "ObjectInsertStmt"
										},
										{
											"stmt": {
												"col": 0,
												"file": 0,
												"row": 0,
												"value": 8
											},
											"type": "ResultSetAddStmt"
										}
									]
								}
							],
							"name": "test"
						}
					]
				},
				"static": {
					"files": [
						{
							"value": "mod_0"
						}
					],
					"strings": [
						{
							"value": "result"
						},
						{
							"value": "a"
						},
						{
							"value": "8"
						},
						{
							"value": "7"
						},
						{
							"value": "q"
						},
						{
							"value": "test"
						}
					]
				}
			},
			"want_plan_result": {
				"data_test": {
					"a": {},
					"q": {}
				}
			}
		},
		{
			"note": "refheads/mixed example, multiple rules",
			"query": "data.test.a.b = x",
			"modules": [
				"package test\n\na.b.c := \"d\"\n\na.b.e := \"f\"\n\na.b.g contains x if some x in numbers.range(1, 3)\n\na.b.h[x] := 1 if x := \"one\"\n"
			],
			"want_result": [
				{
					"x": {
						"c": "d",
						"e": "f",
						"g": [
							1,
							2,
							3
						],
						"h": {
							"one": 1
						}
					}
				}
			],
			"entrypoints": [
				"test"
			],
			"plan": {
				"funcs": {
					"funcs": [
						{
							"blocks": [
								{
									"stmts": [
										{
											"stmt": {
												"col": 1,
												"file": 0,
												"row": 3,
												"target": 3
											},
											"type": "ResetLocalStmt"
										},
										{
											"stmt": {
												"col": 1,
												"file": 0,
												"row": 3,
												"source": {
													"type": "string_index",
													"value": 4
												},
												"target": 3
											},
											"type": "AssignVarOnceStmt"
										}
									]
								},
								{
									"stmts": [
										{
											"stmt": {
												"col": 1,
												"file": 0,
												"row": 3,
												"source": 3
											},
											"type": "IsDefinedStmt"
										},
										{
											"stmt": {
												"col": 1,
												"file": 0,
												"row": 3,
												"source": {
													"type": "local",
													"value": 3
												},
												"target": 2
											},
											"type": "AssignVarOnceStmt"
										}
									]
								},
								{
									"stmts": [
										{
											"stmt": {
												"col": 1,
												"file": 0,
												"row": 3,
												"source": 2
											},
											"type": "ReturnLocalStmt"
										}
									]
								}
							],
							"name": "g0.data.test.a.b.c",
							"params": [
								0,
								1
							],
							"path": [
								"g0",
								"test",
								"a",
								"b",
								"c"
							],
							"return": 2
						},
						{
							"blocks": [
								{
									"stmts": [
										{
											"stmt": {
												"col": 1,
												"file": 0,
												"row": 5,
												"target": 3
											},
											"type": "ResetLocalStmt"
										},
										{
											"stmt": {
												"col": 1,
												"file": 0,
												"row": 5,
												"source": {
													"type": "string_index",
													"value": 6
												},
												"target": 3
											},
											"type": "AssignVarOnceStmt"
										}
									]
								},
								{
									"stmts": [
										{
											"stmt": {
												"col": 1,
												"file": 0,
												"row": 5,
												"source": 3
											},
											"type": "IsDefinedStmt"
										},
										{
											"stmt": {
												"col": 1,
												"file": 0,
												"row": 5,
												"source": {
													"type": "local",
													"value": 3
												},
												"target": 2
											},
											"type": "AssignVarOnceStmt"
										}
									]
								},
								{
									"stmts": [
										{
											"stmt": {
												"col": 1,
												"file": 0,
												"row": 5,
												"source": 2
											},
											"type": "ReturnLocalStmt"
										}
									]
								}
							],
							"name": "g0.data.test.a.b.e",
							"params": [
								0,
								1
							],
							"path": [
								"g0",
								"test",
								"a",
								"b",
								"e"
							],
							"return": 2
						},
						{
							"blocks": [
								{
									"stmts": [
										{
											"stmt": {
												"col": 1,
												"file": 0,
												"row": 7,
												"target": 2
											},
											"type": "MakeSetStmt"
										}
									]
								},
								{
									"stmts": [
										{
											"stmt": {
												"col": 1,
												"file": 0,
												"row": 7,
												"target": 3
											},
											"type": "ResetLocalStmt"
										},
										{
											"stmt": {
												"Index": 8,
												"col": 31,
												"file": 0,
												"row": 7,
												"target": 4
											},
											"type": "MakeNumberRefStmt"
										},
										{
											"stmt": {
												"Index": 9,
												"col": 31,
												"file": 0,
												"row": 7,
												"target": 5
											},
											"type": "MakeNumberRefStmt"
										},
										{
											"stmt": {
												"args": [
													{
														"type": "local",
														"value": 4
													},
													{
														"type": "local",
														"value": 5
													}
												],
												"col": 31,
												"file": 0,
												"func": "numbers.range",
												"result": 6,
												"row": 7
											},
											"type": "CallStmt"
										},
										{
											"stmt": {
												"col": 31,
												"file": 0,
												"row": 7,
												"source": {
													"type": "local",
													"value": 6
												},
												"target": 7
											},
											"type": "AssignVarStmt"
										},
										{
											"stmt": {
												"block": {
													"stmts": [
														{
															"stmt": {
																"col": 21,
																"file": 0,
																"row": 7,
																"source": {
																	"type": "local",
																	"value": 8
																},
																"target": 10
															},
															"type": "AssignVarStmt"
														},
														{
															"stmt": {
																"col": 21,
																"file": 0,
																"row": 7,
																"source": {
																	"type": "local",
																	"value": 9
																},
																"target": 11
															},
															"type": "AssignVarStmt"
														},
														{
															"stmt": {
																"col": 1,
																"file": 0,
																"row": 7,
																"set": 2,
																"value": {
																	"type": "local",
																	"value": 11
																}
															},
															"type": "SetAddStmt"
														}
													]
												},
												"col": 21,
												"file": 0,
												"key": 8,
												"row": 7,
												"source": 7,
												"value": 9
											},
											"type": "ScanStmt"
										}
									]
								},
								{
									"stmts": [
										{
											"stmt": {
												"col": 1,
												"file": 0,
												"row": 7,
												"source": 2
											},
											"type": "ReturnLocalStmt"
										}
									]
								}
							],
							"name": "g0.data.test.a.b.g",
							"params": [
								0,
								1
							],
							"path": [
								"g0",
								"test",
								"a",
								"b",
								"g"
							],
							"return": 2
						},
						{
							"blocks": [
								{
									"stmts": [
										{
											"stmt": {
												"col": 1,
												"file": 0,
												"row": 9,
												"target": 2
											},
											"type": "MakeObjectStmt"
										}
									]
								},
								{
									"stmts": [
										{
											"stmt": {
												"col": 1,
												"file": 0,
												"row": 9,
												"target": 3
											},
											"type": "ResetLocalStmt"
										},
										{
											"stmt": {
												"col": 18,
												"file": 0,
												"row": 9,
												"source": {
													"type": "string_index",
													"value": 11
												},
												"target": 4
											},
											"type": "AssignVarStmt"
										},
										{
											"stmt": {
												"Index": 8,
												"col": 1,
												"file": 0,
												"row": 9,
												"target": 5
											},
											"type": "MakeNumberRefStmt"
										},
										{
											"stmt": {
												"col": 1,
												"file": 0,
												"key": {
													"type": "local",
													"value": 4
												},
												"object": 2,
												"row": 9,
												"value": {
													"type": "local",
													"value": 5
												}
											},
											"type": "ObjectInsertOnceStmt"
										}
									]
								},
								{
									"stmts": [
										{
											"stmt": {
												"col": 1,
												"file": 0,
												"row": 9,
												"source": 2
											},
											"type": "ReturnLocalStmt"
										}
									]
								}
							],
							"name": "g0.data.test.a.b.h",
							"params": [
								0,
								1
							],
							"path": [
								"g0",
								"test",
								"a",
								"b",
								"h"
							],
							"return": 2
						}
					]
				},
				"plans": {
					"plans": [
						{
							"blocks": [
								{
									"stmts": [
										{
											"stmt": {
												"col": 0,
												"file": 0,
												"row": 0,
												"target": 2
											},
											"type": "MakeObjectStmt"
										},
										{
											"stmt": {
												"col": 0,
												"file": 0,
												"row": 0,
												"target": 3
											},
											"type": "MakeObjectStmt"
										},
										{
											"stmt": {
												"col": 0,
												"file": 0,
												"row": 0,
												"target": 4
											},
											"type": "MakeObjectStmt"
										},
										{
											"stmt": {
												"blocks": [
													{
														"stmts": [
															{
																"stmt": {
																	"args": [
																		{
																			"type": "local",
																			"value": 0
																		},
																		{
																			"type": "local",
																			"value": 1
																		}
																	],
																	"col": 0,
																	"file": 0,
																	"func": "g0.data.test.a.b.c",
																	"result": 5,
																	"row": 0
																},
																"type": "CallStmt"
															},
															{
																"stmt": {
																	"col": 0,
																	"file": 0,
																	"key": {
																		"type": "string_index",
																		"value": 3
																	},
																	"object": 4,
																	"row": 0,
																	"value": {
																		"type": "local",
																		"value": 5
																	}
																},
																"type": "ObjectInsertStmt"
															}
														]
													}
												],
												"col": 0,
												"file": 0,
												"row": 0
											},
											"type": "BlockStmt"
										},
										{
											"stmt": {
												"blocks": [
													{
														"stmts": [
															{
																"stmt": {
																	"args": [
																		{
																			"type": "local",
																			"value": 0
																		},
																		{
																			"type": "local",
																			"value": 1
																		}
																	],
																	"col": 0,
																	"file": 0,
																	"func": "g0.data.test.a.b.e",
																	"result": 6,
																	"row": 0
																},
																"type": "CallStmt"
															},
															{
																"stmt": {
																	"col": 0,
																	"file": 0,
																	"key": {
																		"type": "string_index",
																		"value": 5
																	},
																	"object": 4,
																	"row": 0,
																	"value": {
																		"type": "local",
																		"value": 6
																	}
																},
																"type": "ObjectInsertStmt"
															}
														]
													}
												],
												"col": 0,
												"file": 0,
												"row": 0
											},
											"type": "BlockStmt"
										},
										{
											"stmt": {
												"blocks": [
													{
														"stmts": [
															{
																"stmt": {
																	"args": [
																		{
																			"type": "local",
																			"value": 0
																		},
																		{
																			"type": "local",
																			"value": 1
																		}
																	],
																	"col": 0,
																	"file": 0,
																	"func": "g0.data.test.a.b.g",
																	"result": 7,
																	"row": 0
																},
																"type": "CallStmt"
															},
															{
																"stmt": {
																	"col": 0,
																	"file": 0,
																	"key": {
																		"type": "string_index",
																		"value": 7
																	},
																	"object": 4,
																	"row": 0,
																	"value": {
																		"type": "local",
																		"value": 7
																	}
																},
																"type": "ObjectInsertStmt"
															}
														]
													}
												],
												"col": 0,
												"file": 0,
												"row": 0
											},
											"type": "BlockStmt"
										},
										{
											"stmt": {
												"blocks": [
													{
														"stmts": [
															{
																"stmt": {
																	"args": [
																		{
																			"type": "local",
																			"value": 0
																		},
																		{
																			"type": "local",
																			"value": 1
																		}
																	],
																	"col": 0,
																	"file": 0,
																	"func": "g0.data.test.a.b.h",
																	"result": 8,
																	"row": 0
																},
																"type": "CallStmt"
															},
															{
																"stmt": {
																	"col": 0,
																	"file": 0,
																	"key": {
																		"type": "string_index",
																		"value": 10
																	},
																	"object": 4,
																	"row": 0,
																	"value": {
																		"type": "local",
																		"value": 8
																	}
																},
																"type": "ObjectInsertStmt"
															}
														]
													}
												],
												"col": 0,
												"file": 0,
												"row": 0
											},
											"type": "BlockStmt"
										},
										{
											"stmt": {
												"col": 0,
												"file": 0,
												"key": {
													"type": "string_index",
													"value": 2
												},
												"object": 3,
												"row": 0,
												"value": {
													"type": "local",
													"value": 4
												}
											},
											"type": "ObjectInsertStmt"
										},
										{
											"stmt": {
												"col": 0,
												"file": 0,
												"key": {
													"type": "string_index",
													"value": 1
												},
												"object": 2,
												"row": 0,
												"value": {
													"type": "local",
													"value": 3
												}
											},
											"type": "ObjectInsertStmt"
										},
										{
											"stmt": {
												"blocks": [
													{
														"stmts": [
															{
																"stmt": {
																	"blocks": [
																		{
																			"stmts": [
																				{
																					"stmt": {
																						"col": 0,
																						"file": 0,
																						"key": {
																							"type": "string_index",
																							"value": 12
																						},
																						"row": 0,
																						"source": {
																							"type": "local",
																							"value": 1
																						},
																						"target": 10
																					},
																					"type": "DotStmt"
																				},
																				{
																					"stmt": {
																						"a": 10,
																						"b": 2,
																						"col": 0,
																						"file": 0,
																						"row": 0,
																						"target": 9
																					},
																					"type": "ObjectMergeStmt"
																				},
																				{
																					"stmt": {
																						"col": 0,
																						"file": 0,
																						"index": 1,
																						"row": 0
																					},
																					"type": "BreakStmt"
																				}
																			]
																		}
																	],
																	"col": 0,
																	"file": 0,
																	"row": 0
																},
																"type": "BlockStmt"
															},
															{
																"stmt": {
																	"col": 0,
																	"file": 0,
																	"row": 0,
																	"source": {
																		"type": "local",
																		"value": 2
																	},
																	"target": 9
																},
																"type": "AssignVarStmt"
															}
														]
													}
												],
												"col": 0,
												"file": 0,
												"row": 0
											},
											"type": "BlockStmt"
										},
										{
											"stmt": {
												"col": 0,
												"file": 0,
												"row": 0,
												"source": {
													"type": "local",
													"value": 9
												},
												"target": 11
											},
											"type": "AssignVarStmt"
										},
										{
											"stmt": {
												"col": 0,
												"file": 0,
												"row": 0,
												"target": 12
											},
											"type": "MakeObjectStmt"
										},
										{
											"stmt": {
												"col": 0,
												"file": 0,
												"key": {
													"type": "string_index",
													"value": 0
												},
												"object": 12,
												"row": 0,
												"value": {
													"type": "local",
													"value": 11
												}
											},
											"type": "ObjectInsertStmt"
										},
										{
											"stmt": {
												"col": 0,
												"file": 0,
												"row": 0,
												"value": 12
											},
											"type": "ResultSetAddStmt"
										}
									]
								}
							],
							"name": "test"
						}
					]
				},
				"static": {
					"builtin_funcs": [
						{
							"decl": {
								"args": [
									{
										"description": "the start of the range",
										"name": "a",
										"type": "number"
									},
									{
										"description": "the end of the range (inclusive)",
										"name": "b",
										"type": "number"
									}
								],
								"result": {
									"description": "the range between `a` and `b`",
									"dynamic": {
										"type": "number"
									},
									"name": "range",
									"type": "array"
								},
								"type": "function"
							},
							"name": "numbers.range"
						}
					],
					"files": [
						{
							"value": "mod_0"
						}
					],
					"strings": [
						{
							"value": "result"
						},
						{
							"value": "a"
						},
						{
							"value": "b"
						},
						{
							"value": "c"
						},
						{
							"value": "d"
						},
						{
							"value": "e"
						},
						{
							"value": "f"
						},
						{
							"value": "g"
						},
						{
							"value": "1"
						},
						{
							"value": "3"
						},
						{
							"value": "h"
						},
						{
							"value": "one"
						},
						{
							"value": "test"
						}
					]
				}
			},
			"want_plan_result": {
				"data_test": {
					"a": {
						"b": {
							"c": "d",
							"e": "f",
							"g": [
								1,
								2,
								3
							],
							"h": {
								"one": 1
							}
						}
					}
				}
			}
		},
		{
			"note": "refheads/website-example/partial-obj",
			"query": "data.example.apps_by_hostname.helium = x",
			"modules": [
				"package example\n\napps_by_hostname[hostname] := app if {\n\tsome i\n\tserver := sites[_].servers[_]\n\thostname := server.hostname\n\tapps[i].servers[_] == server.name\n\tapp := apps[i].name\n}\n\nsites := [\n\t{\n\t\t\"region\": \"east\",\n\t\t\"name\": \"prod\",\n\t\t\"servers\": [\n\t\t\t{\n\t\t\t\t\"name\": \"web-0\",\n\t\t\t\t\"hostname\": \"hydrogen\",\n\t\t\t},\n\t\t\t{\n\t\t\t\t\"name\": \"web-1\",\n\t\t\t\t\"hostname\": \"helium\",\n\t\t\t},\n\t\t\t{\n\t\t\t\t\"name\": \"db-0\",\n\t\t\t\t\"hostname\": \"lithium\",\n\t\t\t},\n\t\t],\n\t},\n\t{\n\t\t\"region\": \"west\",\n\t\t\"name\": \"smoke\",\n\t\t\"servers\": [\n\t\t\t{\n\t\t\t\t\"name\": \"web-1000\",\n\t\t\t\t\"hostname\": \"beryllium\",\n\t\t\t},\n\t\t\t{\n\t\t\t\t\"name\": \"web-1001\",\n\t\t\t\t\"hostname\": \"boron\",\n\t\t\t},\n\t\t\t{\n\t\t\t\t\"name\": \"db-1000\",\n\t\t\t\t\"hostname\": \"carbon\",\n\t\t\t},\n\t\t],\n\t},\n\t{\n\t\t\"region\": \"west\",\n\t\t\"name\": \"dev\",\n\t\t\"servers\": [\n\t\t\t{\n\t\t\t\t\"name\": \"web-dev\",\n\t\t\t\t\"hostname\": \"nitrogen\",\n\t\t\t},\n\t\t\t{\n\t\t\t\t\"name\": \"db-dev\",\n\t\t\t\t\"hostname\": \"oxygen\",\n\t\t\t},\n\t\t],\n\t},\n]\n\napps := [\n\t{\n\t\t\"name\": \"web\",\n\t\t\"servers\": [\"web-0\", \"web-1\", \"web-1000\", \"web-1001\", \"web-dev\"],\n\t},\n\t{\n\t\t\"name\": \"mysql\",\n\t\t\"servers\": [\"db-0\", \"db-1000\"],\n\t},\n\t{\n\t\t\"name\": \"mongodb\",\n\t\t\"servers\": [\"db-dev\"],\n\t},\n]\n\ncontainers := [\n\t{\n\t\t\"image\": \"redis\",\n\t\t\"ipaddress\": \"10.0.0.1\",\n\t\t\"name\": \"big_stallman\",\n\t},\n\t{\n\t\t\"image\": \"nginx\",\n\t\t\"ipaddress\": \"10.0.0.2\",\n\t\t\"name\": \"cranky_euclid\",\n\t},\n]\n"
			],
			"want_result": [
				{
					"x": "web"
				}
			],
			"entrypoints": [
				"example"
			],
			"plan": {
				"funcs": {
					"funcs": [
						{
							"blocks": [
								{
									"stmts": [
										{
											"stmt": {
												"col": 1,
												"file": 0,
												"row": 64,
												"target": 3
											},
											"type": "ResetLocalStmt"
										},
										{
											"stmt": {
												"capacity": 3,
												"col": 1,
												"file": 0,
												"row": 64,
												"target": 4
											},
											"type": "MakeArrayStmt"
										},
										{
											"stmt": {
												"col": 1,
												"file": 0,
												"row": 64,
												"target": 5
											},
											"type": "MakeObjectStmt"
										},
										{
											"stmt": {
												"col": 1,
												"file": 0,
												"key": {
													"type": "string_index",
													"value": 2
												},
												"object": 5,
												"row": 64,
												"value": {
													"type": "string_index",
													"value": 3
												}
											},
											"type": "ObjectInsertStmt"
										},
										{
											"stmt": {
												"capacity": 5,
												"col": 1,
												"file": 0,
												"row": 64,
												"target": 6
											},
											"type": "MakeArrayStmt"
										},
										{
											"stmt": {
												"array": 6,
												"col": 1,
												"file": 0,
												"row": 64,
												"value": {
													"type": "string_index",
													"value": 5
												}
											},
											"type": "ArrayAppendStmt"
										},
										{
											"stmt": {
												"array": 6,
												"col": 1,
												"file": 0,
												"row": 64,
												"value": {
													"type": "string_index",
													"value": 6
												}
											},
											"type": "ArrayAppendStmt"
										},
										{
											"stmt": {
												"array": 6,
												"col": 1,
												"file": 0,
												"row": 64,
												"value": {
													"type": "string_index",
													"value": 7
												}
											},
											"type": "ArrayAppendStmt"
										},
										{
											"stmt": {
												"array": 6,
												"col": 1,
												"file": 0,
												"row": 64,
												"value": {
													"type": "string_index",
													"value": 8
												}
											},
											"type": "ArrayAppendStmt"
										},
										{
											"stmt": {
												"array": 6,
												"col": 1,
												"file": 0,
												"row": 64,
												"value": {
													"type": "string_index",
													"value": 9
												}
											},
											"type": "ArrayAppendStmt"
										},
										{
											"stmt": {
												"col": 1,
												"file": 0,
												"key": {
													"type": "string_index",
													"value": 4
												},
												"object": 5,
												"row": 64,
												"value": {
													"type": "local",
													"value": 6
												}
											},
											"type": "ObjectInsertStmt"
										},
										{
											"stmt": {
												"array": 4,
												"col": 1,
												"file": 0,
												"row": 64,
												"value": {
													"type": "local",
													"value": 5
												}
											},
											"type": "ArrayAppendStmt"
										},
										{
											"stmt": {
												"col": 1,
												"file": 0,
												"row": 64,
												"target": 7
											},
											"type": "MakeObjectStmt"
										},
										{
											"stmt": {
												"col": 1,
												"file": 0,
												"key": {
													"type": "string_index",
													"value": 2
												},
												"object": 7,
												"row": 64,
												"value": {
													"type": "string_index",
													"value": 10
												}
											},
											"type": "ObjectInsertStmt"
										},
										{
											"stmt": {
												"capacity": 2,
												"col": 1,
												"file": 0,
												"row": 64,
												"target": 8
											},
											"type": "MakeArrayStmt"
										},
										{
											"stmt": {
												"array": 8,
												"col": 1,
												"file": 0,
												"row": 64,
												"value": {
													"type": "string_index",
													"value": 11
												}
											},
											"type": "ArrayAppendStmt"
										},
										{
											"stmt": {
												"array": 8,
												"col": 1,
												"file": 0,
												"row": 64,
												"value": {
													"type": "string_index",
													"value": 12
												}
											},
											"type": "ArrayAppendStmt"
										},
										{
											"stmt": {
												"col": 1,
												"file": 0,
												"key": {
													"type": "string_index",
													"value": 4
												},
												"object": 7,
												"row": 64,
												"value": {
													"type": "local",
													"value": 8
												}
											},
											"type": "ObjectInsertStmt"
										},
										{
											"stmt": {
												"array": 4,
												"col": 1,
												"file": 0,
												"row": 64,
												"value": {
													"type": "local",
													"value": 7
												}
											},
											"type": "ArrayAppendStmt"
										},
										{
											"stmt": {
												"col": 1,
												"file": 0,
												"row": 64,
												"target": 9
											},
											"type": "MakeObjectStmt"
										},
										{
											"stmt": {
												"col": 1,
												"file": 0,
												"key": {
													"type": "string_index",
													"value": 2
												},
												"object": 9,
												"row": 64,
												"value": {
													"type": "string_index",
													"value": 13
												}
											},
											"type": "ObjectInsertStmt"
										},
										{
											"stmt": {
												"capacity": 1,
												"col": 1,
												"file": 0,
												"row": 64,
												"target": 10
											},
											"type": "MakeArrayStmt"
										},
										{
											"stmt": {
												"array": 10,
												"col": 1,
												"file": 0,
												"row": 64,
												"value": {
													"type": "string_index",
													"value": 14
												}
											},
											"type": "ArrayAppendStmt"
										},
										{
											"stmt": {
												"col": 1,
												"file": 0,
												"key": {
													"type": "string_index",
													"value": 4
												},
												"object": 9,
												"row": 64,
												"value": {
													"type": "local",
													"value": 10
												}
											},
											"type": "ObjectInsertStmt"
										},
										{
											"stmt": {
												"array": 4,
												"col": 1,
												"file": 0,
												"row": 64,
												"value": {
													"type": "local",
													"value": 9
												}
											},
											"type": "ArrayAppendStmt"
										},
										{
											"stmt": {
												"col": 1,
												"file": 0,
												"row": 64,
												"source": {
													"type": "local",
													"value": 4
												},
												"target": 3
											},
											"type": "AssignVarOnceStmt"
										}
									]
								},
								{
									"stmts": [
										{
											"stmt": {
												"col": 1,
												"file": 0,
												"row": 64,
												"source": 3
											},
											"type": "IsDefinedStmt"
										},
										{
											"stmt": {
												"col": 1,
												"file": 0,
												"row": 64,
												"source": {
													"type": "local",
													"value": 3
												},
												"target": 2
											},
											"type": "AssignVarOnceStmt"
										}
									]
								},
								{
									"stmts": [
										{
											"stmt": {
												"col": 1,
												"file": 0,
												"row": 64,
												"source": 2
											},
											"type": "ReturnLocalStmt"
										}
									]
								}
							],
							"name": "g0.data.example.apps",
							"params": [
								0,
								1
							],
							"path": [
								"g0",
								"example",
								"apps"
							],
							"return": 2
						},
						{
							"blocks": [
								{
									"stmts": [
										{
											"stmt": {
												"col": 1,
												"file": 0,
												"row": 11,
												"target": 3
											},
											"type": "ResetLocalStmt"
										},
										{
											"stmt": {
												"capacity": 3,
												"col": 1,
												"file": 0,
												"row": 11,
												"target": 4
											},
											"type": "MakeArrayStmt"
										},
										{
											"stmt": {
												"col": 1,
												"file": 0,
												"row": 11,
												"target": 5
											},
											"type": "MakeObjectStmt"
										},
										{
											"stmt": {
												"col": 1,
												"file": 0,
												"key": {
													"type": "string_index",
													"value": 2
												},
												"object": 5,
												"row": 11,
												"value": {
													"type": "string_index",
													"value": 16
												}
											},
											"type": "ObjectInsertStmt"
										},
										{
											"stmt": {
												"col": 1,
												"file": 0,
												"key": {
													"type": "string_index",
													"value": 17
												},
												"object": 5,
												"row": 11,
												"value": {
													"type": "string_index",
													"value": 18
												}
											},
											"type": "ObjectInsertStmt"
										},
										{
											"stmt": {
												"capacity": 3,
												"col": 1,
												"file": 0,
												"row": 11,
												"target": 6
											},
											"type": "MakeArrayStmt"
										},
										{
											"stmt": {
												"col": 1,
												"file": 0,
												"row": 11,
												"target": 7
											},
											"type": "MakeObjectStmt"
										},
										{
											"stmt": {
												"col": 1,
												"file": 0,
												"key": {
													"type": "string_index",
													"value": 19
												},
												"object": 7,
												"row": 11,
												"value": {
													"type": "string_index",
													"value": 20
												}
											},
											"type": "ObjectInsertStmt"
										},
										{
											"stmt": {
												"col": 1,
												"file": 0,
												"key": {
													"type": "string_index",
													"value": 2
												},
												"object": 7,
												"row": 11,
												"value": {
													"type": "string_index",
													"value": 5
												}
											},
											"type": "ObjectInsertStmt"
										},
										{
											"stmt": {
												"array": 6,
												"col": 1,
												"file": 0,
												"row": 11,
												"value": {
													"type": "local",
													"value": 7
												}
											},
											"type": "ArrayAppendStmt"
										},
										{
											"stmt": {
												"col": 1,
												"file": 0,
												"row": 11,
												"target": 8
											},
											"type": "MakeObjectStmt"
										},
										{
											"stmt": {
												"col": 1,
												"file": 0,
												"key": {
													"type": "string_index",
													"value": 19
												},
												"object": 8,
												"row": 11,
												"value": {
													"type": "string_index",
													"value": 21
												}
											},
											"type": "ObjectInsertStmt"
										},
										{
											"stmt": {
												"col": 1,
												"file": 0,
												"key": {
													"type": "string_index",
													"value": 2
												},
												"object": 8,
												"row": 11,
												"value": {
													"type": "string_index",
													"value": 6
												}
											},
											"type": "ObjectInsertStmt"
										},
										{
											"stmt": {
												"array": 6,
												"col": 1,
												"file": 0,
												"row": 11,
												"value": {
													"type": "local",
													"value": 8
												}
											},
											"type": "ArrayAppendStmt"
										},
										{
											"stmt": {
												"col": 1,
												"file": 0,
												"row": 11,
												"target": 9
											},
											"type": "MakeObjectStmt"
										},
										{
											"stmt": {
												"col": 1,
												"file": 0,
												"key": {
													"type": "string_index",
													"value": 19
												},
												"object": 9,
												"row": 11,
												"value": {
													"type": "string_index",
													"value": 22
												}
											},
											"type": "ObjectInsertStmt"
										},
										{
											"stmt": {
												"col": 1,
												"file": 0,
												"key": {
													"type": "string_index",
													"value": 2
												},
												"object": 9,
												"row": 11,
												"value": {
													"type": "string_index",
													"value": 11
												}
											},
											"type": "ObjectInsertStmt"
										},
										{
											"stmt": {
												"array": 6,
												"col": 1,
												"file": 0,
												"row": 11,
												"value": {
													"type": "local",
													"value": 9
												}
											},
											"type": "ArrayAppendStmt"
										},
										{
											"stmt": {
												"col": 1,
												"file": 0,
												"key": {
													"type": "string_index",
													"value": 4
												},
												"object": 5,
												"row": 11,
												"value": {
													"type": "local",
													"value": 6
												}
											},
											"type": "ObjectInsertStmt"
										},
										{
											"stmt": {
												"array": 4,
												"col": 1,
												"file": 0,
												"row": 11,
												"value": {
													"type": "local",
													"value": 5
												}
											},
											"type": "ArrayAppendStmt"
										},
										{
											"stmt": {
												"col": 1,
												"file": 0,
												"row": 11,
												"target": 10
											},
											"type": "MakeObjectStmt"
										},
										{
											"stmt": {
												"col": 1,
												"file": 0,
												"key": {
													"type": "string_index",
													"value": 2
												},
												"object": 10,
												"row": 11,
												"value": {
													"type": "string_index",
													"value": 23
												}
											},
											"type": "ObjectInsertStmt"
										},
										{
											"stmt": {
												"col": 1,
												"file": 0,
												"key": {
													"type": "string_index",
													"value": 17
												},
												"object": 10,
												"row": 11,
												"value": {
													"type": "string_index",
													"value": 24
												}
											},
											"type": "ObjectInsertStmt"
										},
										{
											"stmt": {
												"capacity": 3,
												"col": 1,
												"file": 0,
												"row": 11,
												"target": 11
											},
											"type": "MakeArrayStmt"
										},
										{
											"stmt": {
												"col": 1,
												"file": 0,
												"row": 11,
												"target": 12
											},
											"type": "MakeObjectStmt"
										},
										{
											"stmt": {
												"col": 1,
												"file": 0,
												"key": {
													"type": "string_index",
													"value": 19
												},
												"object": 12,
												"row": 11,
												"value": {
													"type": "string_index",
													"value": 25
												}
											},
											"type": "ObjectInsertStmt"
										},
										{
											"stmt": {
												"col": 1,
												"file": 0,
												"key": {
													"type": "string_index",
													"value": 2
												},
												"object": 12,
												"row": 11,
												"value": {
													"type": "string_index",
													"value": 7
												}
											},
											"type": "ObjectInsertStmt"
										},
										{
											"stmt": {
												"array": 11,
												"col": 1,
												"file": 0,
												"row": 11,
												"value": {
													"type": "local",
													"value": 12
												}
											},
											"type": "ArrayAppendStmt"
										},
										{
											"stmt": {
												"col": 1,
												"file": 0,
												"row": 11,
												"target": 13
											},
											"type": "MakeObjectStmt"
										},
										{
											"stmt": {
												"col": 1,
												"file": 0,
												"key": {
													"type": "string_index",
													"value": 19
												},
												"object": 13,
												"row": 11,
												"value": {
													"type": "string_index",
													"value": 26
												}
											},
											"type": "ObjectInsertStmt"
										},
										{
											"stmt": {
												"col": 1,
												"file": 0,
												"key": {
													"type": "string_index",
													"value": 2
												},
												"object": 13,
												"row": 11,
												"value": {
													"type": "string_index",
													"value": 8
												}
											},
											"type": "ObjectInsertStmt"
										},
										{
											"stmt": {
												"array": 11,
												"col": 1,
												"file": 0,
												"row": 11,
												"value": {
													"type": "local",
													"value": 13
												}
											},
											"type": "ArrayAppendStmt"
										},
										{
											"stmt": {
												"col": 1,
												"file": 0,
												"row": 11,
												"target": 14
											},
											"type": "MakeObjectStmt"
										},
										{
											"stmt": {
												"col": 1,
												"file": 0,
												"key": {
													"type": "string_index",
													"value": 19
												},
												"object": 14,
												"row": 11,
												"value": {
													"type": "string_index",
													"value": 27
												}
											},
											"type": "ObjectInsertStmt"
										},
										{
											"stmt": {
												"col": 1,
												"file": 0,
												"key": {
													"type": "string_index",
													"value": 2
												},
												"object": 14,
												"row": 11,
												"value": {
													"type": "string_index",
													"value": 12
												}
											},
											"type": "ObjectInsertStmt"
										},
										{
											"stmt": {
												"array": 11,
												"col": 1,
												"file": 0,
												"row": 11,
												"value": {
													"type": "local",
													"value": 14
												}
											},
											"type": "ArrayAppendStmt"
										},
										{
											"stmt": {
												"col": 1,
												"file": 0,
												"key": {
													"type": "string_index",
													"value": 4
												},
												"object": 10,
												"row": 11,
												"value": {
													"type": "local",
													"value": 11
												}
											},
											"type": "ObjectInsertStmt"
										},
										{
											"stmt": {
												"array": 4,
												"col": 1,
												"file": 0,
												"row": 11,
												"value": {
													"type": "local",
													"value": 10
												}
											},
											"type": "ArrayAppendStmt"
										},
										{
											"stmt": {
												"col": 1,
												"file": 0,
												"row": 11,
												"target": 15
											},
											"type": "MakeObjectStmt"
										},
										{
											"stmt": {
												"col": 1,
												"file": 0,
												"key": {
													"type": "string_index",
													"value": 2
												},
												"object": 15,
												"row": 11,
												"value": {
													"type": "string_index",
													"value": 28
												}
											},
											"type": "ObjectInsertStmt"
										},
										{
											"stmt": {
												"col": 1,
												"file": 0,
												"key": {
													"type": "string_index",
													"value": 17
												},
												"object": 15,
												"row": 11,
												"value": {
													"type": "string_index",
													"value": 24
												}
											},
											"type": "ObjectInsertStmt"
										},
										{
											"stmt": {
												"capacity": 2,
												"col": 1,
												"file": 0,
												"row": 11,
												"target": 16
											},
											"type": "MakeArrayStmt"
										},
										{
											"stmt": {
												"col": 1,
												"file": 0,
												"row": 11,
												"target": 17
											},
											"type": "MakeObjectStmt"
										},
										{
											"stmt": {
												"col": 1,
												"file": 0,
												"key": {
													"type": "string_index",
													"value": 19
												},
												"object": 17,
												"row": 11,
												"value": {
													"type": "string_index",
													"value": 29
												}
											},
											"type": "ObjectInsertStmt"
										},
										{
											"stmt": {
												"col": 1,
												"file": 0,
												"key": {
													"type": "string_index",
													"value": 2
												},
												"object": 17,
												"row": 11,
												"value": {
													"type": "string_index",
													"value": 9
												}
											},
											"type": "ObjectInsertStmt"
										},
										{
											"stmt": {
												"array": 16,
												"col": 1,
												"file": 0,
												"row": 11,
												"value": {
													"type": "local",
													"value": 17
												}
											},
											"type": "ArrayAppendStmt"
										},
										{
											"stmt": {
												"col": 1,
												"file": 0,
												"row": 11,
												"target": 18
											},
											"type": "MakeObjectStmt"
										},
										{
											"stmt": {
												"col": 1,
												"file": 0,
												"key": {
													"type": "string_index",
													"value": 19
												},
												"object": 18,
												"row": 11,
												"value": {
													"type": "string_index",
													"value": 30
												}
											},
											"type": "ObjectInsertStmt"
										},
										{
											"stmt": {
												"col": 1,
												"file": 0,
												"key": {
													"type": "string_index",
													"value": 2
												},
												"object": 18,
												"row": 11,
												"value": {
													"type": "string_index",
													"value": 14
												}
											},
											"type": "ObjectInsertStmt"
										},
										{
											"stmt": {
												"array": 16,
												"col": 1,
												"file": 0,
												"row": 11,
												"value": {
													"type": "local",
													"value": 18
												}
											},
											"type": "ArrayAppendStmt"
										},
										{
											"stmt": {
												"col": 1,
												"file": 0,
												"key": {
													"type": "string_index",
													"value": 4
												},
												"object": 15,
												"row": 11,
												"value": {
													"type": "local",
													"value": 16
												}
											},
											"type": "ObjectInsertStmt"
										},
										{
											"stmt": {
												"array": 4,
												"col": 1,
												"file": 0,
												"row": 11,
												"value": {
													"type": "local",
													"value": 15
												}
											},
											"type": "ArrayAppendStmt"
										},
										{
											"stmt": {
												"col": 1,
												"file": 0,
												"row": 11,
												"source": {
													"type": "local",
													"value": 4
												},
												"target": 3
											},
											"type": "AssignVarOnceStmt"
										}
									]
								},
								{
									"stmts": [
										{
											"stmt": {
												"col": 1,
												"file": 0,
												"row": 11,
												"source": 3
											},
											"type": "IsDefinedStmt"
										},
										{
											"stmt": {
												"col": 1,
												"file": 0,
												"row": 11,
												"source": {
													"type": "local",
													"value": 3
												},
												"target": 2
											},
											"type": "AssignVarOnceStmt"
										}
									]
								},
								{
									"stmts": [
										{
											"stmt": {
												"col": 1,
												"file": 0,
												"row": 11,
												"source": 2
											},
											"type": "ReturnLocalStmt"
										}
									]
								}
							],
							"name": "g0.data.example.sites",
							"params": [
								0,
								1
							],
							"path": [
								"g0",
								"example",
								"sites"
							],
							"return": 2
						},
						{
							"blocks": [
								{
									"stmts": [
										{
											"stmt": {
												"col": 1,
												"file": 0,
												"row": 3,
												"target": 2
											},
											"type": "MakeObjectStmt"
										}
									]
								},
								{
									"stmts": [
										{
											"stmt": {
												"col": 1,
												"file": 0,
												"row": 3,
												"target": 3
											},
											"type": "ResetLocalStmt"
										},
										{
											"stmt": {
												"args": [
													{
														"type": "local",
														"value": 0
													},
													{
														"type": "local",
														"value": 1
													}
												],
												"col": 2,
												"file": 0,
												"func": "g0.data.example.sites",
												"result": 4,
												"row": 5
											},
											"type": "CallStmt"
										},
										{
											"stmt": {
												"block": {
													"stmts": [
														{
															"stmt": {
																"col": 2,
																"file": 0,
																"row": 5,
																"source": {
																	"type": "local",
																	"value": 5
																},
																"target": 7
															},
															"type": "AssignVarStmt"
														},
														{
															"stmt": {
																"col": 2,
																"file": 0,
																"key": {
																	"type": "string_index",
																	"value": 4
																},
																"row": 5,
																"source": {
																	"type": "local",
																	"value": 6
																},
																"target": 8
															},
															"type": "DotStmt"
														},
														{
															"stmt": {
																"block": {
																	"stmts": [
																		{
																			"stmt": {
																				"col": 2,
																				"file": 0,
																				"row": 5,
																				"source": {
																					"type": "local",
																					"value": 9
																				},
																				"target": 11
																			},
																			"type": "AssignVarStmt"
																		},
																		{
																			"stmt": {
																				"col": 2,
																				"file": 0,
																				"row": 5,
																				"source": {
																					"type": "local",
																					"value": 10
																				},
																				"target": 12
																			},
																			"type": "AssignVarStmt"
																		},
																		{
																			"stmt": {
																				"col": 2,
																				"file": 0,
																				"key": {
																					"type": "string_index",
																					"value": 19
																				},
																				"row": 6,
																				"source": {
																					"type": "local",
																					"value": 12
																				},
																				"target": 13
																			},
																			"type": "DotStmt"
																		},
																		{
																			"stmt": {
																				"col": 2,
																				"file": 0,
																				"row": 6,
																				"source": {
																					"type": "local",
																					"value": 13
																				},
																				"target": 14
																			},
																			"type": "AssignVarStmt"
																		},
																		{
																			"stmt": {
																				"args": [
																					{
																						"type": "local",
																						"value": 0
																					},
																					{
																						"type": "local",
																						"value": 1
																					}
																				],
																				"col": 2,
																				"file": 0,
																				"func": "g0.data.example.apps",
																				"result": 15,
																				"row": 7
																			},
																			"type": "CallStmt"
																		},
																		{
																			"stmt": {
																				"block": {
																					"stmts": [
																						{
																							"stmt": {
																								"col": 2,
																								"file": 0,
																								"row": 7,
																								"source": {
																									"type": "local",
																									"value": 16
																								},
																								"target": 18
																							},
																							"type": "AssignVarStmt"
																						},
																						{
																							"stmt": {
																								"col": 2,
																								"file": 0,
																								"key": {
																									"type": "string_index",
																									"value": 4
																								},
																								"row": 7,
																								"source": {
																									"type": "local",
																									"value": 17
																								},
																								"target": 19
																							},
																							"type": "DotStmt"
																						},
																						{
																							"stmt": {
																								"block": {
																									"stmts": [
																										{
																											"stmt": {
																												"col": 2,
																												"file": 0,
																												"row": 7,
																												"source": {
																													"type": "local",
																													"value": 20
																												},
																												"target": 22
																											},
																											"type": "AssignVarStmt"
																										},
																										{
																											"stmt": {
																												"col": 2,
																												"file": 0,
																												"key": {
																													"type": "string_index",
																													"value": 2
																												},
																												"row": 7,
																												"source": {
																													"type": "local",
																													"value": 12
																												},
																												"target": 23
																											},
																											"type": "DotStmt"
																										},
																										{
																											"stmt": {
																												"a": {
																													"type": "local",
																													"value": 21
																												},
																												"b": {
																													"type": "local",
																													"value": 23
																												},
																												"col": 2,
																												"file": 0,
																												"row": 7
																											},
																											"type": "EqualStmt"
																										},
																										{
																											"stmt": {
																												"args": [
																													{
																														"type": "local",
																														"value": 0
																													},
																													{
																														"type": "local",
																														"value": 1
																													}
																												],
																												"col": 2,
																												"file": 0,
																												"func": "g0.data.example.apps",
																												"result": 24,
																												"row": 8
																											},
																											"type": "CallStmt"
																										},
																										{
																											"stmt": {
																												"col": 2,
																												"file": 0,
																												"key": {
																													"type": "local",
																													"value": 18
																												},
																												"row": 8,
																												"source": {
																													"type": "local",
																													"value": 24
																												},
																												"target": 25
																											},
																											"type": "DotStmt"
																										},
																										{
																											"stmt": {
																												"col": 2,
																												"file": 0,
																												"key": {
																													"type": "string_index",
																													"value": 2
																												},
																												"row": 8,
																												"source": {
																													"type": "local",
																													"value": 25
																												},
																												"target": 26
																											},
																											"type": "DotStmt"
																										},
																										{
																											"stmt": {
																												"col": 2,
																												"file": 0,
																												"row": 8,
																												"source": {
																													"type": "local",
																													"value": 26
																												},
																												"target": 27
																											},
																											"type": "AssignVarStmt"
																										},
																										{
																											"stmt": {
																												"col": 1,
																												"file": 0,
																												"key": {
																													"type": "local",
																													"value": 14
																												},
																												"object": 2,
																												"row": 3,
																												"value": {
																													"type": "local",
																													"value": 27
																												}
																											},
																											"type": "ObjectInsertOnceStmt"
																										}
																									]
																								},
																								"col": 2,
																								"file": 0,
																								"key": 20,
																								"row": 7,
																								"source": 19,
																								"value": 21
																							},
																							"type": "ScanStmt"
																						}
																					]
																				},
																				"col": 2,
																				"file": 0,
																				"key": 16,
																				"row": 7,
																				"source": 15,
																				"value": 17
																			},
																			"type": "ScanStmt"
																		}
																	]
																},
																"col": 2,
																"file": 0,
																"key": 9,
																"row": 5,
																"source": 8,
																"value": 10
															},
															"type": "ScanStmt"
														}
													]
												},
												"col": 2,
												"file": 0,
												"key": 5,
												"row": 5,
												"source": 4,
												"value": 6
											},
											"type": "ScanStmt"
										}
									]
								},
								{
									"stmts": [
										{
											"stmt": {
												"col": 1,
												"file": 0,
												"row": 3,
												"source": 2
											},
											"type": "ReturnLocalStmt"
										}
									]
								}
							],
							"name": "g0.data.example.apps_by_hostname",
							"params": [
								0,
								1
							],
							"path": [
								"g0",
								"example",
								"apps_by_hostname"
							],
							"return": 2
						},
						{
							"blocks": [
								{
									"stmts": [
										{
											"stmt": {
												"col": 1,
												"file": 0,
												"row": 79,
												"target": 3
											},
											"type": "ResetLocalStmt"
										},
										{
											"stmt": {
												"capacity": 2,
												"col": 1,
												"file": 0,
												"row": 79,
												"target": 4
											},
											"type": "MakeArrayStmt"
										},
										{
											"stmt": {
												"col": 1,
												"file": 0,
												"row": 79,
												"target": 5
											},
											"type": "MakeObjectStmt"
										},
										{
											"stmt": {
												"col": 1,
												"file": 0,
												"key": {
													"type": "string_index",
													"value": 32
												},
												"object": 5,
												"row": 79,
												"value": {
													"type": "string_index",
													"value": 33
												}
											},
											"type": "ObjectInsertStmt"
										},
										{
											"stmt": {
												"col": 1,
												"file": 0,
												"key": {
													"type": "string_index",
													"value": 34
												},
												"object": 5,
												"row": 79,
												"value": {
													"type": "string_index",
													"value": 35
												}
											},
											"type": "ObjectInsertStmt"
										},
										{
											"stmt": {
												"col": 1,
												"file": 0,
												"key": {
													"type": "string_index",
													"value": 2
												},
												"object": 5,
												"row": 79,
												"value": {
													"type": "string_index",
													"value": 36
												}
											},
											"type": "ObjectInsertStmt"
										},
										{
											"stmt": {
												"array": 4,
												"col": 1,
												"file": 0,
												"row": 79,
												"value": {
													"type": "local",
													"value": 5
												}
											},
											"type": "ArrayAppendStmt"
										},
										{
											"stmt": {
												"col": 1,
												"file": 0,
												"row": 79,
												"target": 6
											},
											"type": "MakeObjectStmt"
										},
										{
											"stmt": {
												"col": 1,
												"file": 0,
												"key": {
													"type": "string_index",
													"value": 32
												},
												"object": 6,
												"row": 79,
												"value": {
													"type": "string_index",
													"value": 37
												}
											},
											"type": "ObjectInsertStmt"
										},
										{
											"stmt": {
												"col": 1,
												"file": 0,
												"key": {
													"type": "string_index",
													"value": 34
												},
												"object": 6,
												"row": 79,
												"value": {
													"type": "string_index",
													"value": 38
												}
											},
											"type": "ObjectInsertStmt"
										},
										{
											"stmt": {
												"col": 1,
												"file": 0,
												"key": {
													"type": "string_index",
													"value": 2
												},
												"object": 6,
												"row": 79,
												"value": {
													"type": "string_index",
													"value": 39
												}
											},
											"type": "ObjectInsertStmt"
										},
										{
											"stmt": {
												"array": 4,
												"col": 1,
												"file": 0,
												"row": 79,
												"value": {
													"type": "local",
													"value": 6
												}
											},
											"type": "ArrayAppendStmt"
										},
										{
											"stmt": {
												"col": 1,
												"file": 0,
												"row": 79,
												"source": {
													"type": "local",
													"value": 4
												},
												"target": 3
											},
											"type": "AssignVarOnceStmt"
										}
									]
								},
								{
									"stmts": [
										{
											"stmt": {
												"col": 1,
												"file": 0,
												"row": 79,
												"source": 3
											},
											"type": "IsDefinedStmt"
										},
										{
											"stmt": {
												"col": 1,
												"file": 0,
												"row": 79,
												"source": {
													"type": "local",
													"value": 3
												},
												"target": 2
											},
											"type": "AssignVarOnceStmt"
										}
									]
								},
								{
									"stmts": [
										{
											"stmt": {
												"col": 1,
												"file": 0,
												"row": 79,
												"source": 2
											},
											"type": "ReturnLocalStmt"
										}
									]
								}
							],
							"name": "g0.data.example.containers",
							"params": [
								0,
								1
							],
							"path": [
								"g0",
								"example",
								"containers"
							],
							"return": 2
						}
					]
				},
				"plans": {
					"plans": [
						{
							"blocks": [
								{
									"stmts": [
										{
											"stmt": {
												"col": 0,
												"file": 0,
												"row": 0,
												"target": 2
											},
											"type": "MakeObjectStmt"
										},
										{
											"stmt": {
												"blocks": [
													{
														"stmts": [
															{
																"stmt": {
																	"args": [
																		{
																			"type": "local",
																			"value": 0
																		},
																		{
																			"type": "local",
																			"value": 1
																		}
																	],
																	"col": 0,
																	"file": 0,
																	"func": "g0.data.example.apps",
																	"result": 3,
																	"row": 0
																},
																"type": "CallStmt"
															},
															{
																"stmt": {
																	"col": 0,
																	"file": 0,
																	"key": {
																		"type": "string_index",
																		"value": 1
																	},
																	"object": 2,
																	"row": 0,
																	"value": {
																		"type": "local",
																		"value": 3
																	}
																},
																"type": "ObjectInsertStmt"
															}
														]
													}
												],
												"col": 0,
												"file": 0,
												"row": 0
											},
											"type": "BlockStmt"
										},
										{
											"stmt": {
												"blocks": [
													{
														"stmts": [
															{
																"stmt": {
																	"args": [
																		{
																			"type": "local",
																			"value": 0
																		},
																		{
																			"type": "local",
																			"value": 1
																		}
																	],
																	"col": 0,
																	"file": 0,
																	"func": "g0.data.example.apps_by_hostname",
																	"result": 4,
																	"row": 0
																},
																"type": "CallStmt"
															},
															{
																"stmt": {
																	"col": 0,
																	"file": 0,
																	"key": {
																		"type": "string_index",
																		"value": 15
																	},
																	"object": 2,
																	"row": 0,
																	"value": {
																		"type": "local",
																		"value": 4
																	}
																},
																"type": "ObjectInsertStmt"
															}
														]
													}
												],
												"col": 0,
												"file": 0,
												"row": 0
											},
											"type": "BlockStmt"
										},
										{
											"stmt": {
												"blocks": [
													{
														"stmts": [
															{
																"stmt": {
																	"args": [
																		{
																			"type": "local",
																			"value": 0
																		},
																		{
																			"type": "local",
																			"value": 1
																		}
																	],
																	"col": 0,
																	"file": 0,
																	"func": "g0.data.example.containers",
																	"result": 5,
																	"row": 0
																},
																"type": "CallStmt"
															},
															{
																"stmt": {
																	"col": 0,
																	"file": 0,
																	"key": {
																		"type": "string_index",
																		"value": 31
																	},
																	"object": 2,
																	"row": 0,
																	"value": {
																		"type": "local",
																		"value": 5
																	}
																},
																"type": "ObjectInsertStmt"
															}
														]
													}
												],
												"col": 0,
												"file": 0,
												"row": 0
											},
											"type": "BlockStmt"
										},
										{
											"stmt": {
												"blocks": [
													{
														"stmts": [
															{
																"stmt": {
																	"args": [
																		{
																			"type": "local",
																			"value": 0
																		},
																		{
																			"type": "local",
																			"value": 1
																		}
																	],
																	"col": 0,
																	"file": 0,
																	"func": "g0.data.example.sites",
																	"result": 6,
																	"row": 0
																},
																"type": "CallStmt"
															},
															{
																"stmt": {
																	"col": 0,
																	"file": 0,
																	"key": {
																		"type": "string_index",
																		"value": 40
																	},
																	"object": 2,
																	"row": 0,
																	"value": {
																		"type": "local",
																		"value": 6
																	}
																},
																"type": "ObjectInsertStmt"
															}
														]
													}
												],
												"col": 0,
												"file": 0,
												"row": 0
											},
											"type": "BlockStmt"
										},
										{
											"stmt": {
												"blocks": [
													{
														"stmts": [
															{
																"stmt": {
																	"blocks": [
																		{
																			"stmts": [
																				{
																					"stmt": {
																						"col": 0,
																						"file": 0,
																						"key": {
																							"type": "string_index",
																							"value": 41
																						},
																						"row": 0,
																						"source": {
																							"type": "local",
																							"value": 1
																						},
																						"target": 8
																					},
																					"type": "DotStmt"
																				},
																				{
																					"stmt": {
																						"a": 8,
																						"b": 2,
																						"col": 0,
																						"file": 0,
																						"row": 0,
																						"target": 7
																					},
																					"type": "ObjectMergeStmt"
																				},
																				{
																					"stmt": {
																						"col": 0,
																						"file": 0,
																						"index": 1,
																						"row": 0
																					},
																					"type": "BreakStmt"
																				}
																			]
																		}
																	],
																	"col": 0,
																	"file": 0,
																	"row": 0
																},
																"type": "BlockStmt"
															},
															{
																"stmt": {
																	"col": 0,
																	"file": 0,
																	"row": 0,
																	"source": {
																		"type": "local",
																		"value": 2
																	},
																	"target": 7
																},
																"type": "AssignVarStmt"
															}
														]
													}
												],
												"col": 0,
												"file": 0,
												"row": 0
											},
											"type": "BlockStmt"
										},
										{
											"stmt": {
												"col": 0,
												"file": 0,
												"row": 0,
												"source": {
													"type": "local",
													"value": 7
												},
												"target": 9
											},
											"type": "AssignVarStmt"
										},
										{
											"stmt": {
												"col": 0,
												"file": 0,
												"row": 0,
												"target": 10
											},
											"type": "MakeObjectStmt"
										},
										{
											"stmt": {
												"col": 0,
												"file": 0,
												"key": {
													"type": "string_index",
													"value": 0
												},
												"object": 10,
												"row": 0,
												"value": {
													"type": "local",
													"value": 9
												}
											},
											"type": "ObjectInsertStmt"
										},
										{
											"stmt": {
												"col": 0,
												"file": 0,
												"row": 0,
												"value": 10
											},
											"type": "ResultSetAddStmt"
										}
									]
								}
							],
							"name": "example"
						}
					]
				},
				"static": {
					"files": [
						{
							"value": "mod_0"
						}
					],
					"strings": [
						{
							"value": "result"
						},
						{
							"value": "apps"
						},
						{
							"value": "name"
						},
						{
							"value": "web"
						},
						{
							"value": "servers"
						},
						{
							"value": "web-0"
						},
						{
							"value": "web-1"
						},
						{
							"value": "web-1000"
						},
						{
							"value": "web-1001"
						},
						{
							"value": "web-dev"
						},
						{
							"value": "mysql"
						},
						{
							"value": "db-0"
						},
						{
							"value": "db-1000"
						},
						{
							"value": "mongodb"
						},
						{
							"value": "db-dev"
						},
						{
							"value": "apps_by_hostname"
						},
						{
							"value": "prod"
						},
						{
							"value": "region"
						},
						{
							"value": "east"
						},
						{
							"value": "hostname"
						},
						{
							"value": "hydrogen"
						},
						{
							"value": "helium"
						},
						{
							"value": "lithium"
						},
						{
							"value": "smoke"
						},
						{
							"value": "west"
						},
						{
							"value": "beryllium"
						},
						{
							"value": "boron"
						},
						{
							"value": "carbon"
						},
						{
							"value": "dev"
						},
						{
							"value": "nitrogen"
						},
						{
							"value": "oxygen"
						},
						{
							"value": "containers"
						},
						{
							"value": "image"
						},
						{
							"value": "redis"
						},
						{
							"value": "ipaddress"
						},
						{
							"value": "10.0.0.1"
						},
						{
							"value": "big_stallman"
						},
						{
							"value": "nginx"
						},
						{
							"value": "10.0.0.2"
						},
						{
							"value": "cranky_euclid"
						},
						{
							"value": "sites"
						},
						{
							"value": "example"
						}
					]
				}
			},
			"want_plan_result": {
				"data_example": {
					"apps": [
						{
							"name": "web",
							"servers": [
								"web-0",
								"web-1",
								"web-1000",
								"web-1001",
								"web-dev"
							]
						},
						{
							"name": "mysql",
							"servers": [
								"db-0",
								"db-1000"
							]
						},
						{
							"name": "mongodb",
							"servers": [
								"db-dev"
							]
						}
					],
					"apps_by_hostname": {
						"beryllium": "web",
						"boron": "web",
						"carbon": "mysql",
						"helium": "web",
						"hydrogen": "web",
						"lithium": "mysql",
						"nitrogen": "web",
						"oxygen": "mongodb"
					},
					"containers": [
						{
							"image": "redis",
							"ipaddress": "10.0.0.1",
							"name": "big_stallman"
						},
						{
							"image": "nginx",
							"ipaddress": "10.0.0.2",
							"name": "cranky_euclid"
						}
					],
					"sites": [
						{
							"name": "prod",
							"region": "east",
							"servers": [
								{
									"hostname": "hydrogen",
									"name": "web-0"
								},
								{
									"hostname": "helium",
									"name": "web-1"
								},
								{
									"hostname": "lithium",
									"name": "db-0"
								}
							]
						},
						{
							"name": "smoke",
							"region": "west",
							"servers": [
								{
									"hostname": "beryllium",
									"name": "web-1000"
								},
								{
									"hostname": "boron",
									"name": "web-1001"
								},
								{
									"hostname": "carbon",
									"name": "db-1000"
								}
							]
						},
						{
							"name": "dev",
							"region": "west",
							"servers": [
								{
									"hostname": "nitrogen",
									"name": "web-dev"
								},
								{
									"hostname": "oxygen",
									"name": "db-dev"
								}
							]
						}
					]
				}
			}
		},
		{
			"note": "refheads/website-example/partial-set",
			"query": "data.example.public_network = x",
			"modules": [
				"package example\n\npublic_network contains net.id if {\n\tsome net in input.networks\n\tnet.public\n}\n"
			],
			"input": {
				"networks": [
					{
						"id": "n1",
						"public": true
					},
					{
						"id": "n2",
						"public": false
					}
				]
			},
			"want_result": [
				{
					"x": [
						"n1"
					]
				}
			],
			"entrypoints": [
				"example"
			],
			"plan": {
				"funcs": {
					"funcs": [
						{
							"blocks": [
								{
									"stmts": [
										{
											"stmt": {
												"col": 1,
												"file": 0,
												"row": 3,
												"target": 2
											},
											"type": "MakeSetStmt"
										}
									]
								},
								{
									"stmts": [
										{
											"stmt": {
												"col": 1,
												"file": 0,
												"row": 3,
												"target": 3
											},
											"type": "ResetLocalStmt"
										},
										{
											"stmt": {
												"col": 2,
												"file": 0,
												"key": {
													"type": "string_index",
													"value": 2
												},
												"row": 4,
												"source": {
													"type": "local",
													"value": 0
												},
												"target": 4
											},
											"type": "DotStmt"
										},
										{
											"stmt": {
												"block": {
													"stmts": [
														{
															"stmt": {
																"col": 2,
																"file": 0,
																"row": 4,
																"source": {
																	"type": "local",
																	"value": 5
																},
																"target": 7
															},
															"type": "AssignVarStmt"
														},
														{
															"stmt": {
																"col": 2,
																"file": 0,
																"row": 4,
																"source": {
																	"type": "local",
																	"value": 6
																},
																"target": 8
															},
															"type": "AssignVarStmt"
														},
														{
															"stmt": {
																"col": 2,
																"file": 0,
																"key": {
																	"type": "string_index",
																	"value": 3
																},
																"row": 5,
																"source": {
																	"type": "local",
																	"value": 8
																},
																"target": 9
															},
															"type": "DotStmt"
														},
														{
															"stmt": {
																"a": {
																	"type": "local",
																	"value": 9
																},
																"b": {
																	"type": "bool",
																	"value": false
																},
																"col": 2,
																"file": 0,
																"row": 5
															},
															"type": "NotEqualStmt"
														},
														{
															"stmt": {
																"col": 25,
																"file": 0,
																"key": {
																	"type": "string_index",
																	"value": 4
																},
																"row": 3,
																"source": {
																	"type": "local",
																	"value": 8
																},
																"target": 10
															},
															"type": "DotStmt"
														},
														{
															"stmt": {
																"col": 25,
																"file": 0,
																"row": 3,
																"source": {
																	"type": "local",
																	"value": 10
																},
																"target": 11
															},
															"type": "AssignVarStmt"
														},
														{
															"stmt": {
																"col": 1,
																"file": 0,
																"row": 3,
																"set": 2,
																"value": {
																	"type": "local",
																	"value": 11
																}
															},
															"type": "SetAddStmt"
														}
													]
												},
												"col": 2,
												"file": 0,
												"key": 5,
												"row": 4,
												"source": 4,
												"value": 6
											},
											"type": "ScanStmt"
										}
									]
								},
								{
									"stmts": [
										{
											"stmt": {
												"col": 1,
												"file": 0,
												"row": 3,
												"source": 2
											},
											"type": "ReturnLocalStmt"
										}
									]
								}
							],
							"name": "g0.data.example.public_network",
							"params": [
								0,
								1
							],
							"path": [
								"g0",
								"example",
								"public_network"
							],
							"return": 2
						}
					]
				},
				"plans": {
					"plans": [
						{
							"blocks": [
								{
									"stmts": [
										{
											"stmt": {
												"col": 0,
												"file": 0,
												"row": 0,
												"target": 2
											},
											"type": "MakeObjectStmt"
										},
										{
											"stmt": {
												"blocks": [
													{
														"stmts": [
															{
																"stmt": {
																	"args": [
																		{
																			"type": "local",
																			"value": 0
																		},
																		{
																			"type": "local",
																			"value": 1
																		}
																	],
																	"col": 0,
																	"file": 0,
																	"func": "g0.data.example.public_network",
																	"result": 3,
																	"row": 0
																},
																"type": "CallStmt"
															},
															{
																"stmt": {
																	"col": 0,
																	"file": 0,
																	"key": {
																		"type": "string_index",
																		"value": 1
																	},
																	"object": 2,
																	"row": 0,
																	"value": {
																		"type": "local",
																		"value": 3
																	}
																},
																"type": "ObjectInsertStmt"
															}
														]
													}
												],
												"col": 0,
												"file": 0,
												"row": 0
											},
											"type": "BlockStmt"
										},
										{
											"stmt": {
												"blocks": [
													{
														"stmts": [
															{
																"stmt": {
																	"blocks": [
																		{
																			"stmts": [
																				{
																					"stmt": {
																						"col": 0,
																						"file": 0,
																						"key": {
																							"type": "string_index",
																							"value": 5
																						},
																						"row": 0,
																						"source": {
																							"type": "local",
																							"value": 1
																						},
																						"target": 5
																					},
																					"type": "DotStmt"
																				},
																				{
																					"stmt": {
																						"a": 5,
																						"b": 2,
																						"col": 0,
																						"file": 0,
																						"row": 0,
																						"target": 4
																					},
																					"type": "ObjectMergeStmt"
																				},
																				{
																					"stmt": {
																						"col": 0,
																						"file": 0,
																						"index": 1,
																						"row": 0
																					},
																					"type": "BreakStmt"
																				}
																			]
																		}
																	],
																	"col": 0,
																	"file": 0,
																	"row": 0
																},
																"type": "BlockStmt"
															},
															{
																"stmt": {
																	"col": 0,
																	"file": 0,
																	"row": 0,
																	"source": {
																		"type": "local",
																		"value": 2
																	},
																	"target": 4
																},
																"type": "AssignVarStmt"
															}
														]
													}
												],
												"col": 0,
												"file": 0,
												"row": 0
											},
											"type": "BlockStmt"
										},
										{
											"stmt": {
												"col": 0,
												"file": 0,
												"row": 0,
												"source": {
													"type": "local",
													"value": 4
												},
												"target": 6
											},
											"type": "AssignVarStmt"
										},
										{
											"stmt": {
												"col": 0,
												"file": 0,
												"row": 0,
												"target": 7
											},
											"type": "MakeObjectStmt"
										},
										{
											"stmt": {
												"col": 0,
												"file": 0,
												"key": {
													"type": "string_index",
													"value": 0
												},
												"object": 7,
												"row": 0,
												"value": {
													"type": "local",
													"value": 6
												}
											},
											"type": "ObjectInsertStmt"
										},
										{
											"stmt": {
												"col": 0,
												"file": 0,
												"row": 0,
												"value": 7
											},
											"type": "ResultSetAddStmt"
										}
									]
								}
							],
							"name": "example"
						}
					]
				},
				"static": {
					"files": [
						{
							"value": "mod_0"
						}
					],
					"strings": [
						{
							"value": "result"
						},
						{
							"value": "public_network"
						},
						{
							"value": "networks"
						},
						{
							"value": "public"
						},
						{
							"value": "id"
						},
						{
							"value": "example"
						}
					]
				}
			},
			"want_plan_result": {
				"data_example": {
					"public_network": [
						"n1"
					]
				}
			}
		},
		{
			"note": "refheads/many-vars",
			"query": "data.test.p = x",
			"modules": [
				"package test\n\np[a][b][c][d][e] if {\n\tsome a in numbers.range(1, 5)\n\tsome b in numbers.range(1, 5)\n\tsome c in numbers.range(1, 5)\n\tsome d in numbers.range(1, 5)\n\tsome e in numbers.range(1, 5)\n\t(((a + b) + c) + d) + e == 24\n}\n"
			],
			"want_result": [
				{
					"x": {
						"4": {
							"5": {
								"5": {
									"5": {
										"5": true
									}
								}
							}
						},
						"5": {
							"4": {
								"5": {
									"5": {
										"5": true
									}
								}
							},
							"5": {
								"4": {
									"5": {
										"5": true
									}
								},
								"5": {
									"4": {
										"5": true
									},
									"5": {
										"4": true
									}
								}
							}
						}
					}
				}
			],
			"entrypoints": [
				"test"
			],
			"plan": {
				"funcs": {
					"funcs": [
						{
							"blocks": [
								{
									"stmts": [
										{
											"stmt": {
												"col": 1,
												"file": 0,
												"row": 3,
												"target": 2
											},
											"type": "MakeObjectStmt"
										}
									]
								},
								{
									"stmts": [
										{
											"stmt": {
												"col": 1,
												"file": 0,
												"row": 3,
												"target": 3
											},
											"type": "ResetLocalStmt"
										},
										{
											"stmt": {
												"Index": 2,
												"col": 12,
												"file": 0,
												"row": 4,
												"target": 4
											},
											"type": "MakeNumberRefStmt"
										},
										{
											"stmt": {
												"Index": 3,
												"col": 12,
												"file": 0,
												"row": 4,
												"target": 5
											},
											"type": "MakeNumberRefStmt"
										},
										{
											"stmt": {
												"args": [
													{
														"type": "local",
														"value": 4
													},
													{
														"type": "local",
														"value": 5
													}
												],
												"col": 12,
												"file": 0,
												"func": "numbers.range",
												"result": 6,
												"row": 4
											},
											"type": "CallStmt"
										},
										{
											"stmt": {
												"col": 12,
												"file": 0,
												"row": 4,
												"source": {
													"type": "local",
													"value": 6
												},
												"target": 7
											},
											"type": "AssignVarStmt"
										},
										{
											"stmt": {
												"block": {
													"stmts": [
														{
															"stmt": {
																"col": 2,
																"file": 0,
																"row": 4,
																"source": {
																	"type": "local",
																	"value": 8
																},
																"target": 10
															},
															"type": "AssignVarStmt"
														},
														{
															"stmt": {
																"col": 2,
																"file": 0,
																"row": 4,
																"source": {
																	"type": "local",
																	"value": 9
																},
																"target": 11
															},
															"type": "AssignVarStmt"
														},
														{
															"stmt": {
																"Index": 2,
																"col": 12,
																"file": 0,
																"row": 5,
																"target": 12
															},
															"type": "MakeNumberRefStmt"
														},
														{
															"stmt": {
																"Index": 3,
																"col": 12,
																"file": 0,
																"row": 5,
																"target": 13
															},
															"type": "MakeNumberRefStmt"
														},
														{
															"stmt": {
																"args": [
																	{
																		"type": "local",
																		"value": 12
																	},
																	{
																		"type": "local",
																		"value": 13
																	}
																],
																"col": 12,
																"file": 0,
																"func": "numbers.range",
																"result": 14,
																"row": 5
															},
															"type": "CallStmt"
														},
														{
															"stmt": {
																"col": 12,
																"file": 0,
																"row": 5,
																"source": {
																	"type": "local",
																	"value": 14
																},
																"target": 15
															},
															"type": "AssignVarStmt"
														},
														{
															"stmt": {
																"block": {
																	"stmts": [
																		{
																			"stmt": {
																				"col": 2,
																				"file": 0,
																				"row": 5,
																				"source": {
																					"type": "local",
																					"value": 16
																				},
																				"target": 18
																			},
																			"type": "AssignVarStmt"
																		},
																		{
																			"stmt": {
																				"col": 2,
																				"file": 0,
																				"row": 5,
																				"source": {
																					"type": "local",
																					"value": 17
																				},
																				"target": 19
																			},
																			"type": "AssignVarStmt"
																		},
																		{
																			"stmt": {
																				"Index": 2,
																				"col": 12,
																				"file": 0,
																				"row": 6,
																				"target": 20
																			},
																			"type": "MakeNumberRefStmt"
																		},
																		{
																			"stmt": {
																				"Index": 3,
																				"col": 12,
																				"file": 0,
																				"row": 6,
																				"target": 21
																			},
																			"type": "MakeNumberRefStmt"
																		},
																		{
																			"stmt": {
																				"args": [
																					{
																						"type": "local",
																						"value": 20
																					},
																					{
																						"type": "local",
																						"value": 21
																					}
																				],
																				"col": 12,
																				"file": 0,
																				"func": "numbers.range",
																				"result": 22,
																				"row": 6
																			},
																			"type": "CallStmt"
																		},
																		{
																			"stmt": {
																				"col": 12,
																				"file": 0,
																				"row": 6,
																				"source": {
																					"type": "local",
																					"value": 22
																				},
																				"target": 23
																			},
																			"type": "AssignVarStmt"
																		},
																		{
																			"stmt": {
																				"block": {
																					"stmts": [
																						{
																							"stmt": {
																								"col": 2,
																								"file": 0,
																								"row": 6,
																								"source": {
																									"type": "local",
																									"value": 24
																								},
																								"target": 26
																							},
																							"type": "AssignVarStmt"
																						},
																						{
																							"stmt": {
																								"col": 2,
																								"file": 0,
																								"row": 6,
																								"source": {
																									"type": "local",
																									"value": 25
																								},
																								"target": 27
																							},
																							"type": "AssignVarStmt"
																						},
																						{
																							"stmt": {
																								"Index": 2,
																								"col": 12,
																								"file": 0,
																								"row": 7,
																								"target": 28
																							},
																							"type": "MakeNumberRefStmt"
																						},
																						{
																							"stmt": {
																								"Index": 3,
																								"col": 12,
																								"file": 0,
																								"row": 7,
																								"target": 29
																							},
																							"type": "MakeNumberRefStmt"
																						},
																						{
																							"stmt": {
																								"args": [
																									{
																										"type": "local",
																										"value": 28
																									},
																									{
																										"type": "local",
																										"value": 29
																									}
																								],
																								"col": 12,
																								"file": 0,
																								"func": "numbers.range",
																								"result": 30,
																								"row": 7
																							},
																							"type": "CallStmt"
																						},
																						{
																							"stmt": {
																								"col": 12,
																								"file": 0,
																								"row": 7,
																								"source": {
																									"type": "local",
																									"value": 30
																								},
																								"target": 31
																							},
																							"type": "AssignVarStmt"
																						},
																						{
																							"stmt": {
																								"block": {
																									"stmts": [
																										{
																											"stmt": {
																												"col": 2,
																												"file": 0,
																												"row": 7,
																												"source": {
																													"type": "local",
																													"value": 32
																												},
																												"target": 34
																											},
																											"type": "AssignVarStmt"
																										},
																										{
																											"stmt": {
																												"col": 2,
																												"file": 0,
																												"row": 7,
																												"source": {
																													"type": "local",
																													"value": 33
																												},
																												"target": 35
																											},
																											"type": "AssignVarStmt"
																										},
																										{
																											"stmt": {
																												"Index": 2,
																												"col": 12,
																												"file": 0,
																												"row": 8,
																												"target": 36
																											},
																											"type": "MakeNumberRefStmt"
																										},
																										{
																											"stmt": {
																												"Index": 3,
																												"col": 12,
																												"file": 0,
																												"row": 8,
																												"target": 37
																											},
																											"type": "MakeNumberRefStmt"
																										},
																										{
																											"stmt": {
																												"args": [
																													{
																														"type": "local",
																														"value": 36
																													},
																													{
																														"type": "local",
																														"value": 37
																													}
																												],
																												"col": 12,
																												"file": 0,
																												"func": "numbers.range",
																												"result": 38,
																												"row": 8
																											},
																											"type": "CallStmt"
																										},
																										{
																											"stmt": {
																												"col": 12,
																												"file": 0,
																												"row": 8,
																												"source": {
																													"type": "local",
																													"value": 38
																												},
																												"target": 39
																											},
																											"type": "AssignVarStmt"
																										},
																										{
																											"stmt": {
																												"block": {
																													"stmts": [
																														{
																															"stmt": {
																																"col": 2,
																																"file": 0,
																																"row": 8,
																																"source": {
																																	"type": "local",
																																	"value": 40
																																},
																																"target": 42
																															},
																															"type": "AssignVarStmt"
																														},
																														{
																															"stmt": {
																																"col": 2,
																																"file": 0,
																																"row": 8,
																																"source": {
																																	"type": "local",
																																	"value": 41
																																},
																																"target": 43
																															},
																															"type": "AssignVarStmt"
																														},
																														{
																															"stmt": {
																																"args": [
																																	{
																																		"type": "local",
																																		"value": 11
																																	},
																																	{
																																		"type": "local",
																																		"value": 19
																																	}
																																],
																																"col": 5,
																																"file": 0,
																																"func": "plus",
																																"result": 44,
																																"row": 9
																															},
																															"type": "CallStmt"
																														},
																														{
																															"stmt": {
																																"col": 5,
																																"file": 0,
																																"row": 9,
																																"source": {
																																	"type": "local",
																																	"value": 44
																																},
																																"target": 45
																															},
																															"type": "AssignVarStmt"
																														},
																														{
																															"stmt": {
																																"args": [
																																	{
																																		"type": "local",
																																		"value": 45
																																	},
																																	{
																																		"type": "local",
																																		"value": 27
																																	}
																																],
																																"col": 5,
																																"file": 0,
																																"func": "plus",
																																"result": 46,
																																"row": 9
																															},
																															"type": "CallStmt"
																														},
																														{
																															"stmt": {
																																"col": 5,
																																"file": 0,
																																"row": 9,
																																"source": {
																																	"type": "local",
																																	"value": 46
																																},
																																"target": 47
																															},
																															"type": "AssignVarStmt"
																														},
																														{
																															"stmt": {
																																"args": [
																																	{
																																		"type": "local",
																																		"value": 47
																																	},
																																	{
																																		"type": "local",
																																		"value": 35
																																	}
																																],
																																"col": 5,
																																"file": 0,
																																"func": "plus",
																																"result": 48,
																																"row": 9
																															},
																															"type": "CallStmt"
																														},
																														{
																															"stmt": {
																																"col": 5,
																																"file": 0,
																																"row": 9,
																																"source": {
																																	"type": "local",
																																	"value": 48
																																},
																																"target": 49
																															},
																															"type": "AssignVarStmt"
																														},
																														{
																															"stmt": {
																																"args": [
																																	{
																																		"type": "local",
																																		"value": 49
																																	},
																																	{
																																		"type": "local",
																																		"value": 43
																																	}
																																],
																																"col": 5,
																																"file": 0,
																																"func": "plus",
																																"result": 50,
																																"row": 9
																															},
																															"type": "CallStmt"
																														},
																														{
																															"stmt": {
																																"col": 5,
																																"file": 0,
																																"row": 9,
																																"source": {
																																	"type": "local",
																																	"value": 50
																																},
																																"target": 51
																															},
																															"type": "AssignVarStmt"
																														},
																														{
																															"stmt": {
																																"Index": 4,
																																"col": 2,
																																"file": 0,
																																"row": 9,
																																"target": 52
																															},
																															"type": "MakeNumberRefStmt"
																														},
																														{
																															"stmt": {
																																"a": {
																																	"type": "local",
																																	"value": 51
																																},
																																"b": {
																																	"type": "local",
																																	"value": 52
																																},
																																"col": 2,
																																"file": 0,
																																"row": 9
																															},
																															"type": "EqualStmt"
																														},
																														{
																															"stmt": {
																																"blocks": [
																																	{
																																		"stmts": [
																																			{
																																				"stmt": {
																																					"blocks": [
																																						{
																																							"stmts": [
																																								{
																																									"stmt": {
																																										"col": 1,
																																										"file": 0,
																																										"key": {
																																											"type": "local",
																																											"value": 11
																																										},
																																										"row": 3,
																																										"source": {
																																											"type": "local",
																																											"value": 2
																																										},
																																										"target": 53
																																									},
																																									"type": "DotStmt"
																																								},
																																								{
																																									"stmt": {
																																										"col": 1,
																																										"file": 0,
																																										"index": 1,
																																										"row": 3
																																									},
																																									"type": "BreakStmt"
																																								}
																																							]
																																						}
																																					],
																																					"col": 0,
																																					"file": 0,
																																					"row": 0
																																				},
																																				"type": "BlockStmt"
																																			},
																																			{
																																				"stmt": {
																																					"col": 0,
																																					"file": 0,
																																					"row": 0,
																																					"target": 53
																																				},
																																				"type": "MakeObjectStmt"
																																			}
																																		]
																																	}
																																],
																																"col": 1,
																																"file": 0,
																																"row": 3
																															},
																															"type": "BlockStmt"
																														},
																														{
																															"stmt": {
																																"blocks": [
																																	{
																																		"stmts": [
																																			{
																																				"stmt": {
																																					"blocks": [
																																						{
																																							"stmts": [
																																								{
																																									"stmt": {
																																										"col": 1,
																																										"file": 0,
																																										"key": {
																																											"type": "local",
																																											"value": 19
																																										},
																																										"row": 3,
																																										"source": {
																																											"type": "local",
																																											"value": 53
																																										},
																																										"target": 54
																																									},
																																									"type": "DotStmt"
																																								},
																																								{
																																									"stmt": {
																																										"col": 1,
																																										"file": 0,
																																										"index": 1,
																																										"row": 3
																																									},
																																									"type": "BreakStmt"
																																								}
																																							]
																																						}
																																					],
																																					"col": 0,
																																					"file": 0,
																																					"row": 0
																																				},
																																				"type": "BlockStmt"
																																			},
																																			{
																																				"stmt": {
																																					"col": 0,
																																					"file": 0,
																																					"row": 0,
																																					"target": 54
																																				},
																																				"type": "MakeObjectStmt"
																																			}
																																		]
																																	}
																																],
																																"col": 1,
																																"file": 0,
																																"row": 3
																															},
																															"type": "BlockStmt"
																														},
																														{
																															"stmt": {
																																"blocks": [
																																	{
																																		"stmts": [
																																			{
																																				"stmt": {
																																					"blocks": [
																																						{
																																							"stmts": [
																																								{
																																									"stmt": {
																																										"col": 1,
																																										"file": 0,
																																										"key": {
																																											"type": "local",
																																											"value": 27
																																										},
																																										"row": 3,
																																										"source": {
																																											"type": "local",
																																											"value": 54
																																										},
																																										"target": 55
																																									},
																																									"type": "DotStmt"
																																								},
																																								{
																																									"stmt": {
																																										"col": 1,
																																										"file": 0,
																																										"index": 1,
																																										"row": 3
																																									},
																																									"type": "BreakStmt"
																																								}
																																							]
																																						}
																																					],
																																					"col": 0,
																																					"file": 0,
																																					"row": 0
																																				},
																																				"type": "BlockStmt"
																																			},
																																			{
																																				"stmt": {
																																					"col": 0,
																																					"file": 0,
																																					"row": 0,
																																					"target": 55
																																				},
																																				"type": "MakeObjectStmt"
																																			}
																																		]
																																	}
																																],
																																"col": 1,
																																"file": 0,
																																"row": 3
																															},
																															"type": "BlockStmt"
																														},
																														{
																															"stmt": {
																																"blocks": [
																																	{
																																		"stmts": [
																																			{
																																				"stmt": {
																																					"blocks": [
																																						{
																																							"stmts": [
																																								{
																																									"stmt": {
																																										"col": 1,
																																										"file": 0,
																																										"key": {
																																											"type": "local",
																																											"value": 35
																																										},
																																										"row": 3,
																																										"source": {
																																											"type": "local",
																																											"value": 55
																																										},
																																										"target": 56
																																									},
																																									"type": "DotStmt"
																																								},
																																								{
																																									"stmt": {
																																										"col": 1,
																																										"file": 0,
																																										"index": 1,
																																										"row": 3
																																									},
																																									"type": "BreakStmt"
																																								}
																																							]
																																						}
																																					],
																																					"col": 0,
																																					"file": 0,
																																					"row": 0
																																				},
																																				"type": "BlockStmt"
																																			},
																																			{
																																				"stmt": {
																																					"col": 0,
																																					"file": 0,
																																					"row": 0,
																																					"target": 56
																																				},
																																				"type": "MakeObjectStmt"
																																			}
																																		]
																																	}
																																],
																																"col": 1,
																																"file": 0,
																																"row": 3
																															},
																															"type": "BlockStmt"
																														},
																														{
																															"stmt": {
																																"col": 1,
																																"file": 0,
																																"key": {
																																	"type": "local",
																																	"value": 43
																																},
																																"object": 56,
																																"row": 3,
																																"value": {
																																	"type": "bool",
																																	"value": true
																																}
																															},
																															"type": "ObjectInsertOnceStmt"
																														},
																														{
																															"stmt": {
																																"col": 1,
																																"file": 0,
																																"key": {
																																	"type": "local",
																																	"value": 35
																																},
																																"object": 55,
																																"row": 3,
																																"value": {
																																	"type": "local",
																																	"value": 56
																																}
																															},
																															"type": "ObjectInsertStmt"
																														},
																														{
																															"stmt": {
																																"col": 1,
																																"file": 0,
																																"key": {
																																	"type": "local",
																																	"value": 27
																																},
																																"object": 54,
																																"row": 3,
																																"value": {
																																	"type": "local",
																																	"value": 55
																																}
																															},
																															"type": "ObjectInsertStmt"
																														},
																														{
																															"stmt": {
																																"col": 1,
																																"file": 0,
																																"key": {
																																	"type": "local",
																																	"value": 19
																																},
																																"object": 53,
																																"row": 3,
																																"value": {
																																	"type": "local",
																																	"value": 54
																																}
																															},
																															"type": "ObjectInsertStmt"
																														},
																														{
																															"stmt": {
																																"col": 1,
																																"file": 0,
																																"key": {
																																	"type": "local",
																																	"value": 11
																																},
																																"object": 2,
																																"row": 3,
																																"value": {
																																	"type": "local",
																																	"value": 53
																																}
																															},
																															"type": "ObjectInsertStmt"
																														}
																													]
																												},
																												"col": 2,
																												"file": 0,
																												"key": 40,
																												"row": 8,
																												"source": 39,
																												"value": 41
																											},
																											"type": "ScanStmt"
																										}
																									]
																								},
																								"col": 2,
																								"file": 0,
																								"key": 32,
																								"row": 7,
																								"source": 31,
																								"value": 33
																							},
																							"type": "ScanStmt"
																						}
																					]
																				},
																				"col": 2,
																				"file": 0,
																				"key": 24,
																				"row": 6,
																				"source": 23,
																				"value": 25
																			},
																			"type": "ScanStmt"
																		}
																	]
																},
																"col": 2,
																"file": 0,
																"key": 16,
																"row": 5,
																"source": 15,
																"value": 17
															},
															"type": "ScanStmt"
														}
													]
												},
												"col": 2,
												"file": 0,
												"key": 8,
												"row": 4,
												"source": 7,
												"value": 9
											},
											"type": "ScanStmt"
										}
									]
								},
								{
									"stmts": [
										{
											"stmt": {
												"col": 1,
												"file": 0,
												"row": 3,
												"source": 2
											},
											"type": "ReturnLocalStmt"
										}
									]
								}
							],
							"name": "g0.data.test.p",
							"params": [
								0,
								1
							],
							"path": [
								"g0",
								"test",
								"p"
							],
							"return": 2
						}
					]
				},
				"plans": {
					"plans": [
						{
							"blocks": [
								{
									"stmts": [
										{
											"stmt": {
												"col": 0,
												"file": 0,
												"row": 0,
												"target": 2
											},
											"type": "MakeObjectStmt"
										},
										{
											"stmt": {
												"blocks": [
													{
														"stmts": [
															{
																"stmt": {
																	"args": [
																		{
																			"type": "local",
																			"value": 0
																		},
																		{
																			"type": "local",
																			"value": 1
																		}
																	],
																	"col": 0,
																	"file": 0,
																	"func": "g0.data.test.p",
																	"result": 3,
																	"row": 0
																},
																"type": "CallStmt"
															},
															{
																"stmt": {
																	"col": 0,
																	"file": 0,
																	"key": {
																		"type": "string_index",
																		"value": 1
																	},
																	"object": 2,
																	"row": 0,
																	"value": {
																		"type": "local",
																		"value": 3
																	}
																},
																"type": "ObjectInsertStmt"
															}
														]
													}
												],
												"col": 0,
												"file": 0,
												"row": 0
											},
											"type": "BlockStmt"
										},
										{
											"stmt": {
												"blocks": [
													{
														"stmts": [
															{
																"stmt": {
																	"blocks": [
																		{
																			"stmts": [
																				{
																					"stmt": {
																						"col": 0,
																						"file": 0,
																						"key": {
																							"type": "string_index",
																							"value": 5
																						},
																						"row": 0,
																						"source": {
																							"type": "local",
																							"value": 1
																						},
																						"target": 5
																					},
																					"type": "DotStmt"
																				},
																				{
																					"stmt": {
																						"a": 5,
																						"b": 2,
																						"col": 0,
																						"file": 0,
																						"row": 0,
																						"target": 4
																					},
																					"type": "ObjectMergeStmt"
																				},
																				{
																					"stmt": {
																						"col": 0,
																						"file": 0,
																						"index": 1,
																						"row": 0
																					},
																					"type": "BreakStmt"
																				}
																			]
																		}
																	],
																	"col": 0,
																	"file": 0,
																	"row": 0
																},
																"type": "BlockStmt"
															},
															{
																"stmt": {
																	"col": 0,
																	"file": 0,
																	"row": 0,
																	"source": {
																		"type": "local",
																		"value": 2
																	},
																	"target": 4
																},
																"type": "AssignVarStmt"
															}
														]
													}
												],
												"col": 0,
												"file": 0,
												"row": 0
											},
											"type": "BlockStmt"
										},
										{
											"stmt": {
												"col": 0,
												"file": 0,
												"row": 0,
												"source": {
													"type": "local",
													"value": 4
												},
												"target": 6
											},
											"type": "AssignVarStmt"
										},
										{
											"stmt": {
												"col": 0,
												"file": 0,
												"row": 0,
												"target": 7
											},
											"type": "MakeObjectStmt"
										},
										{
											"stmt": {
												"col": 0,
												"file": 0,
												"key": {
													"type": "string_index",
													"value": 0
												},
												"object": 7,
												"row": 0,
												"value": {
													"type": "local",
													"value": 6
												}
											},
											"type": "ObjectInsertStmt"
										},
										{
											"stmt": {
												"col": 0,
												"file": 0,
												"row": 0,
												"value": 7
											},
											"type": "ResultSetAddStmt"
										}
									]
								}
							],
							"name": "test"
						}
					]
				},
				"static": {
					"builtin_funcs": [
						{
							"decl": {
								"args": [
									{
										"description": "the start of the range",
										"name": "a",
										"type": "number"
									},
									{
										"description": "the end of the range (inclusive)",
										"name": "b",
										"type": "number"
									}
								],
								"result": {
									"description": "the range between `a` and `b`",
									"dynamic": {
										"type": "number"
									},
									"name": "range",
									"type": "array"
								},
								"type": "function"
							},
							"name": "numbers.range"
						},
						{
							"decl": {
								"args": [
									{
										"name": "x",
										"type": "number"
									},
									{
										"name": "y",
										"type": "number"
									}
								],
								"result": {
									"description": "the sum of `x` and `y`",
									"name": "z",
									"type": "number"
								},
								"type": "function"
							},
							"name": "plus"
						}
					],
					"files": [
						{
							"value": "mod_0"
						}
					],
					"strings": [
						{
							"value": "result"
						},
						{
							"value": "p"
						},
						{
							"value": "1"
						},
						{
							"value": "5"
						},
						{
							"value": "24"
						},
						{
							"value": "test"
						}
					]
				}
			},
			"want_plan_result": {
				"data_test": {
					"p": {
						"4": {
							"5": {
								"5": {
									"5": {
										"5": true
									}
								}
							}
						},
						"5": {
							"4": {
								"5": {
									"5": {
										"5": true
									}
								}
							},
							"5": {
								"4": {
									"5": {
										"5": true
									}
								},
								"5": {
									"4": {
										"5": true
									},
									"5": {
										"4": true
									}
								}
							}
						}
					}
				}
			}
		}
	]
}