{
	"cases": [
		{
			"note": "providers-aws-sign_req/success-simple-no body",
			"query": "data.test.p = x",
			"modules": [
				"package test\n\nreq := {\"method\": \"get\", \"url\": \"http://example.com\"}\n\naws_config := {\n\t\"aws_access_key\": \"MYAWSACCESSKEYGOESHERE\",\n\t\"aws_secret_access_key\": \"MYAWSSECRETACCESSKEYGOESHERE\",\n\t\"aws_service\": \"s3\",\n\t\"aws_region\": \"us-east-1\",\n}\n\nexpected := {\n\t\"headers\": {\n\t\t\"Authorization\": \"AWS4-HMAC-SHA256 Credential=MYAWSACCESSKEYGOESHERE/20151228/us-east-1/s3/aws4_request,SignedHeaders=host;x-amz-content-sha256;x-amz-date,Signature=0047a7016c81e5c7f29cd522f97e911e04fc472fced0aee7916cbc287ad6c8e3\",\n\t\t\"host\": \"example.com\",\n\t\t\"x-amz-content-sha256\": \"e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855\",\n\t\t\"x-amz-date\": \"20151228T140825Z\",\n\t},\n\t\"method\": \"get\",\n\t\"url\": \"http://example.com\",\n}\n\np if {\n\tproviders.aws.sign_req(req, aws_config, 1451311705000000000) == expected\n}\n"
			],
			"want_result": [
				{
					"x": true
				}
			],
			"entrypoints": [
				"eval"
			],
			"plan": {
				"static": {
					"strings": [
						{
							"value": "x"
						},
						{
							"value": "method"
						},
						{
							"value": "get"
						},
						{
							"value": "url"
						},
						{
							"value": "http://example.com"
						},
						{
							"value": "aws_access_key"
						},
						{
							"value": "MYAWSACCESSKEYGOESHERE"
						},
						{
							"value": "aws_region"
						},
						{
							"value": "us-east-1"
						},
						{
							"value": "aws_secret_access_key"
						},
						{
							"value": "MYAWSSECRETACCESSKEYGOESHERE"
						},
						{
							"value": "aws_service"
						},
						{
							"value": "s3"
						},
						{
							"value": "1451311705000000000"
						},
						{
							"value": "headers"
						},
						{
							"value": "Authorization"
						},
						{
							"value": "AWS4-HMAC-SHA256 Credential=MYAWSACCESSKEYGOESHERE/20151228/us-east-1/s3/aws4_request,SignedHeaders=host;x-amz-content-sha256;x-amz-date,Signature=0047a7016c81e5c7f29cd522f97e911e04fc472fced0aee7916cbc287ad6c8e3"
						},
						{
							"value": "host"
						},
						{
							"value": "example.com"
						},
						{
							"value": "x-amz-content-sha256"
						},
						{
							"value": "e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855"
						},
						{
							"value": "x-amz-date"
						},
						{
							"value": "20151228T140825Z"
						}
					],
					"builtin_funcs": [
						{
							"name": "providers.aws.sign_req",
							"decl": {
								"args": [
									{
										"description": "HTTP request object",
										"dynamic": {
											"key": {
												"type": "string"
											},
											"value": {
												"type": "any"
											}
										},
										"name": "request",
										"type": "object"
									},
									{
										"description": "AWS configuration object",
										"dynamic": {
											"key": {
												"type": "string"
											},
											"value": {
												"type": "any"
											}
										},
										"name": "aws_config",
										"type": "object"
									},
									{
										"description": "nanoseconds since the epoch",
										"name": "time_ns",
										"type": "number"
									}
								],
								"result": {
									"description": "HTTP request object with `Authorization` header",
									"dynamic": {
										"key": {
											"type": "any"
										},
										"value": {
											"type": "any"
										}
									},
									"name": "signed_request",
									"type": "object"
								},
								"type": "function"
							}
						}
					],
					"files": [
						{
							"value": "module-0.rego"
						},
						{
							"value": "\u003cquery\u003e"
						}
					]
				},
				"plans": {
					"plans": [
						{
							"name": "eval",
							"blocks": [
								{
									"stmts": [
										{
											"type": "CallStmt",
											"stmt": {
												"func": "g0.data.test.p",
												"args": [
													{
														"type": "local",
														"value": 0
													},
													{
														"type": "local",
														"value": 1
													}
												],
												"result": 2,
												"file": 1,
												"col": 1,
												"row": 1
											}
										},
										{
											"type": "AssignVarStmt",
											"stmt": {
												"source": {
													"type": "local",
													"value": 2
												},
												"target": 3,
												"file": 1,
												"col": 1,
												"row": 1
											}
										},
										{
											"type": "MakeObjectStmt",
											"stmt": {
												"target": 4,
												"file": 1,
												"col": 1,
												"row": 1
											}
										},
										{
											"type": "ObjectInsertStmt",
											"stmt": {
												"key": {
													"type": "string_index",
													"value": 0
												},
												"value": {
													"type": "local",
													"value": 3
												},
												"object": 4,
												"file": 1,
												"col": 1,
												"row": 1
											}
										},
										{
											"type": "ResultSetAddStmt",
											"stmt": {
												"value": 4,
												"file": 1,
												"col": 1,
												"row": 1
											}
										}
									]
								}
							]
						}
					]
				},
				"funcs": {
					"funcs": [
						{
							"name": "g0.data.test.req",
							"params": [
								0,
								1
							],
							"return": 2,
							"blocks": [
								{
									"stmts": [
										{
											"type": "ResetLocalStmt",
											"stmt": {
												"target": 3,
												"file": 0,
												"col": 1,
												"row": 3
											}
										},
										{
											"type": "MakeObjectStmt",
											"stmt": {
												"target": 4,
												"file": 0,
												"col": 1,
												"row": 3
											}
										},
										{
											"type": "ObjectInsertStmt",
											"stmt": {
												"key": {
													"type": "string_index",
													"value": 1
												},
												"value": {
													"type": "string_index",
													"value": 2
												},
												"object": 4,
												"file": 0,
												"col": 1,
												"row": 3
											}
										},
										{
											"type": "ObjectInsertStmt",
											"stmt": {
												"key": {
													"type": "string_index",
													"value": 3
												},
												"value": {
													"type": "string_index",
													"value": 4
												},
												"object": 4,
												"file": 0,
												"col": 1,
												"row": 3
											}
										},
										{
											"type": "AssignVarOnceStmt",
											"stmt": {
												"source": {
													"type": "local",
													"value": 4
												},
												"target": 3,
												"file": 0,
												"col": 1,
												"row": 3
											}
										}
									]
								},
								{
									"stmts": [
										{
											"type": "IsDefinedStmt",
											"stmt": {
												"source": 3,
												"file": 0,
												"col": 1,
												"row": 3
											}
										},
										{
											"type": "AssignVarOnceStmt",
											"stmt": {
												"source": {
													"type": "local",
													"value": 3
												},
												"target": 2,
												"file": 0,
												"col": 1,
												"row": 3
											}
										}
									]
								},
								{
									"stmts": [
										{
											"type": "ReturnLocalStmt",
											"stmt": {
												"source": 2,
												"file": 0,
												"col": 1,
												"row": 3
											}
										}
									]
								}
							],
							"path": [
								"g0",
								"test",
								"req"
							]
						},
						{
							"name": "g0.data.test.aws_config",
							"params": [
								0,
								1
							],
							"return": 2,
							"blocks": [
								{
									"stmts": [
										{
											"type": "ResetLocalStmt",
											"stmt": {
												"target": 3,
												"file": 0,
												"col": 1,
												"row": 5
											}
										},
										{
											"type": "MakeObjectStmt",
											"stmt": {
												"target": 4,
												"file": 0,
												"col": 1,
												"row": 5
											}
										},
										{
											"type": "ObjectInsertStmt",
											"stmt": {
												"key": {
													"type": "string_index",
													"value": 5
												},
												"value": {
													"type": "string_index",
													"value": 6
												},
												"object": 4,
												"file": 0,
												"col": 1,
												"row": 5
											}
										},
										{
											"type": "ObjectInsertStmt",
											"stmt": {
												"key": {
													"type": "string_index",
													"value": 7
												},
												"value": {
													"type": "string_index",
													"value": 8
												},
												"object": 4,
												"file": 0,
												"col": 1,
												"row": 5
											}
										},
										{
											"type": "ObjectInsertStmt",
											"stmt": {
												"key": {
													"type": "string_index",
													"value": 9
												},
												"value": {
													"type": "string_index",
													"value": 10
												},
												"object": 4,
												"file": 0,
												"col": 1,
												"row": 5
											}
										},
										{
											"type": "ObjectInsertStmt",
											"stmt": {
												"key": {
													"type": "string_index",
													"value": 11
												},
												"value": {
													"type": "string_index",
													"value": 12
												},
												"object": 4,
												"file": 0,
												"col": 1,
												"row": 5
											}
										},
										{
											"type": "AssignVarOnceStmt",
											"stmt": {
												"source": {
													"type": "local",
													"value": 4
												},
												"target": 3,
												"file": 0,
												"col": 1,
												"row": 5
											}
										}
									]
								},
								{
									"stmts": [
										{
											"type": "IsDefinedStmt",
											"stmt": {
												"source": 3,
												"file": 0,
												"col": 1,
												"row": 5
											}
										},
										{
											"type": "AssignVarOnceStmt",
											"stmt": {
												"source": {
													"type": "local",
													"value": 3
												},
												"target": 2,
												"file": 0,
												"col": 1,
												"row": 5
											}
										}
									]
								},
								{
									"stmts": [
										{
											"type": "ReturnLocalStmt",
											"stmt": {
												"source": 2,
												"file": 0,
												"col": 1,
												"row": 5
											}
										}
									]
								}
							],
							"path": [
								"g0",
								"test",
								"aws_config"
							]
						},
						{
							"name": "g0.data.test.expected",
							"params": [
								0,
								1
							],
							"return": 2,
							"blocks": [
								{
									"stmts": [
										{
											"type": "ResetLocalStmt",
											"stmt": {
												"target": 3,
												"file": 0,
												"col": 1,
												"row": 12
											}
										},
										{
											"type": "MakeObjectStmt",
											"stmt": {
												"target": 4,
												"file": 0,
												"col": 1,
												"row": 12
											}
										},
										{
											"type": "MakeObjectStmt",
											"stmt": {
												"target": 5,
												"file": 0,
												"col": 1,
												"row": 12
											}
										},
										{
											"type": "ObjectInsertStmt",
											"stmt": {
												"key": {
													"type": "string_index",
													"value": 15
												},
												"value": {
													"type": "string_index",
													"value": 16
												},
												"object": 5,
												"file": 0,
												"col": 1,
												"row": 12
											}
										},
										{
											"type": "ObjectInsertStmt",
											"stmt": {
												"key": {
													"type": "string_index",
													"value": 17
												},
												"value": {
													"type": "string_index",
													"value": 18
												},
												"object": 5,
												"file": 0,
												"col": 1,
												"row": 12
											}
										},
										{
											"type": "ObjectInsertStmt",
											"stmt": {
												"key": {
													"type": "string_index",
													"value": 19
												},
												"value": {
													"type": "string_index",
													"value": 20
												},
												"object": 5,
												"file": 0,
												"col": 1,
												"row": 12
											}
										},
										{
											"type": "ObjectInsertStmt",
											"stmt": {
												"key": {
													"type": "string_index",
													"value": 21
												},
												"value": {
													"type": "string_index",
													"value": 22
												},
												"object": 5,
												"file": 0,
												"col": 1,
												"row": 12
											}
										},
										{
											"type": "ObjectInsertStmt",
											"stmt": {
												"key": {
													"type": "string_index",
													"value": 14
												},
												"value": {
													"type": "local",
													"value": 5
												},
												"object": 4,
												"file": 0,
												"col": 1,
												"row": 12
											}
										},
										{
											"type": "ObjectInsertStmt",
											"stmt": {
												"key": {
													"type": "string_index",
													"value": 1
												},
												"value": {
													"type": "string_index",
													"value": 2
												},
												"object": 4,
												"file": 0,
												"col": 1,
												"row": 12
											}
										},
										{
											"type": "ObjectInsertStmt",
											"stmt": {
												"key": {
													"type": "string_index",
													"value": 3
												},
												"value": {
													"type": "string_index",
													"value": 4
												},
												"object": 4,
												"file": 0,
												"col": 1,
												"row": 12
											}
										},
										{
											"type": "AssignVarOnceStmt",
											"stmt": {
												"source": {
													"type": "local",
													"value": 4
												},
												"target": 3,
												"file": 0,
												"col": 1,
												"row": 12
											}
										}
									]
								},
								{
									"stmts": [
										{
											"type": "IsDefinedStmt",
											"stmt": {
												"source": 3,
												"file": 0,
												"col": 1,
												"row": 12
											}
										},
										{
											"type": "AssignVarOnceStmt",
											"stmt": {
												"source": {
													"type": "local",
													"value": 3
												},
												"target": 2,
												"file": 0,
												"col": 1,
												"row": 12
											}
										}
									]
								},
								{
									"stmts": [
										{
											"type": "ReturnLocalStmt",
											"stmt": {
												"source": 2,
												"file": 0,
												"col": 1,
												"row": 12
											}
										}
									]
								}
							],
							"path": [
								"g0",
								"test",
								"expected"
							]
						},
						{
							"name": "g0.data.test.p",
							"params": [
								0,
								1
							],
							"return": 2,
							"blocks": [
								{
									"stmts": [
										{
											"type": "ResetLocalStmt",
											"stmt": {
												"target": 3,
												"file": 0,
												"col": 1,
												"row": 23
											}
										},
										{
											"type": "CallStmt",
											"stmt": {
												"func": "g0.data.test.req",
												"args": [
													{
														"type": "local",
														"value": 0
													},
													{
														"type": "local",
														"value": 1
													}
												],
												"result": 4,
												"file": 0,
												"col": 25,
												"row": 24
											}
										},
										{
											"type": "AssignVarStmt",
											"stmt": {
												"source": {
													"type": "local",
													"value": 4
												},
												"target": 5,
												"file": 0,
												"col": 25,
												"row": 24
											}
										},
										{
											"type": "CallStmt",
											"stmt": {
												"func": "g0.data.test.aws_config",
												"args": [
													{
														"type": "local",
														"value": 0
													},
													{
														"type": "local",
														"value": 1
													}
												],
												"result": 6,
												"file": 0,
												"col": 30,
												"row": 24
											}
										},
										{
											"type": "AssignVarStmt",
											"stmt": {
												"source": {
													"type": "local",
													"value": 6
												},
												"target": 7,
												"file": 0,
												"col": 30,
												"row": 24
											}
										},
										{
											"type": "MakeNumberRefStmt",
											"stmt": {
												"Index": 13,
												"target": 8,
												"file": 0,
												"col": 2,
												"row": 24
											}
										},
										{
											"type": "CallStmt",
											"stmt": {
												"func": "providers.aws.sign_req",
												"args": [
													{
														"type": "local",
														"value": 5
													},
													{
														"type": "local",
														"value": 7
													},
													{
														"type": "local",
														"value": 8
													}
												],
												"result": 9,
												"file": 0,
												"col": 2,
												"row": 24
											}
										},
										{
											"type": "AssignVarStmt",
											"stmt": {
												"source": {
													"type": "local",
													"value": 9
												},
												"target": 10,
												"file": 0,
												"col": 2,
												"row": 24
											}
										},
										{
											"type": "CallStmt",
											"stmt": {
												"func": "g0.data.test.expected",
												"args": [
													{
														"type": "local",
														"value": 0
													},
													{
														"type": "local",
														"value": 1
													}
												],
												"result": 11,
												"file": 0,
												"col": 2,
												"row": 24
											}
										},
										{
											"type": "EqualStmt",
											"stmt": {
												"a": {
													"type": "local",
													"value": 10
												},
												"b": {
													"type": "local",
													"value": 11
												},
												"file": 0,
												"col": 2,
												"row": 24
											}
										},
										{
											"type": "AssignVarOnceStmt",
											"stmt": {
												"source": {
													"type": "bool",
													"value": true
												},
												"target": 3,
												"file": 0,
												"col": 1,
												"row": 23
											}
										}
									]
								},
								{
									"stmts": [
										{
											"type": "IsDefinedStmt",
											"stmt": {
												"source": 3,
												"file": 0,
												"col": 1,
												"row": 23
											}
										},
										{
											"type": "AssignVarOnceStmt",
											"stmt": {
												"source": {
													"type": "local",
													"value": 3
												},
												"target": 2,
												"file": 0,
												"col": 1,
												"row": 23
											}
										}
									]
								},
								{
									"stmts": [
										{
											"type": "ReturnLocalStmt",
											"stmt": {
												"source": 2,
												"file": 0,
												"col": 1,
												"row": 23
											}
										}
									]
								}
							],
							"path": [
								"g0",
								"test",
								"p"
							]
						}
					]
				}
			},
			"want_plan_result": [
				{
					"x": true
				}
			]
		},
		{
			"note": "providers-aws-sign_req/success-simple-with headers no body",
			"query": "data.test.p = x",
			"modules": [
				"package test\n\nreq := {\"method\": \"get\", \"url\": \"http://example.com\", \"headers\": {\"foo\": \"bar\"}}\n\naws_config := {\n\t\"aws_access_key\": \"MYAWSACCESSKEYGOESHERE\",\n\t\"aws_secret_access_key\": \"MYAWSSECRETACCESSKEYGOESHERE\",\n\t\"aws_service\": \"s3\",\n\t\"aws_region\": \"us-east-1\",\n}\n\nexpected := {\n\t\"headers\": {\n\t\t\"Authorization\": \"AWS4-HMAC-SHA256 Credential=MYAWSACCESSKEYGOESHERE/20151228/us-east-1/s3/aws4_request,SignedHeaders=foo;host;x-amz-content-sha256;x-amz-date,Signature=8f1dc7c9b9978356a0d0989fd26a95307f4f8a4aa264d8220647b7097d839952\",\n\t\t\"host\": \"example.com\",\n\t\t\"x-amz-content-sha256\": \"e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855\",\n\t\t\"x-amz-date\": \"20151228T140825Z\",\n\t\t\"foo\": \"bar\",\n\t},\n\t\"method\": \"get\",\n\t\"url\": \"http://example.com\",\n}\n\np if {\n\tproviders.aws.sign_req(req, aws_config, 1451311705000000000) == expected\n}\n"
			],
			"want_result": [
				{
					"x": true
				}
			],
			"entrypoints": [
				"eval"
			],
			"plan": {
				"static": {
					"strings": [
						{
							"value": "x"
						},
						{
							"value": "headers"
						},
						{
							"value": "foo"
						},
						{
							"value": "bar"
						},
						{
							"value": "method"
						},
						{
							"value": "get"
						},
						{
							"value": "url"
						},
						{
							"value": "http://example.com"
						},
						{
							"value": "aws_access_key"
						},
						{
							"value": "MYAWSACCESSKEYGOESHERE"
						},
						{
							"value": "aws_region"
						},
						{
							"value": "us-east-1"
						},
						{
							"value": "aws_secret_access_key"
						},
						{
							"value": "MYAWSSECRETACCESSKEYGOESHERE"
						},
						{
							"value": "aws_service"
						},
						{
							"value": "s3"
						},
						{
							"value": "1451311705000000000"
						},
						{
							"value": "Authorization"
						},
						{
							"value": "AWS4-HMAC-SHA256 Credential=MYAWSACCESSKEYGOESHERE/20151228/us-east-1/s3/aws4_request,SignedHeaders=foo;host;x-amz-content-sha256;x-amz-date,Signature=8f1dc7c9b9978356a0d0989fd26a95307f4f8a4aa264d8220647b7097d839952"
						},
						{
							"value": "host"
						},
						{
							"value": "example.com"
						},
						{
							"value": "x-amz-content-sha256"
						},
						{
							"value": "e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855"
						},
						{
							"value": "x-amz-date"
						},
						{
							"value": "20151228T140825Z"
						}
					],
					"builtin_funcs": [
						{
							"name": "providers.aws.sign_req",
							"decl": {
								"args": [
									{
										"description": "HTTP request object",
										"dynamic": {
											"key": {
												"type": "string"
											},
											"value": {
												"type": "any"
											}
										},
										"name": "request",
										"type": "object"
									},
									{
										"description": "AWS configuration object",
										"dynamic": {
											"key": {
												"type": "string"
											},
											"value": {
												"type": "any"
											}
										},
										"name": "aws_config",
										"type": "object"
									},
									{
										"description": "nanoseconds since the epoch",
										"name": "time_ns",
										"type": "number"
									}
								],
								"result": {
									"description": "HTTP request object with `Authorization` header",
									"dynamic": {
										"key": {
											"type": "any"
										},
										"value": {
											"type": "any"
										}
									},
									"name": "signed_request",
									"type": "object"
								},
								"type": "function"
							}
						}
					],
					"files": [
						{
							"value": "module-0.rego"
						},
						{
							"value": "\u003cquery\u003e"
						}
					]
				},
				"plans": {
					"plans": [
						{
							"name": "eval",
							"blocks": [
								{
									"stmts": [
										{
											"type": "CallStmt",
											"stmt": {
												"func": "g0.data.test.p",
												"args": [
													{
														"type": "local",
														"value": 0
													},
													{
														"type": "local",
														"value": 1
													}
												],
												"result": 2,
												"file": 1,
												"col": 1,
												"row": 1
											}
										},
										{
											"type": "AssignVarStmt",
											"stmt": {
												"source": {
													"type": "local",
													"value": 2
												},
												"target": 3,
												"file": 1,
												"col": 1,
												"row": 1
											}
										},
										{
											"type": "MakeObjectStmt",
											"stmt": {
												"target": 4,
												"file": 1,
												"col": 1,
												"row": 1
											}
										},
										{
											"type": "ObjectInsertStmt",
											"stmt": {
												"key": {
													"type": "string_index",
													"value": 0
												},
												"value": {
													"type": "local",
													"value": 3
												},
												"object": 4,
												"file": 1,
												"col": 1,
												"row": 1
											}
										},
										{
											"type": "ResultSetAddStmt",
											"stmt": {
												"value": 4,
												"file": 1,
												"col": 1,
												"row": 1
											}
										}
									]
								}
							]
						}
					]
				},
				"funcs": {
					"funcs": [
						{
							"name": "g0.data.test.req",
							"params": [
								0,
								1
							],
							"return": 2,
							"blocks": [
								{
									"stmts": [
										{
											"type": "ResetLocalStmt",
											"stmt": {
												"target": 3,
												"file": 0,
												"col": 1,
												"row": 3
											}
										},
										{
											"type": "MakeObjectStmt",
											"stmt": {
												"target": 4,
												"file": 0,
												"col": 1,
												"row": 3
											}
										},
										{
											"type": "MakeObjectStmt",
											"stmt": {
												"target": 5,
												"file": 0,
												"col": 1,
												"row": 3
											}
										},
										{
											"type": "ObjectInsertStmt",
											"stmt": {
												"key": {
													"type": "string_index",
													"value": 2
												},
												"value": {
													"type": "string_index",
													"value": 3
												},
												"object": 5,
												"file": 0,
												"col": 1,
												"row": 3
											}
										},
										{
											"type": "ObjectInsertStmt",
											"stmt": {
												"key": {
													"type": "string_index",
													"value": 1
												},
												"value": {
													"type": "local",
													"value": 5
												},
												"object": 4,
												"file": 0,
												"col": 1,
												"row": 3
											}
										},
										{
											"type": "ObjectInsertStmt",
											"stmt": {
												"key": {
													"type": "string_index",
													"value": 4
												},
												"value": {
													"type": "string_index",
													"value": 5
												},
												"object": 4,
												"file": 0,
												"col": 1,
												"row": 3
											}
										},
										{
											"type": "ObjectInsertStmt",
											"stmt": {
												"key": {
													"type": "string_index",
													"value": 6
												},
												"value": {
													"type": "string_index",
													"value": 7
												},
												"object": 4,
												"file": 0,
												"col": 1,
												"row": 3
											}
										},
										{
											"type": "AssignVarOnceStmt",
											"stmt": {
												"source": {
													"type": "local",
													"value": 4
												},
												"target": 3,
												"file": 0,
												"col": 1,
												"row": 3
											}
										}
									]
								},
								{
									"stmts": [
										{
											"type": "IsDefinedStmt",
											"stmt": {
												"source": 3,
												"file": 0,
												"col": 1,
												"row": 3
											}
										},
										{
											"type": "AssignVarOnceStmt",
											"stmt": {
												"source": {
													"type": "local",
													"value": 3
												},
												"target": 2,
												"file": 0,
												"col": 1,
												"row": 3
											}
										}
									]
								},
								{
									"stmts": [
										{
											"type": "ReturnLocalStmt",
											"stmt": {
												"source": 2,
												"file": 0,
												"col": 1,
												"row": 3
											}
										}
									]
								}
							],
							"path": [
								"g0",
								"test",
								"req"
							]
						},
						{
							"name": "g0.data.test.aws_config",
							"params": [
								0,
								1
							],
							"return": 2,
							"blocks": [
								{
									"stmts": [
										{
											"type": "ResetLocalStmt",
											"stmt": {
												"target": 3,
												"file": 0,
												"col": 1,
												"row": 5
											}
										},
										{
											"type": "MakeObjectStmt",
											"stmt": {
												"target": 4,
												"file": 0,
												"col": 1,
												"row": 5
											}
										},
										{
											"type": "ObjectInsertStmt",
											"stmt": {
												"key": {
													"type": "string_index",
													"value": 8
												},
												"value": {
													"type": "string_index",
													"value": 9
												},
												"object": 4,
												"file": 0,
												"col": 1,
												"row": 5
											}
										},
										{
											"type": "ObjectInsertStmt",
											"stmt": {
												"key": {
													"type": "string_index",
													"value": 10
												},
												"value": {
													"type": "string_index",
													"value": 11
												},
												"object": 4,
												"file": 0,
												"col": 1,
												"row": 5
											}
										},
										{
											"type": "ObjectInsertStmt",
											"stmt": {
												"key": {
													"type": "string_index",
													"value": 12
												},
												"value": {
													"type": "string_index",
													"value": 13
												},
												"object": 4,
												"file": 0,
												"col": 1,
												"row": 5
											}
										},
										{
											"type": "ObjectInsertStmt",
											"stmt": {
												"key": {
													"type": "string_index",
													"value": 14
												},
												"value": {
													"type": "string_index",
													"value": 15
												},
												"object": 4,
												"file": 0,
												"col": 1,
												"row": 5
											}
										},
										{
											"type": "AssignVarOnceStmt",
											"stmt": {
												"source": {
													"type": "local",
													"value": 4
												},
												"target": 3,
												"file": 0,
												"col": 1,
												"row": 5
											}
										}
									]
								},
								{
									"stmts": [
										{
											"type": "IsDefinedStmt",
											"stmt": {
												"source": 3,
												"file": 0,
												"col": 1,
												"row": 5
											}
										},
										{
											"type": "AssignVarOnceStmt",
											"stmt": {
												"source": {
													"type": "local",
													"value": 3
												},
												"target": 2,
												"file": 0,
												"col": 1,
												"row": 5
											}
										}
									]
								},
								{
									"stmts": [
										{
											"type": "ReturnLocalStmt",
											"stmt": {
												"source": 2,
												"file": 0,
												"col": 1,
												"row": 5
											}
										}
									]
								}
							],
							"path": [
								"g0",
								"test",
								"aws_config"
							]
						},
						{
							"name": "g0.data.test.expected",
							"params": [
								0,
								1
							],
							"return": 2,
							"blocks": [
								{
									"stmts": [
										{
											"type": "ResetLocalStmt",
											"stmt": {
												"target": 3,
												"file": 0,
												"col": 1,
												"row": 12
											}
										},
										{
											"type": "MakeObjectStmt",
											"stmt": {
												"target": 4,
												"file": 0,
												"col": 1,
												"row": 12
											}
										},
										{
											"type": "MakeObjectStmt",
											"stmt": {
												"target": 5,
												"file": 0,
												"col": 1,
												"row": 12
											}
										},
										{
											"type": "ObjectInsertStmt",
											"stmt": {
												"key": {
													"type": "string_index",
													"value": 17
												},
												"value": {
													"type": "string_index",
													"value": 18
												},
												"object": 5,
												"file": 0,
												"col": 1,
												"row": 12
											}
										},
										{
											"type": "ObjectInsertStmt",
											"stmt": {
												"key": {
													"type": "string_index",
													"value": 2
												},
												"value": {
													"type": "string_index",
													"value": 3
												},
												"object": 5,
												"file": 0,
												"col": 1,
												"row": 12
											}
										},
										{
											"type": "ObjectInsertStmt",
											"stmt": {
												"key": {
													"type": "string_index",
													"value": 19
												},
												"value": {
													"type": "string_index",
													"value": 20
												},
												"object": 5,
												"file": 0,
												"col": 1,
												"row": 12
											}
										},
										{
											"type": "ObjectInsertStmt",
											"stmt": {
												"key": {
													"type": "string_index",
													"value": 21
												},
												"value": {
													"type": "string_index",
													"value": 22
												},
												"object": 5,
												"file": 0,
												"col": 1,
												"row": 12
											}
										},
										{
											"type": "ObjectInsertStmt",
											"stmt": {
												"key": {
													"type": "string_index",
													"value": 23
												},
												"value": {
													"type": "string_index",
													"value": 24
												},
												"object": 5,
												"file": 0,
												"col": 1,
												"row": 12
											}
										},
										{
											"type": "ObjectInsertStmt",
											"stmt": {
												"key": {
													"type": "string_index",
													"value": 1
												},
												"value": {
													"type": "local",
													"value": 5
												},
												"object": 4,
												"file": 0,
												"col": 1,
												"row": 12
											}
										},
										{
											"type": "ObjectInsertStmt",
											"stmt": {
												"key": {
													"type": "string_index",
													"value": 4
												},
												"value": {
													"type": "string_index",
													"value": 5
												},
												"object": 4,
												"file": 0,
												"col": 1,
												"row": 12
											}
										},
										{
											"type": "ObjectInsertStmt",
											"stmt": {
												"key": {
													"type": "string_index",
													"value": 6
												},
												"value": {
													"type": "string_index",
													"value": 7
												},
												"object": 4,
												"file": 0,
												"col": 1,
												"row": 12
											}
										},
										{
											"type": "AssignVarOnceStmt",
											"stmt": {
												"source": {
													"type": "local",
													"value": 4
												},
												"target": 3,
												"file": 0,
												"col": 1,
												"row": 12
											}
										}
									]
								},
								{
									"stmts": [
										{
											"type": "IsDefinedStmt",
											"stmt": {
												"source": 3,
												"file": 0,
												"col": 1,
												"row": 12
											}
										},
										{
											"type": "AssignVarOnceStmt",
											"stmt": {
												"source": {
													"type": "local",
													"value": 3
												},
												"target": 2,
												"file": 0,
												"col": 1,
												"row": 12
											}
										}
									]
								},
								{
									"stmts": [
										{
											"type": "ReturnLocalStmt",
											"stmt": {
												"source": 2,
												"file": 0,
												"col": 1,
												"row": 12
											}
										}
									]
								}
							],
							"path": [
								"g0",
								"test",
								"expected"
							]
						},
						{
							"name": "g0.data.test.p",
							"params": [
								0,
								1
							],
							"return": 2,
							"blocks": [
								{
									"stmts": [
										{
											"type": "ResetLocalStmt",
											"stmt": {
												"target": 3,
												"file": 0,
												"col": 1,
												"row": 24
											}
										},
										{
											"type": "CallStmt",
											"stmt": {
												"func": "g0.data.test.req",
												"args": [
													{
														"type": "local",
														"value": 0
													},
													{
														"type": "local",
														"value": 1
													}
												],
												"result": 4,
												"file": 0,
												"col": 25,
												"row": 25
											}
										},
										{
											"type": "AssignVarStmt",
											"stmt": {
												"source": {
													"type": "local",
													"value": 4
												},
												"target": 5,
												"file": 0,
												"col": 25,
												"row": 25
											}
										},
										{
											"type": "CallStmt",
											"stmt": {
												"func": "g0.data.test.aws_config",
												"args": [
													{
														"type": "local",
														"value": 0
													},
													{
														"type": "local",
														"value": 1
													}
												],
												"result": 6,
												"file": 0,
												"col": 30,
												"row": 25
											}
										},
										{
											"type": "AssignVarStmt",
											"stmt": {
												"source": {
													"type": "local",
													"value": 6
												},
												"target": 7,
												"file": 0,
												"col": 30,
												"row": 25
											}
										},
										{
											"type": "MakeNumberRefStmt",
											"stmt": {
												"Index": 16,
												"target": 8,
												"file": 0,
												"col": 2,
												"row": 25
											}
										},
										{
											"type": "CallStmt",
											"stmt": {
												"func": "providers.aws.sign_req",
												"args": [
													{
														"type": "local",
														"value": 5
													},
													{
														"type": "local",
														"value": 7
													},
													{
														"type": "local",
														"value": 8
													}
												],
												"result": 9,
												"file": 0,
												"col": 2,
												"row": 25
											}
										},
										{
											"type": "AssignVarStmt",
											"stmt": {
												"source": {
													"type": "local",
													"value": 9
												},
												"target": 10,
												"file": 0,
												"col": 2,
												"row": 25
											}
										},
										{
											"type": "CallStmt",
											"stmt": {
												"func": "g0.data.test.expected",
												"args": [
													{
														"type": "local",
														"value": 0
													},
													{
														"type": "local",
														"value": 1
													}
												],
												"result": 11,
												"file": 0,
												"col": 2,
												"row": 25
											}
										},
										{
											"type": "EqualStmt",
											"stmt": {
												"a": {
													"type": "local",
													"value": 10
												},
												"b": {
													"type": "local",
													"value": 11
												},
												"file": 0,
												"col": 2,
												"row": 25
											}
										},
										{
											"type": "AssignVarOnceStmt",
											"stmt": {
												"source": {
													"type": "bool",
													"value": true
												},
												"target": 3,
												"file": 0,
												"col": 1,
												"row": 24
											}
										}
									]
								},
								{
									"stmts": [
										{
											"type": "IsDefinedStmt",
											"stmt": {
												"source": 3,
												"file": 0,
												"col": 1,
												"row": 24
											}
										},
										{
											"type": "AssignVarOnceStmt",
											"stmt": {
												"source": {
													"type": "local",
													"value": 3
												},
												"target": 2,
												"file": 0,
												"col": 1,
												"row": 24
											}
										}
									]
								},
								{
									"stmts": [
										{
											"type": "ReturnLocalStmt",
											"stmt": {
												"source": 2,
												"file": 0,
												"col": 1,
												"row": 24
											}
										}
									]
								}
							],
							"path": [
								"g0",
								"test",
								"p"
							]
						}
					]
				}
			},
			"want_plan_result": [
				{
					"x": true
				}
			]
		},
		{
			"note": "providers-aws-sign_req/success-simple-no body-with session token",
			"query": "data.test.p = x",
			"modules": [
				"package test\n\nreq := {\"method\": \"get\", \"url\": \"http://example.com\"}\n\naws_config := {\n\t\"aws_access_key\": \"MYAWSACCESSKEYGOESHERE\",\n\t\"aws_secret_access_key\": \"MYAWSSECRETACCESSKEYGOESHERE\",\n\t\"aws_session_token\": \"MYAWSSECURITYTOKENGOESHERE\",\n\t\"aws_service\": \"s3\",\n\t\"aws_region\": \"us-east-1\",\n}\n\nexpected := {\n\t\"headers\": {\n\t\t\"Authorization\": \"AWS4-HMAC-SHA256 Credential=MYAWSACCESSKEYGOESHERE/20151228/us-east-1/s3/aws4_request,SignedHeaders=host;x-amz-content-sha256;x-amz-date;x-amz-security-token,Signature=23c31bda8a74630c0a94f6b82a3511e7e74728df98e6f54ed0840488dbbdc8d1\",\n\t\t\"host\": \"example.com\",\n\t\t\"x-amz-content-sha256\": \"e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855\",\n\t\t\"x-amz-date\": \"20151228T140825Z\",\n\t\t\"x-amz-security-token\": \"MYAWSSECURITYTOKENGOESHERE\",\n\t},\n\t\"method\": \"get\",\n\t\"url\": \"http://example.com\",\n}\n\np if {\n\tproviders.aws.sign_req(req, aws_config, 1451311705000000000) == expected\n}\n"
			],
			"want_result": [
				{
					"x": true
				}
			],
			"entrypoints": [
				"eval"
			],
			"plan": {
				"static": {
					"strings": [
						{
							"value": "x"
						},
						{
							"value": "method"
						},
						{
							"value": "get"
						},
						{
							"value": "url"
						},
						{
							"value": "http://example.com"
						},
						{
							"value": "aws_access_key"
						},
						{
							"value": "MYAWSACCESSKEYGOESHERE"
						},
						{
							"value": "aws_region"
						},
						{
							"value": "us-east-1"
						},
						{
							"value": "aws_secret_access_key"
						},
						{
							"value": "MYAWSSECRETACCESSKEYGOESHERE"
						},
						{
							"value": "aws_service"
						},
						{
							"value": "s3"
						},
						{
							"value": "aws_session_token"
						},
						{
							"value": "MYAWSSECURITYTOKENGOESHERE"
						},
						{
							"value": "1451311705000000000"
						},
						{
							"value": "headers"
						},
						{
							"value": "Authorization"
						},
						{
							"value": "AWS4-HMAC-SHA256 Credential=MYAWSACCESSKEYGOESHERE/20151228/us-east-1/s3/aws4_request,SignedHeaders=host;x-amz-content-sha256;x-amz-date;x-amz-security-token,Signature=23c31bda8a74630c0a94f6b82a3511e7e74728df98e6f54ed0840488dbbdc8d1"
						},
						{
							"value": "host"
						},
						{
							"value": "example.com"
						},
						{
							"value": "x-amz-content-sha256"
						},
						{
							"value": "e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855"
						},
						{
							"value": "x-amz-date"
						},
						{
							"value": "20151228T140825Z"
						},
						{
							"value": "x-amz-security-token"
						}
					],
					"builtin_funcs": [
						{
							"name": "providers.aws.sign_req",
							"decl": {
								"args": [
									{
										"description": "HTTP request object",
										"dynamic": {
											"key": {
												"type": "string"
											},
											"value": {
												"type": "any"
											}
										},
										"name": "request",
										"type": "object"
									},
									{
										"description": "AWS configuration object",
										"dynamic": {
											"key": {
												"type": "string"
											},
											"value": {
												"type": "any"
											}
										},
										"name": "aws_config",
										"type": "object"
									},
									{
										"description": "nanoseconds since the epoch",
										"name": "time_ns",
										"type": "number"
									}
								],
								"result": {
									"description": "HTTP request object with `Authorization` header",
									"dynamic": {
										"key": {
											"type": "any"
										},
										"value": {
											"type": "any"
										}
									},
									"name": "signed_request",
									"type": "object"
								},
								"type": "function"
							}
						}
					],
					"files": [
						{
							"value": "module-0.rego"
						},
						{
							"value": "\u003cquery\u003e"
						}
					]
				},
				"plans": {
					"plans": [
						{
							"name": "eval",
							"blocks": [
								{
									"stmts": [
										{
											"type": "CallStmt",
											"stmt": {
												"func": "g0.data.test.p",
												"args": [
													{
														"type": "local",
														"value": 0
													},
													{
														"type": "local",
														"value": 1
													}
												],
												"result": 2,
												"file": 1,
												"col": 1,
												"row": 1
											}
										},
										{
											"type": "AssignVarStmt",
											"stmt": {
												"source": {
													"type": "local",
													"value": 2
												},
												"target": 3,
												"file": 1,
												"col": 1,
												"row": 1
											}
										},
										{
											"type": "MakeObjectStmt",
											"stmt": {
												"target": 4,
												"file": 1,
												"col": 1,
												"row": 1
											}
										},
										{
											"type": "ObjectInsertStmt",
											"stmt": {
												"key": {
													"type": "string_index",
													"value": 0
												},
												"value": {
													"type": "local",
													"value": 3
												},
												"object": 4,
												"file": 1,
												"col": 1,
												"row": 1
											}
										},
										{
											"type": "ResultSetAddStmt",
											"stmt": {
												"value": 4,
												"file": 1,
												"col": 1,
												"row": 1
											}
										}
									]
								}
							]
						}
					]
				},
				"funcs": {
					"funcs": [
						{
							"name": "g0.data.test.req",
							"params": [
								0,
								1
							],
							"return": 2,
							"blocks": [
								{
									"stmts": [
										{
											"type": "ResetLocalStmt",
											"stmt": {
												"target": 3,
												"file": 0,
												"col": 1,
												"row": 3
											}
										},
										{
											"type": "MakeObjectStmt",
											"stmt": {
												"target": 4,
												"file": 0,
												"col": 1,
												"row": 3
											}
										},
										{
											"type": "ObjectInsertStmt",
											"stmt": {
												"key": {
													"type": "string_index",
													"value": 1
												},
												"value": {
													"type": "string_index",
													"value": 2
												},
												"object": 4,
												"file": 0,
												"col": 1,
												"row": 3
											}
										},
										{
											"type": "ObjectInsertStmt",
											"stmt": {
												"key": {
													"type": "string_index",
													"value": 3
												},
												"value": {
													"type": "string_index",
													"value": 4
												},
												"object": 4,
												"file": 0,
												"col": 1,
												"row": 3
											}
										},
										{
											"type": "AssignVarOnceStmt",
											"stmt": {
												"source": {
													"type": "local",
													"value": 4
												},
												"target": 3,
												"file": 0,
												"col": 1,
												"row": 3
											}
										}
									]
								},
								{
									"stmts": [
										{
											"type": "IsDefinedStmt",
											"stmt": {
												"source": 3,
												"file": 0,
												"col": 1,
												"row": 3
											}
										},
										{
											"type": "AssignVarOnceStmt",
											"stmt": {
												"source": {
													"type": "local",
													"value": 3
												},
												"target": 2,
												"file": 0,
												"col": 1,
												"row": 3
											}
										}
									]
								},
								{
									"stmts": [
										{
											"type": "ReturnLocalStmt",
											"stmt": {
												"source": 2,
												"file": 0,
												"col": 1,
												"row": 3
											}
										}
									]
								}
							],
							"path": [
								"g0",
								"test",
								"req"
							]
						},
						{
							"name": "g0.data.test.aws_config",
							"params": [
								0,
								1
							],
							"return": 2,
							"blocks": [
								{
									"stmts": [
										{
											"type": "ResetLocalStmt",
											"stmt": {
												"target": 3,
												"file": 0,
												"col": 1,
												"row": 5
											}
										},
										{
											"type": "MakeObjectStmt",
											"stmt": {
												"target": 4,
												"file": 0,
												"col": 1,
												"row": 5
											}
										},
										{
											"type": "ObjectInsertStmt",
											"stmt": {
												"key": {
													"type": "string_index",
													"value": 5
												},
												"value": {
													"type": "string_index",
													"value": 6
												},
												"object": 4,
												"file": 0,
												"col": 1,
												"row": 5
											}
										},
										{
											"type": "ObjectInsertStmt",
											"stmt": {
												"key": {
													"type": "string_index",
													"value": 7
												},
												"value": {
													"type": "string_index",
													"value": 8
												},
												"object": 4,
												"file": 0,
												"col": 1,
												"row": 5
											}
										},
										{
											"type": "ObjectInsertStmt",
											"stmt": {
												"key": {
													"type": "string_index",
													"value": 9
												},
												"value": {
													"type": "string_index",
													"value": 10
												},
												"object": 4,
												"file": 0,
												"col": 1,
												"row": 5
											}
										},
										{
											"type": "ObjectInsertStmt",
											"stmt": {
												"key": {
													"type": "string_index",
													"value": 11
												},
												"value": {
													"type": "string_index",
													"value": 12
												},
												"object": 4,
												"file": 0,
												"col": 1,
												"row": 5
											}
										},
										{
											"type": "ObjectInsertStmt",
											"stmt": {
												"key": {
													"type": "string_index",
													"value": 13
												},
												"value": {
													"type": "string_index",
													"value": 14
												},
												"object": 4,
												"file": 0,
												"col": 1,
												"row": 5
											}
										},
										{
											"type": "AssignVarOnceStmt",
											"stmt": {
												"source": {
													"type": "local",
													"value": 4
												},
												"target": 3,
												"file": 0,
												"col": 1,
												"row": 5
											}
										}
									]
								},
								{
									"stmts": [
										{
											"type": "IsDefinedStmt",
											"stmt": {
												"source": 3,
												"file": 0,
												"col": 1,
												"row": 5
											}
										},
										{
											"type": "AssignVarOnceStmt",
											"stmt": {
												"source": {
													"type": "local",
													"value": 3
												},
												"target": 2,
												"file": 0,
												"col": 1,
												"row": 5
											}
										}
									]
								},
								{
									"stmts": [
										{
											"type": "ReturnLocalStmt",
											"stmt": {
												"source": 2,
												"file": 0,
												"col": 1,
												"row": 5
											}
										}
									]
								}
							],
							"path": [
								"g0",
								"test",
								"aws_config"
							]
						},
						{
							"name": "g0.data.test.expected",
							"params": [
								0,
								1
							],
							"return": 2,
							"blocks": [
								{
									"stmts": [
										{
											"type": "ResetLocalStmt",
											"stmt": {
												"target": 3,
												"file": 0,
												"col": 1,
												"row": 13
											}
										},
										{
											"type": "MakeObjectStmt",
											"stmt": {
												"target": 4,
												"file": 0,
												"col": 1,
												"row": 13
											}
										},
										{
											"type": "MakeObjectStmt",
											"stmt": {
												"target": 5,
												"file": 0,
												"col": 1,
												"row": 13
											}
										},
										{
											"type": "ObjectInsertStmt",
											"stmt": {
												"key": {
													"type": "string_index",
													"value": 17
												},
												"value": {
													"type": "string_index",
													"value": 18
												},
												"object": 5,
												"file": 0,
												"col": 1,
												"row": 13
											}
										},
										{
											"type": "ObjectInsertStmt",
											"stmt": {
												"key": {
													"type": "string_index",
													"value": 19
												},
												"value": {
													"type": "string_index",
													"value": 20
												},
												"object": 5,
												"file": 0,
												"col": 1,
												"row": 13
											}
										},
										{
											"type": "ObjectInsertStmt",
											"stmt": {
												"key": {
													"type": "string_index",
													"value": 21
												},
												"value": {
													"type": "string_index",
													"value": 22
												},
												"object": 5,
												"file": 0,
												"col": 1,
												"row": 13
											}
										},
										{
											"type": "ObjectInsertStmt",
											"stmt": {
												"key": {
													"type": "string_index",
													"value": 23
												},
												"value": {
													"type": "string_index",
													"value": 24
												},
												"object": 5,
												"file": 0,
												"col": 1,
												"row": 13
											}
										},
										{
											"type": "ObjectInsertStmt",
											"stmt": {
												"key": {
													"type": "string_index",
													"value": 25
												},
												"value": {
													"type": "string_index",
													"value": 14
												},
												"object": 5,
												"file": 0,
												"col": 1,
												"row": 13
											}
										},
										{
											"type": "ObjectInsertStmt",
											"stmt": {
												"key": {
													"type": "string_index",
													"value": 16
												},
												"value": {
													"type": "local",
													"value": 5
												},
												"object": 4,
												"file": 0,
												"col": 1,
												"row": 13
											}
										},
										{
											"type": "ObjectInsertStmt",
											"stmt": {
												"key": {
													"type": "string_index",
													"value": 1
												},
												"value": {
													"type": "string_index",
													"value": 2
												},
												"object": 4,
												"file": 0,
												"col": 1,
												"row": 13
											}
										},
										{
											"type": "ObjectInsertStmt",
											"stmt": {
												"key": {
													"type": "string_index",
													"value": 3
												},
												"value": {
													"type": "string_index",
													"value": 4
												},
												"object": 4,
												"file": 0,
												"col": 1,
												"row": 13
											}
										},
										{
											"type": "AssignVarOnceStmt",
											"stmt": {
												"source": {
													"type": "local",
													"value": 4
												},
												"target": 3,
												"file": 0,
												"col": 1,
												"row": 13
											}
										}
									]
								},
								{
									"stmts": [
										{
											"type": "IsDefinedStmt",
											"stmt": {
												"source": 3,
												"file": 0,
												"col": 1,
												"row": 13
											}
										},
										{
											"type": "AssignVarOnceStmt",
											"stmt": {
												"source": {
													"type": "local",
													"value": 3
												},
												"target": 2,
												"file": 0,
												"col": 1,
												"row": 13
											}
										}
									]
								},
								{
									"stmts": [
										{
											"type": "ReturnLocalStmt",
											"stmt": {
												"source": 2,
												"file": 0,
												"col": 1,
												"row": 13
											}
										}
									]
								}
							],
							"path": [
								"g0",
								"test",
								"expected"
							]
						},
						{
							"name": "g0.data.test.p",
							"params": [
								0,
								1
							],
							"return": 2,
							"blocks": [
								{
									"stmts": [
										{
											"type": "ResetLocalStmt",
											"stmt": {
												"target": 3,
												"file": 0,
												"col": 1,
												"row": 25
											}
										},
										{
											"type": "CallStmt",
											"stmt": {
												"func": "g0.data.test.req",
												"args": [
													{
														"type": "local",
														"value": 0
													},
													{
														"type": "local",
														"value": 1
													}
												],
												"result": 4,
												"file": 0,
												"col": 25,
												"row": 26
											}
										},
										{
											"type": "AssignVarStmt",
											"stmt": {
												"source": {
													"type": "local",
													"value": 4
												},
												"target": 5,
												"file": 0,
												"col": 25,
												"row": 26
											}
										},
										{
											"type": "CallStmt",
											"stmt": {
												"func": "g0.data.test.aws_config",
												"args": [
													{
														"type": "local",
														"value": 0
													},
													{
														"type": "local",
														"value": 1
													}
												],
												"result": 6,
												"file": 0,
												"col": 30,
												"row": 26
											}
										},
										{
											"type": "AssignVarStmt",
											"stmt": {
												"source": {
													"type": "local",
													"value": 6
												},
												"target": 7,
												"file": 0,
												"col": 30,
												"row": 26
											}
										},
										{
											"type": "MakeNumberRefStmt",
											"stmt": {
												"Index": 15,
												"target": 8,
												"file": 0,
												"col": 2,
												"row": 26
											}
										},
										{
											"type": "CallStmt",
											"stmt": {
												"func": "providers.aws.sign_req",
												"args": [
													{
														"type": "local",
														"value": 5
													},
													{
														"type": "local",
														"value": 7
													},
													{
														"type": "local",
														"value": 8
													}
												],
												"result": 9,
												"file": 0,
												"col": 2,
												"row": 26
											}
										},
										{
											"type": "AssignVarStmt",
											"stmt": {
												"source": {
													"type": "local",
													"value": 9
												},
												"target": 10,
												"file": 0,
												"col": 2,
												"row": 26
											}
										},
										{
											"type": "CallStmt",
											"stmt": {
												"func": "g0.data.test.expected",
												"args": [
													{
														"type": "local",
														"value": 0
													},
													{
														"type": "local",
														"value": 1
													}
												],
												"result": 11,
												"file": 0,
												"col": 2,
												"row": 26
											}
										},
										{
											"type": "EqualStmt",
											"stmt": {
												"a": {
													"type": "local",
													"value": 10
												},
												"b": {
													"type": "local",
													"value": 11
												},
												"file": 0,
												"col": 2,
												"row": 26
											}
										},
										{
											"type": "AssignVarOnceStmt",
											"stmt": {
												"source": {
													"type": "bool",
													"value": true
												},
												"target": 3,
												"file": 0,
												"col": 1,
												"row": 25
											}
										}
									]
								},
								{
									"stmts": [
										{
											"type": "IsDefinedStmt",
											"stmt": {
												"source": 3,
												"file": 0,
												"col": 1,
												"row": 25
											}
										},
										{
											"type": "AssignVarOnceStmt",
											"stmt": {
												"source": {
													"type": "local",
													"value": 3
												},
												"target": 2,
												"file": 0,
												"col": 1,
												"row": 25
											}
										}
									]
								},
								{
									"stmts": [
										{
											"type": "ReturnLocalStmt",
											"stmt": {
												"source": 2,
												"file": 0,
												"col": 1,
												"row": 25
											}
										}
									]
								}
							],
							"path": [
								"g0",
								"test",
								"p"
							]
						}
					]
				}
			},
			"want_plan_result": [
				{
					"x": true
				}
			]
		},
		{
			"note": "providers-aws-sign_req/success-simple-body",
			"query": "data.test.p = x",
			"modules": [
				"package test\n\nreq := {\"method\": \"get\", \"url\": \"http://example.com\", \"body\": {\"example\": {1, 2, 3, 4}}}\n\naws_config := {\"aws_access_key\": \"MYAWSACCESSKEYGOESHERE\", \"aws_secret_access_key\": \"MYAWSSECRETACCESSKEYGOESHERE\", \"aws_service\": \"s3\", \"aws_region\": \"us-east-1\"}\n\nexpected := {\n\t\"body\": {\"example\": {1, 2, 3, 4}},\n\t\"headers\": {\n\t\t\"Authorization\": \"AWS4-HMAC-SHA256 Credential=MYAWSACCESSKEYGOESHERE/20151228/us-east-1/s3/aws4_request,SignedHeaders=host;x-amz-content-sha256;x-amz-date,Signature=5fb06ab1cfd74c8fcb3af95b8cce696708cf6155d971dac10f254d79799c6e88\",\n\t\t\"host\": \"example.com\",\n\t\t\"x-amz-content-sha256\": \"bacff6243c850423883052ac3c336fd645994442933408dfd3f9e858e69bda07\",\n\t\t\"x-amz-date\": \"20151228T140825Z\",\n\t},\n\t\"method\": \"get\",\n\t\"url\": \"http://example.com\",\n}\n\np if {\n\tproviders.aws.sign_req(req, aws_config, 1451311705000000000) == expected\n}\n"
			],
			"want_result": [
				{
					"x": true
				}
			],
			"entrypoints": [
				"eval"
			],
			"plan": {
				"static": {
					"strings": [
						{
							"value": "x"
						},
						{
							"value": "body"
						},
						{
							"value": "example"
						},
						{
							"value": "1"
						},
						{
							"value": "2"
						},
						{
							"value": "3"
						},
						{
							"value": "4"
						},
						{
							"value": "method"
						},
						{
							"value": "get"
						},
						{
							"value": "url"
						},
						{
							"value": "http://example.com"
						},
						{
							"value": "aws_access_key"
						},
						{
							"value": "MYAWSACCESSKEYGOESHERE"
						},
						{
							"value": "aws_region"
						},
						{
							"value": "us-east-1"
						},
						{
							"value": "aws_secret_access_key"
						},
						{
							"value": "MYAWSSECRETACCESSKEYGOESHERE"
						},
						{
							"value": "aws_service"
						},
						{
							"value": "s3"
						},
						{
							"value": "1451311705000000000"
						},
						{
							"value": "headers"
						},
						{
							"value": "Authorization"
						},
						{
							"value": "AWS4-HMAC-SHA256 Credential=MYAWSACCESSKEYGOESHERE/20151228/us-east-1/s3/aws4_request,SignedHeaders=host;x-amz-content-sha256;x-amz-date,Signature=5fb06ab1cfd74c8fcb3af95b8cce696708cf6155d971dac10f254d79799c6e88"
						},
						{
							"value": "host"
						},
						{
							"value": "example.com"
						},
						{
							"value": "x-amz-content-sha256"
						},
						{
							"value": "bacff6243c850423883052ac3c336fd645994442933408dfd3f9e858e69bda07"
						},
						{
							"value": "x-amz-date"
						},
						{
							"value": "20151228T140825Z"
						}
					],
					"builtin_funcs": [
						{
							"name": "providers.aws.sign_req",
							"decl": {
								"args": [
									{
										"description": "HTTP request object",
										"dynamic": {
											"key": {
												"type": "string"
											},
											"value": {
												"type": "any"
											}
										},
										"name": "request",
										"type": "object"
									},
									{
										"description": "AWS configuration object",
										"dynamic": {
											"key": {
												"type": "string"
											},
											"value": {
												"type": "any"
											}
										},
										"name": "aws_config",
										"type": "object"
									},
									{
										"description": "nanoseconds since the epoch",
										"name": "time_ns",
										"type": "number"
									}
								],
								"result": {
									"description": "HTTP request object with `Authorization` header",
									"dynamic": {
										"key": {
											"type": "any"
										},
										"value": {
											"type": "any"
										}
									},
									"name": "signed_request",
									"type": "object"
								},
								"type": "function"
							}
						}
					],
					"files": [
						{
							"value": "module-0.rego"
						},
						{
							"value": "\u003cquery\u003e"
						}
					]
				},
				"plans": {
					"plans": [
						{
							"name": "eval",
							"blocks": [
								{
									"stmts": [
										{
											"type": "CallStmt",
											"stmt": {
												"func": "g0.data.test.p",
												"args": [
													{
														"type": "local",
														"value": 0
													},
													{
														"type": "local",
														"value": 1
													}
												],
												"result": 2,
												"file": 1,
												"col": 1,
												"row": 1
											}
										},
										{
											"type": "AssignVarStmt",
											"stmt": {
												"source": {
													"type": "local",
													"value": 2
												},
												"target": 3,
												"file": 1,
												"col": 1,
												"row": 1
											}
										},
										{
											"type": "MakeObjectStmt",
											"stmt": {
												"target": 4,
												"file": 1,
												"col": 1,
												"row": 1
											}
										},
										{
											"type": "ObjectInsertStmt",
											"stmt": {
												"key": {
													"type": "string_index",
													"value": 0
												},
												"value": {
													"type": "local",
													"value": 3
												},
												"object": 4,
												"file": 1,
												"col": 1,
												"row": 1
											}
										},
										{
											"type": "ResultSetAddStmt",
											"stmt": {
												"value": 4,
												"file": 1,
												"col": 1,
												"row": 1
											}
										}
									]
								}
							]
						}
					]
				},
				"funcs": {
					"funcs": [
						{
							"name": "g0.data.test.req",
							"params": [
								0,
								1
							],
							"return": 2,
							"blocks": [
								{
									"stmts": [
										{
											"type": "ResetLocalStmt",
											"stmt": {
												"target": 3,
												"file": 0,
												"col": 1,
												"row": 3
											}
										},
										{
											"type": "MakeObjectStmt",
											"stmt": {
												"target": 4,
												"file": 0,
												"col": 1,
												"row": 3
											}
										},
										{
											"type": "MakeObjectStmt",
											"stmt": {
												"target": 5,
												"file": 0,
												"col": 1,
												"row": 3
											}
										},
										{
											"type": "MakeSetStmt",
											"stmt": {
												"target": 6,
												"file": 0,
												"col": 1,
												"row": 3
											}
										},
										{
											"type": "MakeNumberRefStmt",
											"stmt": {
												"Index": 3,
												"target": 7,
												"file": 0,
												"col": 1,
												"row": 3
											}
										},
										{
											"type": "SetAddStmt",
											"stmt": {
												"value": {
													"type": "local",
													"value": 7
												},
												"set": 6,
												"file": 0,
												"col": 1,
												"row": 3
											}
										},
										{
											"type": "MakeNumberRefStmt",
											"stmt": {
												"Index": 4,
												"target": 8,
												"file": 0,
												"col": 1,
												"row": 3
											}
										},
										{
											"type": "SetAddStmt",
											"stmt": {
												"value": {
													"type": "local",
													"value": 8
												},
												"set": 6,
												"file": 0,
												"col": 1,
												"row": 3
											}
										},
										{
											"type": "MakeNumberRefStmt",
											"stmt": {
												"Index": 5,
												"target": 9,
												"file": 0,
												"col": 1,
												"row": 3
											}
										},
										{
											"type": "SetAddStmt",
											"stmt": {
												"value": {
													"type": "local",
													"value": 9
												},
												"set": 6,
												"file": 0,
												"col": 1,
												"row": 3
											}
										},
										{
											"type": "MakeNumberRefStmt",
											"stmt": {
												"Index": 6,
												"target": 10,
												"file": 0,
												"col": 1,
												"row": 3
											}
										},
										{
											"type": "SetAddStmt",
											"stmt": {
												"value": {
													"type": "local",
													"value": 10
												},
												"set": 6,
												"file": 0,
												"col": 1,
												"row": 3
											}
										},
										{
											"type": "ObjectInsertStmt",
											"stmt": {
												"key": {
													"type": "string_index",
													"value": 2
												},
												"value": {
													"type": "local",
													"value": 6
												},
												"object": 5,
												"file": 0,
												"col": 1,
												"row": 3
											}
										},
										{
											"type": "ObjectInsertStmt",
											"stmt": {
												"key": {
													"type": "string_index",
													"value": 1
												},
												"value": {
													"type": "local",
													"value": 5
												},
												"object": 4,
												"file": 0,
												"col": 1,
												"row": 3
											}
										},
										{
											"type": "ObjectInsertStmt",
											"stmt": {
												"key": {
													"type": "string_index",
													"value": 7
												},
												"value": {
													"type": "string_index",
													"value": 8
												},
												"object": 4,
												"file": 0,
												"col": 1,
												"row": 3
											}
										},
										{
											"type": "ObjectInsertStmt",
											"stmt": {
												"key": {
													"type": "string_index",
													"value": 9
												},
												"value": {
													"type": "string_index",
													"value": 10
												},
												"object": 4,
												"file": 0,
												"col": 1,
												"row": 3
											}
										},
										{
											"type": "AssignVarOnceStmt",
											"stmt": {
												"source": {
													"type": "local",
													"value": 4
												},
												"target": 3,
												"file": 0,
												"col": 1,
												"row": 3
											}
										}
									]
								},
								{
									"stmts": [
										{
											"type": "IsDefinedStmt",
											"stmt": {
												"source": 3,
												"file": 0,
												"col": 1,
												"row": 3
											}
										},
										{
											"type": "AssignVarOnceStmt",
											"stmt": {
												"source": {
													"type": "local",
													"value": 3
												},
												"target": 2,
												"file": 0,
												"col": 1,
												"row": 3
											}
										}
									]
								},
								{
									"stmts": [
										{
											"type": "ReturnLocalStmt",
											"stmt": {
												"source": 2,
												"file": 0,
												"col": 1,
												"row": 3
											}
										}
									]
								}
							],
							"path": [
								"g0",
								"test",
								"req"
							]
						},
						{
							"name": "g0.data.test.aws_config",
							"params": [
								0,
								1
							],
							"return": 2,
							"blocks": [
								{
									"stmts": [
										{
											"type": "ResetLocalStmt",
											"stmt": {
												"target": 3,
												"file": 0,
												"col": 1,
												"row": 5
											}
										},
										{
											"type": "MakeObjectStmt",
											"stmt": {
												"target": 4,
												"file": 0,
												"col": 1,
												"row": 5
											}
										},
										{
											"type": "ObjectInsertStmt",
											"stmt": {
												"key": {
													"type": "string_index",
													"value": 11
												},
												"value": {
													"type": "string_index",
													"value": 12
												},
												"object": 4,
												"file": 0,
												"col": 1,
												"row": 5
											}
										},
										{
											"type": "ObjectInsertStmt",
											"stmt": {
												"key": {
													"type": "string_index",
													"value": 13
												},
												"value": {
													"type": "string_index",
													"value": 14
												},
												"object": 4,
												"file": 0,
												"col": 1,
												"row": 5
											}
										},
										{
											"type": "ObjectInsertStmt",
											"stmt": {
												"key": {
													"type": "string_index",
													"value": 15
												},
												"value": {
													"type": "string_index",
													"value": 16
												},
												"object": 4,
												"file": 0,
												"col": 1,
												"row": 5
											}
										},
										{
											"type": "ObjectInsertStmt",
											"stmt": {
												"key": {
													"type": "string_index",
													"value": 17
												},
												"value": {
													"type": "string_index",
													"value": 18
												},
												"object": 4,
												"file": 0,
												"col": 1,
												"row": 5
											}
										},
										{
											"type": "AssignVarOnceStmt",
											"stmt": {
												"source": {
													"type": "local",
													"value": 4
												},
												"target": 3,
												"file": 0,
												"col": 1,
												"row": 5
											}
										}
									]
								},
								{
									"stmts": [
										{
											"type": "IsDefinedStmt",
											"stmt": {
												"source": 3,
												"file": 0,
												"col": 1,
												"row": 5
											}
										},
										{
											"type": "AssignVarOnceStmt",
											"stmt": {
												"source": {
													"type": "local",
													"value": 3
												},
												"target": 2,
												"file": 0,
												"col": 1,
												"row": 5
											}
										}
									]
								},
								{
									"stmts": [
										{
											"type": "ReturnLocalStmt",
											"stmt": {
												"source": 2,
												"file": 0,
												"col": 1,
												"row": 5
											}
										}
									]
								}
							],
							"path": [
								"g0",
								"test",
								"aws_config"
							]
						},
						{
							"name": "g0.data.test.expected",
							"params": [
								0,
								1
							],
							"return": 2,
							"blocks": [
								{
									"stmts": [
										{
											"type": "ResetLocalStmt",
											"stmt": {
												"target": 3,
												"file": 0,
												"col": 1,
												"row": 7
											}
										},
										{
											"type": "MakeObjectStmt",
											"stmt": {
												"target": 4,
												"file": 0,
												"col": 1,
												"row": 7
											}
										},
										{
											"type": "MakeObjectStmt",
											"stmt": {
												"target": 5,
												"file": 0,
												"col": 1,
												"row": 7
											}
										},
										{
											"type": "MakeSetStmt",
											"stmt": {
												"target": 6,
												"file": 0,
												"col": 1,
												"row": 7
											}
										},
										{
											"type": "MakeNumberRefStmt",
											"stmt": {
												"Index": 3,
												"target": 7,
												"file": 0,
												"col": 1,
												"row": 7
											}
										},
										{
											"type": "SetAddStmt",
											"stmt": {
												"value": {
													"type": "local",
													"value": 7
												},
												"set": 6,
												"file": 0,
												"col": 1,
												"row": 7
											}
										},
										{
											"type": "MakeNumberRefStmt",
											"stmt": {
												"Index": 4,
												"target": 8,
												"file": 0,
												"col": 1,
												"row": 7
											}
										},
										{
											"type": "SetAddStmt",
											"stmt": {
												"value": {
													"type": "local",
													"value": 8
												},
												"set": 6,
												"file": 0,
												"col": 1,
												"row": 7
											}
										},
										{
											"type": "MakeNumberRefStmt",
											"stmt": {
												"Index": 5,
												"target": 9,
												"file": 0,
												"col": 1,
												"row": 7
											}
										},
										{
											"type": "SetAddStmt",
											"stmt": {
												"value": {
													"type": "local",
													"value": 9
												},
												"set": 6,
												"file": 0,
												"col": 1,
												"row": 7
											}
										},
										{
											"type": "MakeNumberRefStmt",
											"stmt": {
												"Index": 6,
												"target": 10,
												"file": 0,
												"col": 1,
												"row": 7
											}
										},
										{
											"type": "SetAddStmt",
											"stmt": {
												"value": {
													"type": "local",
													"value": 10
												},
												"set": 6,
												"file": 0,
												"col": 1,
												"row": 7
											}
										},
										{
											"type": "ObjectInsertStmt",
											"stmt": {
												"key": {
													"type": "string_index",
													"value": 2
												},
												"value": {
													"type": "local",
													"value": 6
												},
												"object": 5,
												"file": 0,
												"col": 1,
												"row": 7
											}
										},
										{
											"type": "ObjectInsertStmt",
											"stmt": {
												"key": {
													"type": "string_index",
													"value": 1
												},
												"value": {
													"type": "local",
													"value": 5
												},
												"object": 4,
												"file": 0,
												"col": 1,
												"row": 7
											}
										},
										{
											"type": "MakeObjectStmt",
											"stmt": {
												"target": 11,
												"file": 0,
												"col": 1,
												"row": 7
											}
										},
										{
											"type": "ObjectInsertStmt",
											"stmt": {
												"key": {
													"type": "string_index",
													"value": 21
												},
												"value": {
													"type": "string_index",
													"value": 22
												},
												"object": 11,
												"file": 0,
												"col": 1,
												"row": 7
											}
										},
										{
											"type": "ObjectInsertStmt",
											"stmt": {
												"key": {
													"type": "string_index",
													"value": 23
												},
												"value": {
													"type": "string_index",
													"value": 24
												},
												"object": 11,
												"file": 0,
												"col": 1,
												"row": 7
											}
										},
										{
											"type": "ObjectInsertStmt",
											"stmt": {
												"key": {
													"type": "string_index",
													"value": 25
												},
												"value": {
													"type": "string_index",
													"value": 26
												},
												"object": 11,
												"file": 0,
												"col": 1,
												"row": 7
											}
										},
										{
											"type": "ObjectInsertStmt",
											"stmt": {
												"key": {
													"type": "string_index",
													"value": 27
												},
												"value": {
													"type": "string_index",
													"value": 28
												},
												"object": 11,
												"file": 0,
												"col": 1,
												"row": 7
											}
										},
										{
											"type": "ObjectInsertStmt",
											"stmt": {
												"key": {
													"type": "string_index",
													"value": 20
												},
												"value": {
													"type": "local",
													"value": 11
												},
												"object": 4,
												"file": 0,
												"col": 1,
												"row": 7
											}
										},
										{
											"type": "ObjectInsertStmt",
											"stmt": {
												"key": {
													"type": "string_index",
													"value": 7
												},
												"value": {
													"type": "string_index",
													"value": 8
												},
												"object": 4,
												"file": 0,
												"col": 1,
												"row": 7
											}
										},
										{
											"type": "ObjectInsertStmt",
											"stmt": {
												"key": {
													"type": "string_index",
													"value": 9
												},
												"value": {
													"type": "string_index",
													"value": 10
												},
												"object": 4,
												"file": 0,
												"col": 1,
												"row": 7
											}
										},
										{
											"type": "AssignVarOnceStmt",
											"stmt": {
												"source": {
													"type": "local",
													"value": 4
												},
												"target": 3,
												"file": 0,
												"col": 1,
												"row": 7
											}
										}
									]
								},
								{
									"stmts": [
										{
											"type": "IsDefinedStmt",
											"stmt": {
												"source": 3,
												"file": 0,
												"col": 1,
												"row": 7
											}
										},
										{
											"type": "AssignVarOnceStmt",
											"stmt": {
												"source": {
													"type": "local",
													"value": 3
												},
												"target": 2,
												"file": 0,
												"col": 1,
												"row": 7
											}
										}
									]
								},
								{
									"stmts": [
										{
											"type": "ReturnLocalStmt",
											"stmt": {
												"source": 2,
												"file": 0,
												"col": 1,
												"row": 7
											}
										}
									]
								}
							],
							"path": [
								"g0",
								"test",
								"expected"
							]
						},
						{
							"name": "g0.data.test.p",
							"params": [
								0,
								1
							],
							"return": 2,
							"blocks": [
								{
									"stmts": [
										{
											"type": "ResetLocalStmt",
											"stmt": {
												"target": 3,
												"file": 0,
												"col": 1,
												"row": 19
											}
										},
										{
											"type": "CallStmt",
											"stmt": {
												"func": "g0.data.test.req",
												"args": [
													{
														"type": "local",
														"value": 0
													},
													{
														"type": "local",
														"value": 1
													}
												],
												"result": 4,
												"file": 0,
												"col": 25,
												"row": 20
											}
										},
										{
											"type": "AssignVarStmt",
											"stmt": {
												"source": {
													"type": "local",
													"value": 4
												},
												"target": 5,
												"file": 0,
												"col": 25,
												"row": 20
											}
										},
										{
											"type": "CallStmt",
											"stmt": {
												"func": "g0.data.test.aws_config",
												"args": [
													{
														"type": "local",
														"value": 0
													},
													{
														"type": "local",
														"value": 1
													}
												],
												"result": 6,
												"file": 0,
												"col": 30,
												"row": 20
											}
										},
										{
											"type": "AssignVarStmt",
											"stmt": {
												"source": {
													"type": "local",
													"value": 6
												},
												"target": 7,
												"file": 0,
												"col": 30,
												"row": 20
											}
										},
										{
											"type": "MakeNumberRefStmt",
											"stmt": {
												"Index": 19,
												"target": 8,
												"file": 0,
												"col": 2,
												"row": 20
											}
										},
										{
											"type": "CallStmt",
											"stmt": {
												"func": "providers.aws.sign_req",
												"args": [
													{
														"type": "local",
														"value": 5
													},
													{
														"type": "local",
														"value": 7
													},
													{
														"type": "local",
														"value": 8
													}
												],
												"result": 9,
												"file": 0,
												"col": 2,
												"row": 20
											}
										},
										{
											"type": "AssignVarStmt",
											"stmt": {
												"source": {
													"type": "local",
													"value": 9
												},
												"target": 10,
												"file": 0,
												"col": 2,
												"row": 20
											}
										},
										{
											"type": "CallStmt",
											"stmt": {
												"func": "g0.data.test.expected",
												"args": [
													{
														"type": "local",
														"value": 0
													},
													{
														"type": "local",
														"value": 1
													}
												],
												"result": 11,
												"file": 0,
												"col": 2,
												"row": 20
											}
										},
										{
											"type": "EqualStmt",
											"stmt": {
												"a": {
													"type": "local",
													"value": 10
												},
												"b": {
													"type": "local",
													"value": 11
												},
												"file": 0,
												"col": 2,
												"row": 20
											}
										},
										{
											"type": "AssignVarOnceStmt",
											"stmt": {
												"source": {
													"type": "bool",
													"value": true
												},
												"target": 3,
												"file": 0,
												"col": 1,
												"row": 19
											}
										}
									]
								},
								{
									"stmts": [
										{
											"type": "IsDefinedStmt",
											"stmt": {
												"source": 3,
												"file": 0,
												"col": 1,
												"row": 19
											}
										},
										{
											"type": "AssignVarOnceStmt",
											"stmt": {
												"source": {
													"type": "local",
													"value": 3
												},
												"target": 2,
												"file": 0,
												"col": 1,
												"row": 19
											}
										}
									]
								},
								{
									"stmts": [
										{
											"type": "ReturnLocalStmt",
											"stmt": {
												"source": 2,
												"file": 0,
												"col": 1,
												"row": 19
											}
										}
									]
								}
							],
							"path": [
								"g0",
								"test",
								"p"
							]
						}
					]
				}
			},
			"want_plan_result": [
				{
					"x": true
				}
			]
		},
		{
			"note": "providers-aws-sign_req/success-simple-raw_body",
			"query": "data.test.p = x",
			"modules": [
				"package test\n\nreq := {\"method\": \"get\", \"url\": \"http://example.com\", \"raw_body\": \"{\\\"example\\\": {1, 2, 3, 4}}\"}\n\naws_config := {\"aws_access_key\": \"MYAWSACCESSKEYGOESHERE\", \"aws_secret_access_key\": \"MYAWSSECRETACCESSKEYGOESHERE\", \"aws_service\": \"s3\", \"aws_region\": \"us-east-1\"}\n\nexpected := {\n\t\"headers\": {\n\t\t\"Authorization\": \"AWS4-HMAC-SHA256 Credential=MYAWSACCESSKEYGOESHERE/20151228/us-east-1/s3/aws4_request,SignedHeaders=host;x-amz-content-sha256;x-amz-date,Signature=5bf26e169cb8b02330dba39d53932532438fc856c2f10537689a09ed807c7195\",\n\t\t\"host\": \"example.com\",\n\t\t\"x-amz-content-sha256\": \"22906461e2a98a3e780d0fd260e341bed5e544661e97c5936fc7f3af11aaad8b\",\n\t\t\"x-amz-date\": \"20151228T140825Z\",\n\t},\n\t\"method\": \"get\",\n\t\"raw_body\": \"{\\\"example\\\": {1, 2, 3, 4}}\",\n\t\"url\": \"http://example.com\",\n}\n\np if {\n\tproviders.aws.sign_req(req, aws_config, 1451311705000000000) == expected\n}\n"
			],
			"want_result": [
				{
					"x": true
				}
			],
			"entrypoints": [
				"eval"
			],
			"plan": {
				"static": {
					"strings": [
						{
							"value": "x"
						},
						{
							"value": "method"
						},
						{
							"value": "get"
						},
						{
							"value": "raw_body"
						},
						{
							"value": "{\"example\": {1, 2, 3, 4}}"
						},
						{
							"value": "url"
						},
						{
							"value": "http://example.com"
						},
						{
							"value": "aws_access_key"
						},
						{
							"value": "MYAWSACCESSKEYGOESHERE"
						},
						{
							"value": "aws_region"
						},
						{
							"value": "us-east-1"
						},
						{
							"value": "aws_secret_access_key"
						},
						{
							"value": "MYAWSSECRETACCESSKEYGOESHERE"
						},
						{
							"value": "aws_service"
						},
						{
							"value": "s3"
						},
						{
							"value": "1451311705000000000"
						},
						{
							"value": "headers"
						},
						{
							"value": "Authorization"
						},
						{
							"value": "AWS4-HMAC-SHA256 Credential=MYAWSACCESSKEYGOESHERE/20151228/us-east-1/s3/aws4_request,SignedHeaders=host;x-amz-content-sha256;x-amz-date,Signature=5bf26e169cb8b02330dba39d53932532438fc856c2f10537689a09ed807c7195"
						},
						{
							"value": "host"
						},
						{
							"value": "example.com"
						},
						{
							"value": "x-amz-content-sha256"
						},
						{
							"value": "22906461e2a98a3e780d0fd260e341bed5e544661e97c5936fc7f3af11aaad8b"
						},
						{
							"value": "x-amz-date"
						},
						{
							"value": "20151228T140825Z"
						}
					],
					"builtin_funcs": [
						{
							"name": "providers.aws.sign_req",
							"decl": {
								"args": [
									{
										"description": "HTTP request object",
										"dynamic": {
											"key": {
												"type": "string"
											},
											"value": {
												"type": "any"
											}
										},
										"name": "request",
										"type": "object"
									},
									{
										"description": "AWS configuration object",
										"dynamic": {
											"key": {
												"type": "string"
											},
											"value": {
												"type": "any"
											}
										},
										"name": "aws_config",
										"type": "object"
									},
									{
										"description": "nanoseconds since the epoch",
										"name": "time_ns",
										"type": "number"
									}
								],
								"result": {
									"description": "HTTP request object with `Authorization` header",
									"dynamic": {
										"key": {
											"type": "any"
										},
										"value": {
											"type": "any"
										}
									},
									"name": "signed_request",
									"type": "object"
								},
								"type": "function"
							}
						}
					],
					"files": [
						{
							"value": "module-0.rego"
						},
						{
							"value": "\u003cquery\u003e"
						}
					]
				},
				"plans": {
					"plans": [
						{
							"name": "eval",
							"blocks": [
								{
									"stmts": [
										{
											"type": "CallStmt",
											"stmt": {
												"func": "g0.data.test.p",
												"args": [
													{
														"type": "local",
														"value": 0
													},
													{
														"type": "local",
														"value": 1
													}
												],
												"result": 2,
												"file": 1,
												"col": 1,
												"row": 1
											}
										},
										{
											"type": "AssignVarStmt",
											"stmt": {
												"source": {
													"type": "local",
													"value": 2
												},
												"target": 3,
												"file": 1,
												"col": 1,
												"row": 1
											}
										},
										{
											"type": "MakeObjectStmt",
											"stmt": {
												"target": 4,
												"file": 1,
												"col": 1,
												"row": 1
											}
										},
										{
											"type": "ObjectInsertStmt",
											"stmt": {
												"key": {
													"type": "string_index",
													"value": 0
												},
												"value": {
													"type": "local",
													"value": 3
												},
												"object": 4,
												"file": 1,
												"col": 1,
												"row": 1
											}
										},
										{
											"type": "ResultSetAddStmt",
											"stmt": {
												"value": 4,
												"file": 1,
												"col": 1,
												"row": 1
											}
										}
									]
								}
							]
						}
					]
				},
				"funcs": {
					"funcs": [
						{
							"name": "g0.data.test.req",
							"params": [
								0,
								1
							],
							"return": 2,
							"blocks": [
								{
									"stmts": [
										{
											"type": "ResetLocalStmt",
											"stmt": {
												"target": 3,
												"file": 0,
												"col": 1,
												"row": 3
											}
										},
										{
											"type": "MakeObjectStmt",
											"stmt": {
												"target": 4,
												"file": 0,
												"col": 1,
												"row": 3
											}
										},
										{
											"type": "ObjectInsertStmt",
											"stmt": {
												"key": {
													"type": "string_index",
													"value": 1
												},
												"value": {
													"type": "string_index",
													"value": 2
												},
												"object": 4,
												"file": 0,
												"col": 1,
												"row": 3
											}
										},
										{
											"type": "ObjectInsertStmt",
											"stmt": {
												"key": {
													"type": "string_index",
													"value": 3
												},
												"value": {
													"type": "string_index",
													"value": 4
												},
												"object": 4,
												"file": 0,
												"col": 1,
												"row": 3
											}
										},
										{
											"type": "ObjectInsertStmt",
											"stmt": {
												"key": {
													"type": "string_index",
													"value": 5
												},
												"value": {
													"type": "string_index",
													"value": 6
												},
												"object": 4,
												"file": 0,
												"col": 1,
												"row": 3
											}
										},
										{
											"type": "AssignVarOnceStmt",
											"stmt": {
												"source": {
													"type": "local",
													"value": 4
												},
												"target": 3,
												"file": 0,
												"col": 1,
												"row": 3
											}
										}
									]
								},
								{
									"stmts": [
										{
											"type": "IsDefinedStmt",
											"stmt": {
												"source": 3,
												"file": 0,
												"col": 1,
												"row": 3
											}
										},
										{
											"type": "AssignVarOnceStmt",
											"stmt": {
												"source": {
													"type": "local",
													"value": 3
												},
												"target": 2,
												"file": 0,
												"col": 1,
												"row": 3
											}
										}
									]
								},
								{
									"stmts": [
										{
											"type": "ReturnLocalStmt",
											"stmt": {
												"source": 2,
												"file": 0,
												"col": 1,
												"row": 3
											}
										}
									]
								}
							],
							"path": [
								"g0",
								"test",
								"req"
							]
						},
						{
							"name": "g0.data.test.aws_config",
							"params": [
								0,
								1
							],
							"return": 2,
							"blocks": [
								{
									"stmts": [
										{
											"type": "ResetLocalStmt",
											"stmt": {
												"target": 3,
												"file": 0,
												"col": 1,
												"row": 5
											}
										},
										{
											"type": "MakeObjectStmt",
											"stmt": {
												"target": 4,
												"file": 0,
												"col": 1,
												"row": 5
											}
										},
										{
											"type": "ObjectInsertStmt",
											"stmt": {
												"key": {
													"type": "string_index",
													"value": 7
												},
												"value": {
													"type": "string_index",
													"value": 8
												},
												"object": 4,
												"file": 0,
												"col": 1,
												"row": 5
											}
										},
										{
											"type": "ObjectInsertStmt",
											"stmt": {
												"key": {
													"type": "string_index",
													"value": 9
												},
												"value": {
													"type": "string_index",
													"value": 10
												},
												"object": 4,
												"file": 0,
												"col": 1,
												"row": 5
											}
										},
										{
											"type": "ObjectInsertStmt",
											"stmt": {
												"key": {
													"type": "string_index",
													"value": 11
												},
												"value": {
													"type": "string_index",
													"value": 12
												},
												"object": 4,
												"file": 0,
												"col": 1,
												"row": 5
											}
										},
										{
											"type": "ObjectInsertStmt",
											"stmt": {
												"key": {
													"type": "string_index",
													"value": 13
												},
												"value": {
													"type": "string_index",
													"value": 14
												},
												"object": 4,
												"file": 0,
												"col": 1,
												"row": 5
											}
										},
										{
											"type": "AssignVarOnceStmt",
											"stmt": {
												"source": {
													"type": "local",
													"value": 4
												},
												"target": 3,
												"file": 0,
												"col": 1,
												"row": 5
											}
										}
									]
								},
								{
									"stmts": [
										{
											"type": "IsDefinedStmt",
											"stmt": {
												"source": 3,
												"file": 0,
												"col": 1,
												"row": 5
											}
										},
										{
											"type": "AssignVarOnceStmt",
											"stmt": {
												"source": {
													"type": "local",
													"value": 3
												},
												"target": 2,
												"file": 0,
												"col": 1,
												"row": 5
											}
										}
									]
								},
								{
									"stmts": [
										{
											"type": "ReturnLocalStmt",
											"stmt": {
												"source": 2,
												"file": 0,
												"col": 1,
												"row": 5
											}
										}
									]
								}
							],
							"path": [
								"g0",
								"test",
								"aws_config"
							]
						},
						{
							"name": "g0.data.test.expected",
							"params": [
								0,
								1
							],
							"return": 2,
							"blocks": [
								{
									"stmts": [
										{
											"type": "ResetLocalStmt",
											"stmt": {
												"target": 3,
												"file": 0,
												"col": 1,
												"row": 7
											}
										},
										{
											"type": "MakeObjectStmt",
											"stmt": {
												"target": 4,
												"file": 0,
												"col": 1,
												"row": 7
											}
										},
										{
											"type": "MakeObjectStmt",
											"stmt": {
												"target": 5,
												"file": 0,
												"col": 1,
												"row": 7
											}
										},
										{
											"type": "ObjectInsertStmt",
											"stmt": {
												"key": {
													"type": "string_index",
													"value": 17
												},
												"value": {
													"type": "string_index",
													"value": 18
												},
												"object": 5,
												"file": 0,
												"col": 1,
												"row": 7
											}
										},
										{
											"type": "ObjectInsertStmt",
											"stmt": {
												"key": {
													"type": "string_index",
													"value": 19
												},
												"value": {
													"type": "string_index",
													"value": 20
												},
												"object": 5,
												"file": 0,
												"col": 1,
												"row": 7
											}
										},
										{
											"type": "ObjectInsertStmt",
											"stmt": {
												"key": {
													"type": "string_index",
													"value": 21
												},
												"value": {
													"type": "string_index",
													"value": 22
												},
												"object": 5,
												"file": 0,
												"col": 1,
												"row": 7
											}
										},
										{
											"type": "ObjectInsertStmt",
											"stmt": {
												"key": {
													"type": "string_index",
													"value": 23
												},
												"value": {
													"type": "string_index",
													"value": 24
												},
												"object": 5,
												"file": 0,
												"col": 1,
												"row": 7
											}
										},
										{
											"type": "ObjectInsertStmt",
											"stmt": {
												"key": {
													"type": "string_index",
													"value": 16
												},
												"value": {
													"type": "local",
													"value": 5
												},
												"object": 4,
												"file": 0,
												"col": 1,
												"row": 7
											}
										},
										{
											"type": "ObjectInsertStmt",
											"stmt": {
												"key": {
													"type": "string_index",
													"value": 1
												},
												"value": {
													"type": "string_index",
													"value": 2
												},
												"object": 4,
												"file": 0,
												"col": 1,
												"row": 7
											}
										},
										{
											"type": "ObjectInsertStmt",
											"stmt": {
												"key": {
													"type": "string_index",
													"value": 3
												},
												"value": {
													"type": "string_index",
													"value": 4
												},
												"object": 4,
												"file": 0,
												"col": 1,
												"row": 7
											}
										},
										{
											"type": "ObjectInsertStmt",
											"stmt": {
												"key": {
													"type": "string_index",
													"value": 5
												},
												"value": {
													"type": "string_index",
													"value": 6
												},
												"object": 4,
												"file": 0,
												"col": 1,
												"row": 7
											}
										},
										{
											"type": "AssignVarOnceStmt",
											"stmt": {
												"source": {
													"type": "local",
													"value": 4
												},
												"target": 3,
												"file": 0,
												"col": 1,
												"row": 7
											}
										}
									]
								},
								{
									"stmts": [
										{
											"type": "IsDefinedStmt",
											"stmt": {
												"source": 3,
												"file": 0,
												"col": 1,
												"row": 7
											}
										},
										{
											"type": "AssignVarOnceStmt",
											"stmt": {
												"source": {
													"type": "local",
													"value": 3
												},
												"target": 2,
												"file": 0,
												"col": 1,
												"row": 7
											}
										}
									]
								},
								{
									"stmts": [
										{
											"type": "ReturnLocalStmt",
											"stmt": {
												"source": 2,
												"file": 0,
												"col": 1,
												"row": 7
											}
										}
									]
								}
							],
							"path": [
								"g0",
								"test",
								"expected"
							]
						},
						{
							"name": "g0.data.test.p",
							"params": [
								0,
								1
							],
							"return": 2,
							"blocks": [
								{
									"stmts": [
										{
											"type": "ResetLocalStmt",
											"stmt": {
												"target": 3,
												"file": 0,
												"col": 1,
												"row": 19
											}
										},
										{
											"type": "CallStmt",
											"stmt": {
												"func": "g0.data.test.req",
												"args": [
													{
														"type": "local",
														"value": 0
													},
													{
														"type": "local",
														"value": 1
													}
												],
												"result": 4,
												"file": 0,
												"col": 25,
												"row": 20
											}
										},
										{
											"type": "AssignVarStmt",
											"stmt": {
												"source": {
													"type": "local",
													"value": 4
												},
												"target": 5,
												"file": 0,
												"col": 25,
												"row": 20
											}
										},
										{
											"type": "CallStmt",
											"stmt": {
												"func": "g0.data.test.aws_config",
												"args": [
													{
														"type": "local",
														"value": 0
													},
													{
														"type": "local",
														"value": 1
													}
												],
												"result": 6,
												"file": 0,
												"col": 30,
												"row": 20
											}
										},
										{
											"type": "AssignVarStmt",
											"stmt": {
												"source": {
													"type": "local",
													"value": 6
												},
												"target": 7,
												"file": 0,
												"col": 30,
												"row": 20
											}
										},
										{
											"type": "MakeNumberRefStmt",
											"stmt": {
												"Index": 15,
												"target": 8,
												"file": 0,
												"col": 2,
												"row": 20
											}
										},
										{
											"type": "CallStmt",
											"stmt": {
												"func": "providers.aws.sign_req",
												"args": [
													{
														"type": "local",
														"value": 5
													},
													{
														"type": "local",
														"value": 7
													},
													{
														"type": "local",
														"value": 8
													}
												],
												"result": 9,
												"file": 0,
												"col": 2,
												"row": 20
											}
										},
										{
											"type": "AssignVarStmt",
											"stmt": {
												"source": {
													"type": "local",
													"value": 9
												},
												"target": 10,
												"file": 0,
												"col": 2,
												"row": 20
											}
										},
										{
											"type": "CallStmt",
											"stmt": {
												"func": "g0.data.test.expected",
												"args": [
													{
														"type": "local",
														"value": 0
													},
													{
														"type": "local",
														"value": 1
													}
												],
												"result": 11,
												"file": 0,
												"col": 2,
												"row": 20
											}
										},
										{
											"type": "EqualStmt",
											"stmt": {
												"a": {
													"type": "local",
													"value": 10
												},
												"b": {
													"type": "local",
													"value": 11
												},
												"file": 0,
												"col": 2,
												"row": 20
											}
										},
										{
											"type": "AssignVarOnceStmt",
											"stmt": {
												"source": {
													"type": "bool",
													"value": true
												},
												"target": 3,
												"file": 0,
												"col": 1,
												"row": 19
											}
										}
									]
								},
								{
									"stmts": [
										{
											"type": "IsDefinedStmt",
											"stmt": {
												"source": 3,
												"file": 0,
												"col": 1,
												"row": 19
											}
										},
										{
											"type": "AssignVarOnceStmt",
											"stmt": {
												"source": {
													"type": "local",
													"value": 3
												},
												"target": 2,
												"file": 0,
												"col": 1,
												"row": 19
											}
										}
									]
								},
								{
									"stmts": [
										{
											"type": "ReturnLocalStmt",
											"stmt": {
												"source": 2,
												"file": 0,
												"col": 1,
												"row": 19
											}
										}
									]
								}
							],
							"path": [
								"g0",
								"test",
								"p"
							]
						}
					]
				}
			},
			"want_plan_result": [
				{
					"x": true
				}
			]
		},
		{
			"note": "providers-aws-sign_req/success-simple-body-and-raw_body",
			"query": "data.test.p = x",
			"modules": [
				"package test\n\nreq := {\"method\": \"get\", \"url\": \"http://example.com\", \"body\": {\"example\": {1, 2, 3, 4}}, \"raw_body\": \"{\\\"example\\\": {1, 2, 3, 4}}\"}\n\naws_config := {\"aws_access_key\": \"MYAWSACCESSKEYGOESHERE\", \"aws_secret_access_key\": \"MYAWSSECRETACCESSKEYGOESHERE\", \"aws_service\": \"s3\", \"aws_region\": \"us-east-1\"}\n\nexpected := {\n\t\"body\": {\"example\": {1, 2, 3, 4}},\n\t\"headers\": {\n\t\t\"Authorization\": \"AWS4-HMAC-SHA256 Credential=MYAWSACCESSKEYGOESHERE/20151228/us-east-1/s3/aws4_request,SignedHeaders=host;x-amz-content-sha256;x-amz-date,Signature=5bf26e169cb8b02330dba39d53932532438fc856c2f10537689a09ed807c7195\",\n\t\t\"host\": \"example.com\",\n\t\t\"x-amz-content-sha256\": \"22906461e2a98a3e780d0fd260e341bed5e544661e97c5936fc7f3af11aaad8b\",\n\t\t\"x-amz-date\": \"20151228T140825Z\",\n\t},\n\t\"method\": \"get\",\n\t\"raw_body\": \"{\\\"example\\\": {1, 2, 3, 4}}\",\n\t\"url\": \"http://example.com\",\n}\n\np if {\n\tproviders.aws.sign_req(req, aws_config, 1451311705000000000) == expected\n}\n"
			],
			"want_result": [
				{
					"x": true
				}
			],
			"entrypoints": [
				"eval"
			],
			"plan": {
				"static": {
					"strings": [
						{
							"value": "x"
						},
						{
							"value": "body"
						},
						{
							"value": "example"
						},
						{
							"value": "1"
						},
						{
							"value": "2"
						},
						{
							"value": "3"
						},
						{
							"value": "4"
						},
						{
							"value": "method"
						},
						{
							"value": "get"
						},
						{
							"value": "raw_body"
						},
						{
							"value": "{\"example\": {1, 2, 3, 4}}"
						},
						{
							"value": "url"
						},
						{
							"value": "http://example.com"
						},
						{
							"value": "aws_access_key"
						},
						{
							"value": "MYAWSACCESSKEYGOESHERE"
						},
						{
							"value": "aws_region"
						},
						{
							"value": "us-east-1"
						},
						{
							"value": "aws_secret_access_key"
						},
						{
							"value": "MYAWSSECRETACCESSKEYGOESHERE"
						},
						{
							"value": "aws_service"
						},
						{
							"value": "s3"
						},
						{
							"value": "1451311705000000000"
						},
						{
							"value": "headers"
						},
						{
							"value": "Authorization"
						},
						{
							"value": "AWS4-HMAC-SHA256 Credential=MYAWSACCESSKEYGOESHERE/20151228/us-east-1/s3/aws4_request,SignedHeaders=host;x-amz-content-sha256;x-amz-date,Signature=5bf26e169cb8b02330dba39d53932532438fc856c2f10537689a09ed807c7195"
						},
						{
							"value": "host"
						},
						{
							"value": "example.com"
						},
						{
							"value": "x-amz-content-sha256"
						},
						{
							"value": "22906461e2a98a3e780d0fd260e341bed5e544661e97c5936fc7f3af11aaad8b"
						},
						{
							"value": "x-amz-date"
						},
						{
							"value": "20151228T140825Z"
						}
					],
					"builtin_funcs": [
						{
							"name": "providers.aws.sign_req",
							"decl": {
								"args": [
									{
										"description": "HTTP request object",
										"dynamic": {
											"key": {
												"type": "string"
											},
											"value": {
												"type": "any"
											}
										},
										"name": "request",
										"type": "object"
									},
									{
										"description": "AWS configuration object",
										"dynamic": {
											"key": {
												"type": "string"
											},
											"value": {
												"type": "any"
											}
										},
										"name": "aws_config",
										"type": "object"
									},
									{
										"description": "nanoseconds since the epoch",
										"name": "time_ns",
										"type": "number"
									}
								],
								"result": {
									"description": "HTTP request object with `Authorization` header",
									"dynamic": {
										"key": {
											"type": "any"
										},
										"value": {
											"type": "any"
										}
									},
									"name": "signed_request",
									"type": "object"
								},
								"type": "function"
							}
						}
					],
					"files": [
						{
							"value": "module-0.rego"
						},
						{
							"value": "\u003cquery\u003e"
						}
					]
				},
				"plans": {
					"plans": [
						{
							"name": "eval",
							"blocks": [
								{
									"stmts": [
										{
											"type": "CallStmt",
											"stmt": {
												"func": "g0.data.test.p",
												"args": [
													{
														"type": "local",
														"value": 0
													},
													{
														"type": "local",
														"value": 1
													}
												],
												"result": 2,
												"file": 1,
												"col": 1,
												"row": 1
											}
										},
										{
											"type": "AssignVarStmt",
											"stmt": {
												"source": {
													"type": "local",
													"value": 2
												},
												"target": 3,
												"file": 1,
												"col": 1,
												"row": 1
											}
										},
										{
											"type": "MakeObjectStmt",
											"stmt": {
												"target": 4,
												"file": 1,
												"col": 1,
												"row": 1
											}
										},
										{
											"type": "ObjectInsertStmt",
											"stmt": {
												"key": {
													"type": "string_index",
													"value": 0
												},
												"value": {
													"type": "local",
													"value": 3
												},
												"object": 4,
												"file": 1,
												"col": 1,
												"row": 1
											}
										},
										{
											"type": "ResultSetAddStmt",
											"stmt": {
												"value": 4,
												"file": 1,
												"col": 1,
												"row": 1
											}
										}
									]
								}
							]
						}
					]
				},
				"funcs": {
					"funcs": [
						{
							"name": "g0.data.test.req",
							"params": [
								0,
								1
							],
							"return": 2,
							"blocks": [
								{
									"stmts": [
										{
											"type": "ResetLocalStmt",
											"stmt": {
												"target": 3,
												"file": 0,
												"col": 1,
												"row": 3
											}
										},
										{
											"type": "MakeObjectStmt",
											"stmt": {
												"target": 4,
												"file": 0,
												"col": 1,
												"row": 3
											}
										},
										{
											"type": "MakeObjectStmt",
											"stmt": {
												"target": 5,
												"file": 0,
												"col": 1,
												"row": 3
											}
										},
										{
											"type": "MakeSetStmt",
											"stmt": {
												"target": 6,
												"file": 0,
												"col": 1,
												"row": 3
											}
										},
										{
											"type": "MakeNumberRefStmt",
											"stmt": {
												"Index": 3,
												"target": 7,
												"file": 0,
												"col": 1,
												"row": 3
											}
										},
										{
											"type": "SetAddStmt",
											"stmt": {
												"value": {
													"type": "local",
													"value": 7
												},
												"set": 6,
												"file": 0,
												"col": 1,
												"row": 3
											}
										},
										{
											"type": "MakeNumberRefStmt",
											"stmt": {
												"Index": 4,
												"target": 8,
												"file": 0,
												"col": 1,
												"row": 3
											}
										},
										{
											"type": "SetAddStmt",
											"stmt": {
												"value": {
													"type": "local",
													"value": 8
												},
												"set": 6,
												"file": 0,
												"col": 1,
												"row": 3
											}
										},
										{
											"type": "MakeNumberRefStmt",
											"stmt": {
												"Index": 5,
												"target": 9,
												"file": 0,
												"col": 1,
												"row": 3
											}
										},
										{
											"type": "SetAddStmt",
											"stmt": {
												"value": {
													"type": "local",
													"value": 9
												},
												"set": 6,
												"file": 0,
												"col": 1,
												"row": 3
											}
										},
										{
											"type": "MakeNumberRefStmt",
											"stmt": {
												"Index": 6,
												"target": 10,
												"file": 0,
												"col": 1,
												"row": 3
											}
										},
										{
											"type": "SetAddStmt",
											"stmt": {
												"value": {
													"type": "local",
													"value": 10
												},
												"set": 6,
												"file": 0,
												"col": 1,
												"row": 3
											}
										},
										{
											"type": "ObjectInsertStmt",
											"stmt": {
												"key": {
													"type": "string_index",
													"value": 2
												},
												"value": {
													"type": "local",
													"value": 6
												},
												"object": 5,
												"file": 0,
												"col": 1,
												"row": 3
											}
										},
										{
											"type": "ObjectInsertStmt",
											"stmt": {
												"key": {
													"type": "string_index",
													"value": 1
												},
												"value": {
													"type": "local",
													"value": 5
												},
												"object": 4,
												"file": 0,
												"col": 1,
												"row": 3
											}
										},
										{
											"type": "ObjectInsertStmt",
											"stmt": {
												"key": {
													"type": "string_index",
													"value": 7
												},
												"value": {
													"type": "string_index",
													"value": 8
												},
												"object": 4,
												"file": 0,
												"col": 1,
												"row": 3
											}
										},
										{
											"type": "ObjectInsertStmt",
											"stmt": {
												"key": {
													"type": "string_index",
													"value": 9
												},
												"value": {
													"type": "string_index",
													"value": 10
												},
												"object": 4,
												"file": 0,
												"col": 1,
												"row": 3
											}
										},
										{
											"type": "ObjectInsertStmt",
											"stmt": {
												"key": {
													"type": "string_index",
													"value": 11
												},
												"value": {
													"type": "string_index",
													"value": 12
												},
												"object": 4,
												"file": 0,
												"col": 1,
												"row": 3
											}
										},
										{
											"type": "AssignVarOnceStmt",
											"stmt": {
												"source": {
													"type": "local",
													"value": 4
												},
												"target": 3,
												"file": 0,
												"col": 1,
												"row": 3
											}
										}
									]
								},
								{
									"stmts": [
										{
											"type": "IsDefinedStmt",
											"stmt": {
												"source": 3,
												"file": 0,
												"col": 1,
												"row": 3
											}
										},
										{
											"type": "AssignVarOnceStmt",
											"stmt": {
												"source": {
													"type": "local",
													"value": 3
												},
												"target": 2,
												"file": 0,
												"col": 1,
												"row": 3
											}
										}
									]
								},
								{
									"stmts": [
										{
											"type": "ReturnLocalStmt",
											"stmt": {
												"source": 2,
												"file": 0,
												"col": 1,
												"row": 3
											}
										}
									]
								}
							],
							"path": [
								"g0",
								"test",
								"req"
							]
						},
						{
							"name": "g0.data.test.aws_config",
							"params": [
								0,
								1
							],
							"return": 2,
							"blocks": [
								{
									"stmts": [
										{
											"type": "ResetLocalStmt",
											"stmt": {
												"target": 3,
												"file": 0,
												"col": 1,
												"row": 5
											}
										},
										{
											"type": "MakeObjectStmt",
											"stmt": {
												"target": 4,
												"file": 0,
												"col": 1,
												"row": 5
											}
										},
										{
											"type": "ObjectInsertStmt",
											"stmt": {
												"key": {
													"type": "string_index",
													"value": 13
												},
												"value": {
													"type": "string_index",
													"value": 14
												},
												"object": 4,
												"file": 0,
												"col": 1,
												"row": 5
											}
										},
										{
											"type": "ObjectInsertStmt",
											"stmt": {
												"key": {
													"type": "string_index",
													"value": 15
												},
												"value": {
													"type": "string_index",
													"value": 16
												},
												"object": 4,
												"file": 0,
												"col": 1,
												"row": 5
											}
										},
										{
											"type": "ObjectInsertStmt",
											"stmt": {
												"key": {
													"type": "string_index",
													"value": 17
												},
												"value": {
													"type": "string_index",
													"value": 18
												},
												"object": 4,
												"file": 0,
												"col": 1,
												"row": 5
											}
										},
										{
											"type": "ObjectInsertStmt",
											"stmt": {
												"key": {
													"type": "string_index",
													"value": 19
												},
												"value": {
													"type": "string_index",
													"value": 20
												},
												"object": 4,
												"file": 0,
												"col": 1,
												"row": 5
											}
										},
										{
											"type": "AssignVarOnceStmt",
											"stmt": {
												"source": {
													"type": "local",
													"value": 4
												},
												"target": 3,
												"file": 0,
												"col": 1,
												"row": 5
											}
										}
									]
								},
								{
									"stmts": [
										{
											"type": "IsDefinedStmt",
											"stmt": {
												"source": 3,
												"file": 0,
												"col": 1,
												"row": 5
											}
										},
										{
											"type": "AssignVarOnceStmt",
											"stmt": {
												"source": {
													"type": "local",
													"value": 3
												},
												"target": 2,
												"file": 0,
												"col": 1,
												"row": 5
											}
										}
									]
								},
								{
									"stmts": [
										{
											"type": "ReturnLocalStmt",
											"stmt": {
												"source": 2,
												"file": 0,
												"col": 1,
												"row": 5
											}
										}
									]
								}
							],
							"path": [
								"g0",
								"test",
								"aws_config"
							]
						},
						{
							"name": "g0.data.test.expected",
							"params": [
								0,
								1
							],
							"return": 2,
							"blocks": [
								{
									"stmts": [
										{
											"type": "ResetLocalStmt",
											"stmt": {
												"target": 3,
												"file": 0,
												"col": 1,
												"row": 7
											}
										},
										{
											"type": "MakeObjectStmt",
											"stmt": {
												"target": 4,
												"file": 0,
												"col": 1,
												"row": 7
											}
										},
										{
											"type": "MakeObjectStmt",
											"stmt": {
												"target": 5,
												"file": 0,
												"col": 1,
												"row": 7
											}
										},
										{
											"type": "MakeSetStmt",
											"stmt": {
												"target": 6,
												"file": 0,
												"col": 1,
												"row": 7
											}
										},
										{
											"type": "MakeNumberRefStmt",
											"stmt": {
												"Index": 3,
												"target": 7,
												"file": 0,
												"col": 1,
												"row": 7
											}
										},
										{
											"type": "SetAddStmt",
											"stmt": {
												"value": {
													"type": "local",
													"value": 7
												},
												"set": 6,
												"file": 0,
												"col": 1,
												"row": 7
											}
										},
										{
											"type": "MakeNumberRefStmt",
											"stmt": {
												"Index": 4,
												"target": 8,
												"file": 0,
												"col": 1,
												"row": 7
											}
										},
										{
											"type": "SetAddStmt",
											"stmt": {
												"value": {
													"type": "local",
													"value": 8
												},
												"set": 6,
												"file": 0,
												"col": 1,
												"row": 7
											}
										},
										{
											"type": "MakeNumberRefStmt",
											"stmt": {
												"Index": 5,
												"target": 9,
												"file": 0,
												"col": 1,
												"row": 7
											}
										},
										{
											"type": "SetAddStmt",
											"stmt": {
												"value": {
													"type": "local",
													"value": 9
												},
												"set": 6,
												"file": 0,
												"col": 1,
												"row": 7
											}
										},
										{
											"type": "MakeNumberRefStmt",
											"stmt": {
												"Index": 6,
												"target": 10,
												"file": 0,
												"col": 1,
												"row": 7
											}
										},
										{
											"type": "SetAddStmt",
											"stmt": {
												"value": {
													"type": "local",
													"value": 10
												},
												"set": 6,
												"file": 0,
												"col": 1,
												"row": 7
											}
										},
										{
											"type": "ObjectInsertStmt",
											"stmt": {
												"key": {
													"type": "string_index",
													"value": 2
												},
												"value": {
													"type": "local",
													"value": 6
												},
												"object": 5,
												"file": 0,
												"col": 1,
												"row": 7
											}
										},
										{
											"type": "ObjectInsertStmt",
											"stmt": {
												"key": {
													"type": "string_index",
													"value": 1
												},
												"value": {
													"type": "local",
													"value": 5
												},
												"object": 4,
												"file": 0,
												"col": 1,
												"row": 7
											}
										},
										{
											"type": "MakeObjectStmt",
											"stmt": {
												"target": 11,
												"file": 0,
												"col": 1,
												"row": 7
											}
										},
										{
											"type": "ObjectInsertStmt",
											"stmt": {
												"key": {
													"type": "string_index",
													"value": 23
												},
												"value": {
													"type": "string_index",
													"value": 24
												},
												"object": 11,
												"file": 0,
												"col": 1,
												"row": 7
											}
										},
										{
											"type": "ObjectInsertStmt",
											"stmt": {
												"key": {
													"type": "string_index",
													"value": 25
												},
												"value": {
													"type": "string_index",
													"value": 26
												},
												"object": 11,
												"file": 0,
												"col": 1,
												"row": 7
											}
										},
										{
											"type": "ObjectInsertStmt",
											"stmt": {
												"key": {
													"type": "string_index",
													"value": 27
												},
												"value": {
													"type": "string_index",
													"value": 28
												},
												"object": 11,
												"file": 0,
												"col": 1,
												"row": 7
											}
										},
										{
											"type": "ObjectInsertStmt",
											"stmt": {
												"key": {
													"type": "string_index",
													"value": 29
												},
												"value": {
													"type": "string_index",
													"value": 30
												},
												"object": 11,
												"file": 0,
												"col": 1,
												"row": 7
											}
										},
										{
											"type": "ObjectInsertStmt",
											"stmt": {
												"key": {
													"type": "string_index",
													"value": 22
												},
												"value": {
													"type": "local",
													"value": 11
												},
												"object": 4,
												"file": 0,
												"col": 1,
												"row": 7
											}
										},
										{
											"type": "ObjectInsertStmt",
											"stmt": {
												"key": {
													"type": "string_index",
													"value": 7
												},
												"value": {
													"type": "string_index",
													"value": 8
												},
												"object": 4,
												"file": 0,
												"col": 1,
												"row": 7
											}
										},
										{
											"type": "ObjectInsertStmt",
											"stmt": {
												"key": {
													"type": "string_index",
													"value": 9
												},
												"value": {
													"type": "string_index",
													"value": 10
												},
												"object": 4,
												"file": 0,
												"col": 1,
												"row": 7
											}
										},
										{
											"type": "ObjectInsertStmt",
											"stmt": {
												"key": {
													"type": "string_index",
													"value": 11
												},
												"value": {
													"type": "string_index",
													"value": 12
												},
												"object": 4,
												"file": 0,
												"col": 1,
												"row": 7
											}
										},
										{
											"type": "AssignVarOnceStmt",
											"stmt": {
												"source": {
													"type": "local",
													"value": 4
												},
												"target": 3,
												"file": 0,
												"col": 1,
												"row": 7
											}
										}
									]
								},
								{
									"stmts": [
										{
											"type": "IsDefinedStmt",
											"stmt": {
												"source": 3,
												"file": 0,
												"col": 1,
												"row": 7
											}
										},
										{
											"type": "AssignVarOnceStmt",
											"stmt": {
												"source": {
													"type": "local",
													"value": 3
												},
												"target": 2,
												"file": 0,
												"col": 1,
												"row": 7
											}
										}
									]
								},
								{
									"stmts": [
										{
											"type": "ReturnLocalStmt",
											"stmt": {
												"source": 2,
												"file": 0,
												"col": 1,
												"row": 7
											}
										}
									]
								}
							],
							"path": [
								"g0",
								"test",
								"expected"
							]
						},
						{
							"name": "g0.data.test.p",
							"params": [
								0,
								1
							],
							"return": 2,
							"blocks": [
								{
									"stmts": [
										{
											"type": "ResetLocalStmt",
											"stmt": {
												"target": 3,
												"file": 0,
												"col": 1,
												"row": 20
											}
										},
										{
											"type": "CallStmt",
											"stmt": {
												"func": "g0.data.test.req",
												"args": [
													{
														"type": "local",
														"value": 0
													},
													{
														"type": "local",
														"value": 1
													}
												],
												"result": 4,
												"file": 0,
												"col": 25,
												"row": 21
											}
										},
										{
											"type": "AssignVarStmt",
											"stmt": {
												"source": {
													"type": "local",
													"value": 4
												},
												"target": 5,
												"file": 0,
												"col": 25,
												"row": 21
											}
										},
										{
											"type": "CallStmt",
											"stmt": {
												"func": "g0.data.test.aws_config",
												"args": [
													{
														"type": "local",
														"value": 0
													},
													{
														"type": "local",
														"value": 1
													}
												],
												"result": 6,
												"file": 0,
												"col": 30,
												"row": 21
											}
										},
										{
											"type": "AssignVarStmt",
											"stmt": {
												"source": {
													"type": "local",
													"value": 6
												},
												"target": 7,
												"file": 0,
												"col": 30,
												"row": 21
											}
										},
										{
											"type": "MakeNumberRefStmt",
											"stmt": {
												"Index": 21,
												"target": 8,
												"file": 0,
												"col": 2,
												"row": 21
											}
										},
										{
											"type": "CallStmt",
											"stmt": {
												"func": "providers.aws.sign_req",
												"args": [
													{
														"type": "local",
														"value": 5
													},
													{
														"type": "local",
														"value": 7
													},
													{
														"type": "local",
														"value": 8
													}
												],
												"result": 9,
												"file": 0,
												"col": 2,
												"row": 21
											}
										},
										{
											"type": "AssignVarStmt",
											"stmt": {
												"source": {
													"type": "local",
													"value": 9
												},
												"target": 10,
												"file": 0,
												"col": 2,
												"row": 21
											}
										},
										{
											"type": "CallStmt",
											"stmt": {
												"func": "g0.data.test.expected",
												"args": [
													{
														"type": "local",
														"value": 0
													},
													{
														"type": "local",
														"value": 1
													}
												],
												"result": 11,
												"file": 0,
												"col": 2,
												"row": 21
											}
										},
										{
											"type": "EqualStmt",
											"stmt": {
												"a": {
													"type": "local",
													"value": 10
												},
												"b": {
													"type": "local",
													"value": 11
												},
												"file": 0,
												"col": 2,
												"row": 21
											}
										},
										{
											"type": "AssignVarOnceStmt",
											"stmt": {
												"source": {
													"type": "bool",
													"value": true
												},
												"target": 3,
												"file": 0,
												"col": 1,
												"row": 20
											}
										}
									]
								},
								{
									"stmts": [
										{
											"type": "IsDefinedStmt",
											"stmt": {
												"source": 3,
												"file": 0,
												"col": 1,
												"row": 20
											}
										},
										{
											"type": "AssignVarOnceStmt",
											"stmt": {
												"source": {
													"type": "local",
													"value": 3
												},
												"target": 2,
												"file": 0,
												"col": 1,
												"row": 20
											}
										}
									]
								},
								{
									"stmts": [
										{
											"type": "ReturnLocalStmt",
											"stmt": {
												"source": 2,
												"file": 0,
												"col": 1,
												"row": 20
											}
										}
									]
								}
							],
							"path": [
								"g0",
								"test",
								"p"
							]
						}
					]
				}
			},
			"want_plan_result": [
				{
					"x": true
				}
			]
		},
		{
			"note": "providers-aws-sign_req/success-simple-with-headers-no-body-with-payload-signing",
			"query": "data.test.p = x",
			"modules": [
				"package test\n\nreq := {\"method\": \"get\", \"url\": \"https://example.com\", \"headers\": {\"foo\": \"bar\"}}\n\naws_config := {\"aws_access_key\": \"MYAWSACCESSKEYGOESHERE\", \"aws_secret_access_key\": \"MYAWSSECRETACCESSKEYGOESHERE\", \"aws_service\": \"s3\", \"aws_region\": \"us-east-1\", \"disable_payload_signing\": false}\n\nexpected := {\n\t\"headers\": {\n\t\t\"Authorization\": \"AWS4-HMAC-SHA256 Credential=MYAWSACCESSKEYGOESHERE/20151228/us-east-1/s3/aws4_request,SignedHeaders=foo;host;x-amz-content-sha256;x-amz-date,Signature=8f1dc7c9b9978356a0d0989fd26a95307f4f8a4aa264d8220647b7097d839952\",\n\t\t\"foo\": \"bar\",\n\t\t\"host\": \"example.com\",\n\t\t\"x-amz-content-sha256\": \"e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855\",\n\t\t\"x-amz-date\": \"20151228T140825Z\",\n\t},\n\t\"method\": \"get\",\n\t\"url\": \"https://example.com\",\n}\n\np if {\n\tproviders.aws.sign_req(req, aws_config, 1451311705000000000) == expected\n}\n"
			],
			"want_result": [
				{
					"x": true
				}
			],
			"entrypoints": [
				"eval"
			],
			"plan": {
				"static": {
					"strings": [
						{
							"value": "x"
						},
						{
							"value": "headers"
						},
						{
							"value": "foo"
						},
						{
							"value": "bar"
						},
						{
							"value": "method"
						},
						{
							"value": "get"
						},
						{
							"value": "url"
						},
						{
							"value": "https://example.com"
						},
						{
							"value": "aws_access_key"
						},
						{
							"value": "MYAWSACCESSKEYGOESHERE"
						},
						{
							"value": "aws_region"
						},
						{
							"value": "us-east-1"
						},
						{
							"value": "aws_secret_access_key"
						},
						{
							"value": "MYAWSSECRETACCESSKEYGOESHERE"
						},
						{
							"value": "aws_service"
						},
						{
							"value": "s3"
						},
						{
							"value": "disable_payload_signing"
						},
						{
							"value": "1451311705000000000"
						},
						{
							"value": "Authorization"
						},
						{
							"value": "AWS4-HMAC-SHA256 Credential=MYAWSACCESSKEYGOESHERE/20151228/us-east-1/s3/aws4_request,SignedHeaders=foo;host;x-amz-content-sha256;x-amz-date,Signature=8f1dc7c9b9978356a0d0989fd26a95307f4f8a4aa264d8220647b7097d839952"
						},
						{
							"value": "host"
						},
						{
							"value": "example.com"
						},
						{
							"value": "x-amz-content-sha256"
						},
						{
							"value": "e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855"
						},
						{
							"value": "x-amz-date"
						},
						{
							"value": "20151228T140825Z"
						}
					],
					"builtin_funcs": [
						{
							"name": "providers.aws.sign_req",
							"decl": {
								"args": [
									{
										"description": "HTTP request object",
										"dynamic": {
											"key": {
												"type": "string"
											},
											"value": {
												"type": "any"
											}
										},
										"name": "request",
										"type": "object"
									},
									{
										"description": "AWS configuration object",
										"dynamic": {
											"key": {
												"type": "string"
											},
											"value": {
												"type": "any"
											}
										},
										"name": "aws_config",
										"type": "object"
									},
									{
										"description": "nanoseconds since the epoch",
										"name": "time_ns",
										"type": "number"
									}
								],
								"result": {
									"description": "HTTP request object with `Authorization` header",
									"dynamic": {
										"key": {
											"type": "any"
										},
										"value": {
											"type": "any"
										}
									},
									"name": "signed_request",
									"type": "object"
								},
								"type": "function"
							}
						}
					],
					"files": [
						{
							"value": "module-0.rego"
						},
						{
							"value": "\u003cquery\u003e"
						}
					]
				},
				"plans": {
					"plans": [
						{
							"name": "eval",
							"blocks": [
								{
									"stmts": [
										{
											"type": "CallStmt",
											"stmt": {
												"func": "g0.data.test.p",
												"args": [
													{
														"type": "local",
														"value": 0
													},
													{
														"type": "local",
														"value": 1
													}
												],
												"result": 2,
												"file": 1,
												"col": 1,
												"row": 1
											}
										},
										{
											"type": "AssignVarStmt",
											"stmt": {
												"source": {
													"type": "local",
													"value": 2
												},
												"target": 3,
												"file": 1,
												"col": 1,
												"row": 1
											}
										},
										{
											"type": "MakeObjectStmt",
											"stmt": {
												"target": 4,
												"file": 1,
												"col": 1,
												"row": 1
											}
										},
										{
											"type": "ObjectInsertStmt",
											"stmt": {
												"key": {
													"type": "string_index",
													"value": 0
												},
												"value": {
													"type": "local",
													"value": 3
												},
												"object": 4,
												"file": 1,
												"col": 1,
												"row": 1
											}
										},
										{
											"type": "ResultSetAddStmt",
											"stmt": {
												"value": 4,
												"file": 1,
												"col": 1,
												"row": 1
											}
										}
									]
								}
							]
						}
					]
				},
				"funcs": {
					"funcs": [
						{
							"name": "g0.data.test.req",
							"params": [
								0,
								1
							],
							"return": 2,
							"blocks": [
								{
									"stmts": [
										{
											"type": "ResetLocalStmt",
											"stmt": {
												"target": 3,
												"file": 0,
												"col": 1,
												"row": 3
											}
										},
										{
											"type": "MakeObjectStmt",
											"stmt": {
												"target": 4,
												"file": 0,
												"col": 1,
												"row": 3
											}
										},
										{
											"type": "MakeObjectStmt",
											"stmt": {
												"target": 5,
												"file": 0,
												"col": 1,
												"row": 3
											}
										},
										{
											"type": "ObjectInsertStmt",
											"stmt": {
												"key": {
													"type": "string_index",
													"value": 2
												},
												"value": {
													"type": "string_index",
													"value": 3
												},
												"object": 5,
												"file": 0,
												"col": 1,
												"row": 3
											}
										},
										{
											"type": "ObjectInsertStmt",
											"stmt": {
												"key": {
													"type": "string_index",
													"value": 1
												},
												"value": {
													"type": "local",
													"value": 5
												},
												"object": 4,
												"file": 0,
												"col": 1,
												"row": 3
											}
										},
										{
											"type": "ObjectInsertStmt",
											"stmt": {
												"key": {
													"type": "string_index",
													"value": 4
												},
												"value": {
													"type": "string_index",
													"value": 5
												},
												"object": 4,
												"file": 0,
												"col": 1,
												"row": 3
											}
										},
										{
											"type": "ObjectInsertStmt",
											"stmt": {
												"key": {
													"type": "string_index",
													"value": 6
												},
												"value": {
													"type": "string_index",
													"value": 7
												},
												"object": 4,
												"file": 0,
												"col": 1,
												"row": 3
											}
										},
										{
											"type": "AssignVarOnceStmt",
											"stmt": {
												"source": {
													"type": "local",
													"value": 4
												},
												"target": 3,
												"file": 0,
												"col": 1,
												"row": 3
											}
										}
									]
								},
								{
									"stmts": [
										{
											"type": "IsDefinedStmt",
											"stmt": {
												"source": 3,
												"file": 0,
												"col": 1,
												"row": 3
											}
										},
										{
											"type": "AssignVarOnceStmt",
											"stmt": {
												"source": {
													"type": "local",
													"value": 3
												},
												"target": 2,
												"file": 0,
												"col": 1,
												"row": 3
											}
										}
									]
								},
								{
									"stmts": [
										{
											"type": "ReturnLocalStmt",
											"stmt": {
												"source": 2,
												"file": 0,
												"col": 1,
												"row": 3
											}
										}
									]
								}
							],
							"path": [
								"g0",
								"test",
								"req"
							]
						},
						{
							"name": "g0.data.test.aws_config",
							"params": [
								0,
								1
							],
							"return": 2,
							"blocks": [
								{
									"stmts": [
										{
											"type": "ResetLocalStmt",
											"stmt": {
												"target": 3,
												"file": 0,
												"col": 1,
												"row": 5
											}
										},
										{
											"type": "MakeObjectStmt",
											"stmt": {
												"target": 4,
												"file": 0,
												"col": 1,
												"row": 5
											}
										},
										{
											"type": "ObjectInsertStmt",
											"stmt": {
												"key": {
													"type": "string_index",
													"value": 8
												},
												"value": {
													"type": "string_index",
													"value": 9
												},
												"object": 4,
												"file": 0,
												"col": 1,
												"row": 5
											}
										},
										{
											"type": "ObjectInsertStmt",
											"stmt": {
												"key": {
													"type": "string_index",
													"value": 10
												},
												"value": {
													"type": "string_index",
													"value": 11
												},
												"object": 4,
												"file": 0,
												"col": 1,
												"row": 5
											}
										},
										{
											"type": "ObjectInsertStmt",
											"stmt": {
												"key": {
													"type": "string_index",
													"value": 12
												},
												"value": {
													"type": "string_index",
													"value": 13
												},
												"object": 4,
												"file": 0,
												"col": 1,
												"row": 5
											}
										},
										{
											"type": "ObjectInsertStmt",
											"stmt": {
												"key": {
													"type": "string_index",
													"value": 14
												},
												"value": {
													"type": "string_index",
													"value": 15
												},
												"object": 4,
												"file": 0,
												"col": 1,
												"row": 5
											}
										},
										{
											"type": "ObjectInsertStmt",
											"stmt": {
												"key": {
													"type": "string_index",
													"value": 16
												},
												"value": {
													"type": "bool",
													"value": false
												},
												"object": 4,
												"file": 0,
												"col": 1,
												"row": 5
											}
										},
										{
											"type": "AssignVarOnceStmt",
											"stmt": {
												"source": {
													"type": "local",
													"value": 4
												},
												"target": 3,
												"file": 0,
												"col": 1,
												"row": 5
											}
										}
									]
								},
								{
									"stmts": [
										{
											"type": "IsDefinedStmt",
											"stmt": {
												"source": 3,
												"file": 0,
												"col": 1,
												"row": 5
											}
										},
										{
											"type": "AssignVarOnceStmt",
											"stmt": {
												"source": {
													"type": "local",
													"value": 3
												},
												"target": 2,
												"file": 0,
												"col": 1,
												"row": 5
											}
										}
									]
								},
								{
									"stmts": [
										{
											"type": "ReturnLocalStmt",
											"stmt": {
												"source": 2,
												"file": 0,
												"col": 1,
												"row": 5
											}
										}
									]
								}
							],
							"path": [
								"g0",
								"test",
								"aws_config"
							]
						},
						{
							"name": "g0.data.test.expected",
							"params": [
								0,
								1
							],
							"return": 2,
							"blocks": [
								{
									"stmts": [
										{
											"type": "ResetLocalStmt",
											"stmt": {
												"target": 3,
												"file": 0,
												"col": 1,
												"row": 7
											}
										},
										{
											"type": "MakeObjectStmt",
											"stmt": {
												"target": 4,
												"file": 0,
												"col": 1,
												"row": 7
											}
										},
										{
											"type": "MakeObjectStmt",
											"stmt": {
												"target": 5,
												"file": 0,
												"col": 1,
												"row": 7
											}
										},
										{
											"type": "ObjectInsertStmt",
											"stmt": {
												"key": {
													"type": "string_index",
													"value": 18
												},
												"value": {
													"type": "string_index",
													"value": 19
												},
												"object": 5,
												"file": 0,
												"col": 1,
												"row": 7
											}
										},
										{
											"type": "ObjectInsertStmt",
											"stmt": {
												"key": {
													"type": "string_index",
													"value": 2
												},
												"value": {
													"type": "string_index",
													"value": 3
												},
												"object": 5,
												"file": 0,
												"col": 1,
												"row": 7
											}
										},
										{
											"type": "ObjectInsertStmt",
											"stmt": {
												"key": {
													"type": "string_index",
													"value": 20
												},
												"value": {
													"type": "string_index",
													"value": 21
												},
												"object": 5,
												"file": 0,
												"col": 1,
												"row": 7
											}
										},
										{
											"type": "ObjectInsertStmt",
											"stmt": {
												"key": {
													"type": "string_index",
													"value": 22
												},
												"value": {
													"type": "string_index",
													"value": 23
												},
												"object": 5,
												"file": 0,
												"col": 1,
												"row": 7
											}
										},
										{
											"type": "ObjectInsertStmt",
											"stmt": {
												"key": {
													"type": "string_index",
													"value": 24
												},
												"value": {
													"type": "string_index",
													"value": 25
												},
												"object": 5,
												"file": 0,
												"col": 1,
												"row": 7
											}
										},
										{
											"type": "ObjectInsertStmt",
											"stmt": {
												"key": {
													"type": "string_index",
													"value": 1
												},
												"value": {
													"type": "local",
													"value": 5
												},
												"object": 4,
												"file": 0,
												"col": 1,
												"row": 7
											}
										},
										{
											"type": "ObjectInsertStmt",
											"stmt": {
												"key": {
													"type": "string_index",
													"value": 4
												},
												"value": {
													"type": "string_index",
													"value": 5
												},
												"object": 4,
												"file": 0,
												"col": 1,
												"row": 7
											}
										},
										{
											"type": "ObjectInsertStmt",
											"stmt": {
												"key": {
													"type": "string_index",
													"value": 6
												},
												"value": {
													"type": "string_index",
													"value": 7
												},
												"object": 4,
												"file": 0,
												"col": 1,
												"row": 7
											}
										},
										{
											"type": "AssignVarOnceStmt",
											"stmt": {
												"source": {
													"type": "local",
													"value": 4
												},
												"target": 3,
												"file": 0,
												"col": 1,
												"row": 7
											}
										}
									]
								},
								{
									"stmts": [
										{
											"type": "IsDefinedStmt",
											"stmt": {
												"source": 3,
												"file": 0,
												"col": 1,
												"row": 7
											}
										},
										{
											"type": "AssignVarOnceStmt",
											"stmt": {
												"source": {
													"type": "local",
													"value": 3
												},
												"target": 2,
												"file": 0,
												"col": 1,
												"row": 7
											}
										}
									]
								},
								{
									"stmts": [
										{
											"type": "ReturnLocalStmt",
											"stmt": {
												"source": 2,
												"file": 0,
												"col": 1,
												"row": 7
											}
										}
									]
								}
							],
							"path": [
								"g0",
								"test",
								"expected"
							]
						},
						{
							"name": "g0.data.test.p",
							"params": [
								0,
								1
							],
							"return": 2,
							"blocks": [
								{
									"stmts": [
										{
											"type": "ResetLocalStmt",
											"stmt": {
												"target": 3,
												"file": 0,
												"col": 1,
												"row": 19
											}
										},
										{
											"type": "CallStmt",
											"stmt": {
												"func": "g0.data.test.req",
												"args": [
													{
														"type": "local",
														"value": 0
													},
													{
														"type": "local",
														"value": 1
													}
												],
												"result": 4,
												"file": 0,
												"col": 25,
												"row": 20
											}
										},
										{
											"type": "AssignVarStmt",
											"stmt": {
												"source": {
													"type": "local",
													"value": 4
												},
												"target": 5,
												"file": 0,
												"col": 25,
												"row": 20
											}
										},
										{
											"type": "CallStmt",
											"stmt": {
												"func": "g0.data.test.aws_config",
												"args": [
													{
														"type": "local",
														"value": 0
													},
													{
														"type": "local",
														"value": 1
													}
												],
												"result": 6,
												"file": 0,
												"col": 30,
												"row": 20
											}
										},
										{
											"type": "AssignVarStmt",
											"stmt": {
												"source": {
													"type": "local",
													"value": 6
												},
												"target": 7,
												"file": 0,
												"col": 30,
												"row": 20
											}
										},
										{
											"type": "MakeNumberRefStmt",
											"stmt": {
												"Index": 17,
												"target": 8,
												"file": 0,
												"col": 2,
												"row": 20
											}
										},
										{
											"type": "CallStmt",
											"stmt": {
												"func": "providers.aws.sign_req",
												"args": [
													{
														"type": "local",
														"value": 5
													},
													{
														"type": "local",
														"value": 7
													},
													{
														"type": "local",
														"value": 8
													}
												],
												"result": 9,
												"file": 0,
												"col": 2,
												"row": 20
											}
										},
										{
											"type": "AssignVarStmt",
											"stmt": {
												"source": {
													"type": "local",
													"value": 9
												},
												"target": 10,
												"file": 0,
												"col": 2,
												"row": 20
											}
										},
										{
											"type": "CallStmt",
											"stmt": {
												"func": "g0.data.test.expected",
												"args": [
													{
														"type": "local",
														"value": 0
													},
													{
														"type": "local",
														"value": 1
													}
												],
												"result": 11,
												"file": 0,
												"col": 2,
												"row": 20
											}
										},
										{
											"type": "EqualStmt",
											"stmt": {
												"a": {
													"type": "local",
													"value": 10
												},
												"b": {
													"type": "local",
													"value": 11
												},
												"file": 0,
												"col": 2,
												"row": 20
											}
										},
										{
											"type": "AssignVarOnceStmt",
											"stmt": {
												"source": {
													"type": "bool",
													"value": true
												},
												"target": 3,
												"file": 0,
												"col": 1,
												"row": 19
											}
										}
									]
								},
								{
									"stmts": [
										{
											"type": "IsDefinedStmt",
											"stmt": {
												"source": 3,
												"file": 0,
												"col": 1,
												"row": 19
											}
										},
										{
											"type": "AssignVarOnceStmt",
											"stmt": {
												"source": {
													"type": "local",
													"value": 3
												},
												"target": 2,
												"file": 0,
												"col": 1,
												"row": 19
											}
										}
									]
								},
								{
									"stmts": [
										{
											"type": "ReturnLocalStmt",
											"stmt": {
												"source": 2,
												"file": 0,
												"col": 1,
												"row": 19
											}
										}
									]
								}
							],
							"path": [
								"g0",
								"test",
								"p"
							]
						}
					]
				}
			},
			"want_plan_result": [
				{
					"x": true
				}
			]
		},
		{
			"note": "providers-aws-sign_req/success-simple-with-headers-no-body-no-payload-signing",
			"query": "data.test.p = x",
			"modules": [
				"package test\n\nreq := {\"method\": \"get\", \"url\": \"https://example.com\", \"headers\": {\"foo\": \"bar\"}}\n\naws_config := {\"aws_access_key\": \"MYAWSACCESSKEYGOESHERE\", \"aws_secret_access_key\": \"MYAWSSECRETACCESSKEYGOESHERE\", \"aws_service\": \"s3\", \"aws_region\": \"us-east-1\", \"disable_payload_signing\": true}\n\nexpected := {\n\t\"headers\": {\n\t\t\"Authorization\": \"AWS4-HMAC-SHA256 Credential=MYAWSACCESSKEYGOESHERE/20151228/us-east-1/s3/aws4_request,SignedHeaders=foo;host;x-amz-content-sha256;x-amz-date,Signature=c6e6db654e92172f71e18c714c123711de069ac6fd7df1348e5b28fd05532028\",\n\t\t\"foo\": \"bar\",\n\t\t\"host\": \"example.com\",\n\t\t\"x-amz-content-sha256\": \"UNSIGNED-PAYLOAD\",\n\t\t\"x-amz-date\": \"20151228T140825Z\",\n\t},\n\t\"method\": \"get\",\n\t\"url\": \"https://example.com\",\n}\n\np if {\n\tproviders.aws.sign_req(req, aws_config, 1451311705000000000) == expected\n}\n"
			],
			"want_result": [
				{
					"x": true
				}
			],
			"entrypoints": [
				"eval"
			],
			"plan": {
				"static": {
					"strings": [
						{
							"value": "x"
						},
						{
							"value": "headers"
						},
						{
							"value": "foo"
						},
						{
							"value": "bar"
						},
						{
							"value": "method"
						},
						{
							"value": "get"
						},
						{
							"value": "url"
						},
						{
							"value": "https://example.com"
						},
						{
							"value": "aws_access_key"
						},
						{
							"value": "MYAWSACCESSKEYGOESHERE"
						},
						{
							"value": "aws_region"
						},
						{
							"value": "us-east-1"
						},
						{
							"value": "aws_secret_access_key"
						},
						{
							"value": "MYAWSSECRETACCESSKEYGOESHERE"
						},
						{
							"value": "aws_service"
						},
						{
							"value": "s3"
						},
						{
							"value": "disable_payload_signing"
						},
						{
							"value": "1451311705000000000"
						},
						{
							"value": "Authorization"
						},
						{
							"value": "AWS4-HMAC-SHA256 Credential=MYAWSACCESSKEYGOESHERE/20151228/us-east-1/s3/aws4_request,SignedHeaders=foo;host;x-amz-content-sha256;x-amz-date,Signature=c6e6db654e92172f71e18c714c123711de069ac6fd7df1348e5b28fd05532028"
						},
						{
							"value": "host"
						},
						{
							"value": "example.com"
						},
						{
							"value": "x-amz-content-sha256"
						},
						{
							"value": "UNSIGNED-PAYLOAD"
						},
						{
							"value": "x-amz-date"
						},
						{
							"value": "20151228T140825Z"
						}
					],
					"builtin_funcs": [
						{
							"name": "providers.aws.sign_req",
							"decl": {
								"args": [
									{
										"description": "HTTP request object",
										"dynamic": {
											"key": {
												"type": "string"
											},
											"value": {
												"type": "any"
											}
										},
										"name": "request",
										"type": "object"
									},
									{
										"description": "AWS configuration object",
										"dynamic": {
											"key": {
												"type": "string"
											},
											"value": {
												"type": "any"
											}
										},
										"name": "aws_config",
										"type": "object"
									},
									{
										"description": "nanoseconds since the epoch",
										"name": "time_ns",
										"type": "number"
									}
								],
								"result": {
									"description": "HTTP request object with `Authorization` header",
									"dynamic": {
										"key": {
											"type": "any"
										},
										"value": {
											"type": "any"
										}
									},
									"name": "signed_request",
									"type": "object"
								},
								"type": "function"
							}
						}
					],
					"files": [
						{
							"value": "module-0.rego"
						},
						{
							"value": "\u003cquery\u003e"
						}
					]
				},
				"plans": {
					"plans": [
						{
							"name": "eval",
							"blocks": [
								{
									"stmts": [
										{
											"type": "CallStmt",
											"stmt": {
												"func": "g0.data.test.p",
												"args": [
													{
														"type": "local",
														"value": 0
													},
													{
														"type": "local",
														"value": 1
													}
												],
												"result": 2,
												"file": 1,
												"col": 1,
												"row": 1
											}
										},
										{
											"type": "AssignVarStmt",
											"stmt": {
												"source": {
													"type": "local",
													"value": 2
												},
												"target": 3,
												"file": 1,
												"col": 1,
												"row": 1
											}
										},
										{
											"type": "MakeObjectStmt",
											"stmt": {
												"target": 4,
												"file": 1,
												"col": 1,
												"row": 1
											}
										},
										{
											"type": "ObjectInsertStmt",
											"stmt": {
												"key": {
													"type": "string_index",
													"value": 0
												},
												"value": {
													"type": "local",
													"value": 3
												},
												"object": 4,
												"file": 1,
												"col": 1,
												"row": 1
											}
										},
										{
											"type": "ResultSetAddStmt",
											"stmt": {
												"value": 4,
												"file": 1,
												"col": 1,
												"row": 1
											}
										}
									]
								}
							]
						}
					]
				},
				"funcs": {
					"funcs": [
						{
							"name": "g0.data.test.req",
							"params": [
								0,
								1
							],
							"return": 2,
							"blocks": [
								{
									"stmts": [
										{
											"type": "ResetLocalStmt",
											"stmt": {
												"target": 3,
												"file": 0,
												"col": 1,
												"row": 3
											}
										},
										{
											"type": "MakeObjectStmt",
											"stmt": {
												"target": 4,
												"file": 0,
												"col": 1,
												"row": 3
											}
										},
										{
											"type": "MakeObjectStmt",
											"stmt": {
												"target": 5,
												"file": 0,
												"col": 1,
												"row": 3
											}
										},
										{
											"type": "ObjectInsertStmt",
											"stmt": {
												"key": {
													"type": "string_index",
													"value": 2
												},
												"value": {
													"type": "string_index",
													"value": 3
												},
												"object": 5,
												"file": 0,
												"col": 1,
												"row": 3
											}
										},
										{
											"type": "ObjectInsertStmt",
											"stmt": {
												"key": {
													"type": "string_index",
													"value": 1
												},
												"value": {
													"type": "local",
													"value": 5
												},
												"object": 4,
												"file": 0,
												"col": 1,
												"row": 3
											}
										},
										{
											"type": "ObjectInsertStmt",
											"stmt": {
												"key": {
													"type": "string_index",
													"value": 4
												},
												"value": {
													"type": "string_index",
													"value": 5
												},
												"object": 4,
												"file": 0,
												"col": 1,
												"row": 3
											}
										},
										{
											"type": "ObjectInsertStmt",
											"stmt": {
												"key": {
													"type": "string_index",
													"value": 6
												},
												"value": {
													"type": "string_index",
													"value": 7
												},
												"object": 4,
												"file": 0,
												"col": 1,
												"row": 3
											}
										},
										{
											"type": "AssignVarOnceStmt",
											"stmt": {
												"source": {
													"type": "local",
													"value": 4
												},
												"target": 3,
												"file": 0,
												"col": 1,
												"row": 3
											}
										}
									]
								},
								{
									"stmts": [
										{
											"type": "IsDefinedStmt",
											"stmt": {
												"source": 3,
												"file": 0,
												"col": 1,
												"row": 3
											}
										},
										{
											"type": "AssignVarOnceStmt",
											"stmt": {
												"source": {
													"type": "local",
													"value": 3
												},
												"target": 2,
												"file": 0,
												"col": 1,
												"row": 3
											}
										}
									]
								},
								{
									"stmts": [
										{
											"type": "ReturnLocalStmt",
											"stmt": {
												"source": 2,
												"file": 0,
												"col": 1,
												"row": 3
											}
										}
									]
								}
							],
							"path": [
								"g0",
								"test",
								"req"
							]
						},
						{
							"name": "g0.data.test.aws_config",
							"params": [
								0,
								1
							],
							"return": 2,
							"blocks": [
								{
									"stmts": [
										{
											"type": "ResetLocalStmt",
											"stmt": {
												"target": 3,
												"file": 0,
												"col": 1,
												"row": 5
											}
										},
										{
											"type": "MakeObjectStmt",
											"stmt": {
												"target": 4,
												"file": 0,
												"col": 1,
												"row": 5
											}
										},
										{
											"type": "ObjectInsertStmt",
											"stmt": {
												"key": {
													"type": "string_index",
													"value": 8
												},
												"value": {
													"type": "string_index",
													"value": 9
												},
												"object": 4,
												"file": 0,
												"col": 1,
												"row": 5
											}
										},
										{
											"type": "ObjectInsertStmt",
											"stmt": {
												"key": {
													"type": "string_index",
													"value": 10
												},
												"value": {
													"type": "string_index",
													"value": 11
												},
												"object": 4,
												"file": 0,
												"col": 1,
												"row": 5
											}
										},
										{
											"type": "ObjectInsertStmt",
											"stmt": {
												"key": {
													"type": "string_index",
													"value": 12
												},
												"value": {
													"type": "string_index",
													"value": 13
												},
												"object": 4,
												"file": 0,
												"col": 1,
												"row": 5
											}
										},
										{
											"type": "ObjectInsertStmt",
											"stmt": {
												"key": {
													"type": "string_index",
													"value": 14
												},
												"value": {
													"type": "string_index",
													"value": 15
												},
												"object": 4,
												"file": 0,
												"col": 1,
												"row": 5
											}
										},
										{
											"type": "ObjectInsertStmt",
											"stmt": {
												"key": {
													"type": "string_index",
													"value": 16
												},
												"value": {
													"type": "bool",
													"value": true
												},
												"object": 4,
												"file": 0,
												"col": 1,
												"row": 5
											}
										},
										{
											"type": "AssignVarOnceStmt",
											"stmt": {
												"source": {
													"type": "local",
													"value": 4
												},
												"target": 3,
												"file": 0,
												"col": 1,
												"row": 5
											}
										}
									]
								},
								{
									"stmts": [
										{
											"type": "IsDefinedStmt",
											"stmt": {
												"source": 3,
												"file": 0,
												"col": 1,
												"row": 5
											}
										},
										{
											"type": "AssignVarOnceStmt",
											"stmt": {
												"source": {
													"type": "local",
													"value": 3
												},
												"target": 2,
												"file": 0,
												"col": 1,
												"row": 5
											}
										}
									]
								},
								{
									"stmts": [
										{
											"type": "ReturnLocalStmt",
											"stmt": {
												"source": 2,
												"file": 0,
												"col": 1,
												"row": 5
											}
										}
									]
								}
							],
							"path": [
								"g0",
								"test",
								"aws_config"
							]
						},
						{
							"name": "g0.data.test.expected",
							"params": [
								0,
								1
							],
							"return": 2,
							"blocks": [
								{
									"stmts": [
										{
											"type": "ResetLocalStmt",
											"stmt": {
												"target": 3,
												"file": 0,
												"col": 1,
												"row": 7
											}
										},
										{
											"type": "MakeObjectStmt",
											"stmt": {
												"target": 4,
												"file": 0,
												"col": 1,
												"row": 7
											}
										},
										{
											"type": "MakeObjectStmt",
											"stmt": {
												"target": 5,
												"file": 0,
												"col": 1,
												"row": 7
											}
										},
										{
											"type": "ObjectInsertStmt",
											"stmt": {
												"key": {
													"type": "string_index",
													"value": 18
												},
												"value": {
													"type": "string_index",
													"value": 19
												},
												"object": 5,
												"file": 0,
												"col": 1,
												"row": 7
											}
										},
										{
											"type": "ObjectInsertStmt",
											"stmt": {
												"key": {
													"type": "string_index",
													"value": 2
												},
												"value": {
													"type": "string_index",
													"value": 3
												},
												"object": 5,
												"file": 0,
												"col": 1,
												"row": 7
											}
										},
										{
											"type": "ObjectInsertStmt",
											"stmt": {
												"key": {
													"type": "string_index",
													"value": 20
												},
												"value": {
													"type": "string_index",
													"value": 21
												},
												"object": 5,
												"file": 0,
												"col": 1,
												"row": 7
											}
										},
										{
											"type": "ObjectInsertStmt",
											"stmt": {
												"key": {
													"type": "string_index",
													"value": 22
												},
												"value": {
													"type": "string_index",
													"value": 23
												},
												"object": 5,
												"file": 0,
												"col": 1,
												"row": 7
											}
										},
										{
											"type": "ObjectInsertStmt",
											"stmt": {
												"key": {
													"type": "string_index",
													"value": 24
												},
												"value": {
													"type": "string_index",
													"value": 25
												},
												"object": 5,
												"file": 0,
												"col": 1,
												"row": 7
											}
										},
										{
											"type": "ObjectInsertStmt",
											"stmt": {
												"key": {
													"type": "string_index",
													"value": 1
												},
												"value": {
													"type": "local",
													"value": 5
												},
												"object": 4,
												"file": 0,
												"col": 1,
												"row": 7
											}
										},
										{
											"type": "ObjectInsertStmt",
											"stmt": {
												"key": {
													"type": "string_index",
													"value": 4
												},
												"value": {
													"type": "string_index",
													"value": 5
												},
												"object": 4,
												"file": 0,
												"col": 1,
												"row": 7
											}
										},
										{
											"type": "ObjectInsertStmt",
											"stmt": {
												"key": {
													"type": "string_index",
													"value": 6
												},
												"value": {
													"type": "string_index",
													"value": 7
												},
												"object": 4,
												"file": 0,
												"col": 1,
												"row": 7
											}
										},
										{
											"type": "AssignVarOnceStmt",
											"stmt": {
												"source": {
													"type": "local",
													"value": 4
												},
												"target": 3,
												"file": 0,
												"col": 1,
												"row": 7
											}
										}
									]
								},
								{
									"stmts": [
										{
											"type": "IsDefinedStmt",
											"stmt": {
												"source": 3,
												"file": 0,
												"col": 1,
												"row": 7
											}
										},
										{
											"type": "AssignVarOnceStmt",
											"stmt": {
												"source": {
													"type": "local",
													"value": 3
												},
												"target": 2,
												"file": 0,
												"col": 1,
												"row": 7
											}
										}
									]
								},
								{
									"stmts": [
										{
											"type": "ReturnLocalStmt",
											"stmt": {
												"source": 2,
												"file": 0,
												"col": 1,
												"row": 7
											}
										}
									]
								}
							],
							"path": [
								"g0",
								"test",
								"expected"
							]
						},
						{
							"name": "g0.data.test.p",
							"params": [
								0,
								1
							],
							"return": 2,
							"blocks": [
								{
									"stmts": [
										{
											"type": "ResetLocalStmt",
											"stmt": {
												"target": 3,
												"file": 0,
												"col": 1,
												"row": 19
											}
										},
										{
											"type": "CallStmt",
											"stmt": {
												"func": "g0.data.test.req",
												"args": [
													{
														"type": "local",
														"value": 0
													},
													{
														"type": "local",
														"value": 1
													}
												],
												"result": 4,
												"file": 0,
												"col": 25,
												"row": 20
											}
										},
										{
											"type": "AssignVarStmt",
											"stmt": {
												"source": {
													"type": "local",
													"value": 4
												},
												"target": 5,
												"file": 0,
												"col": 25,
												"row": 20
											}
										},
										{
											"type": "CallStmt",
											"stmt": {
												"func": "g0.data.test.aws_config",
												"args": [
													{
														"type": "local",
														"value": 0
													},
													{
														"type": "local",
														"value": 1
													}
												],
												"result": 6,
												"file": 0,
												"col": 30,
												"row": 20
											}
										},
										{
											"type": "AssignVarStmt",
											"stmt": {
												"source": {
													"type": "local",
													"value": 6
												},
												"target": 7,
												"file": 0,
												"col": 30,
												"row": 20
											}
										},
										{
											"type": "MakeNumberRefStmt",
											"stmt": {
												"Index": 17,
												"target": 8,
												"file": 0,
												"col": 2,
												"row": 20
											}
										},
										{
											"type": "CallStmt",
											"stmt": {
												"func": "providers.aws.sign_req",
												"args": [
													{
														"type": "local",
														"value": 5
													},
													{
														"type": "local",
														"value": 7
													},
													{
														"type": "local",
														"value": 8
													}
												],
												"result": 9,
												"file": 0,
												"col": 2,
												"row": 20
											}
										},
										{
											"type": "AssignVarStmt",
											"stmt": {
												"source": {
													"type": "local",
													"value": 9
												},
												"target": 10,
												"file": 0,
												"col": 2,
												"row": 20
											}
										},
										{
											"type": "CallStmt",
											"stmt": {
												"func": "g0.data.test.expected",
												"args": [
													{
														"type": "local",
														"value": 0
													},
													{
														"type": "local",
														"value": 1
													}
												],
												"result": 11,
												"file": 0,
												"col": 2,
												"row": 20
											}
										},
										{
											"type": "EqualStmt",
											"stmt": {
												"a": {
													"type": "local",
													"value": 10
												},
												"b": {
													"type": "local",
													"value": 11
												},
												"file": 0,
												"col": 2,
												"row": 20
											}
										},
										{
											"type": "AssignVarOnceStmt",
											"stmt": {
												"source": {
													"type": "bool",
													"value": true
												},
												"target": 3,
												"file": 0,
												"col": 1,
												"row": 19
											}
										}
									]
								},
								{
									"stmts": [
										{
											"type": "IsDefinedStmt",
											"stmt": {
												"source": 3,
												"file": 0,
												"col": 1,
												"row": 19
											}
										},
										{
											"type": "AssignVarOnceStmt",
											"stmt": {
												"source": {
													"type": "local",
													"value": 3
												},
												"target": 2,
												"file": 0,
												"col": 1,
												"row": 19
											}
										}
									]
								},
								{
									"stmts": [
										{
											"type": "ReturnLocalStmt",
											"stmt": {
												"source": 2,
												"file": 0,
												"col": 1,
												"row": 19
											}
										}
									]
								}
							],
							"path": [
								"g0",
								"test",
								"p"
							]
						}
					]
				}
			},
			"want_plan_result": [
				{
					"x": true
				}
			]
		},
		{
			"note": "providers-aws-sign_req/success-simple-with-headers-with-body-with-payload-signing",
			"query": "data.test.p = x",
			"modules": [
				"package test\n\nreq := {\"method\": \"get\", \"url\": \"https://example.com\", \"headers\": {\"foo\": \"bar\"}, \"body\": {\"example\": {1, 2, 3, 4}}}\n\naws_config := {\"aws_access_key\": \"MYAWSACCESSKEYGOESHERE\", \"aws_secret_access_key\": \"MYAWSSECRETACCESSKEYGOESHERE\", \"aws_service\": \"s3\", \"aws_region\": \"us-east-1\", \"disable_payload_signing\": false}\n\nexpected := {\n\t\"body\": {\"example\": {1, 2, 3, 4}},\n\t\"headers\": {\n\t\t\"Authorization\": \"AWS4-HMAC-SHA256 Credential=MYAWSACCESSKEYGOESHERE/20151228/us-east-1/s3/aws4_request,SignedHeaders=foo;host;x-amz-content-sha256;x-amz-date,Signature=f6703a8727ec0a32f81b225a002f622e511e8a7d2ca8914894fcbb7a71d8d9d8\",\n\t\t\"foo\": \"bar\",\n\t\t\"host\": \"example.com\",\n\t\t\"x-amz-content-sha256\": \"bacff6243c850423883052ac3c336fd645994442933408dfd3f9e858e69bda07\",\n\t\t\"x-amz-date\": \"20151228T140825Z\",\n\t},\n\t\"method\": \"get\",\n\t\"url\": \"https://example.com\",\n}\n\np if {\n\tproviders.aws.sign_req(req, aws_config, 1451311705000000000) == expected\n}\n"
			],
			"want_result": [
				{
					"x": true
				}
			],
			"entrypoints": [
				"eval"
			],
			"plan": {
				"static": {
					"strings": [
						{
							"value": "x"
						},
						{
							"value": "body"
						},
						{
							"value": "example"
						},
						{
							"value": "1"
						},
						{
							"value": "2"
						},
						{
							"value": "3"
						},
						{
							"value": "4"
						},
						{
							"value": "headers"
						},
						{
							"value": "foo"
						},
						{
							"value": "bar"
						},
						{
							"value": "method"
						},
						{
							"value": "get"
						},
						{
							"value": "url"
						},
						{
							"value": "https://example.com"
						},
						{
							"value": "aws_access_key"
						},
						{
							"value": "MYAWSACCESSKEYGOESHERE"
						},
						{
							"value": "aws_region"
						},
						{
							"value": "us-east-1"
						},
						{
							"value": "aws_secret_access_key"
						},
						{
							"value": "MYAWSSECRETACCESSKEYGOESHERE"
						},
						{
							"value": "aws_service"
						},
						{
							"value": "s3"
						},
						{
							"value": "disable_payload_signing"
						},
						{
							"value": "1451311705000000000"
						},
						{
							"value": "Authorization"
						},
						{
							"value": "AWS4-HMAC-SHA256 Credential=MYAWSACCESSKEYGOESHERE/20151228/us-east-1/s3/aws4_request,SignedHeaders=foo;host;x-amz-content-sha256;x-amz-date,Signature=f6703a8727ec0a32f81b225a002f622e511e8a7d2ca8914894fcbb7a71d8d9d8"
						},
						{
							"value": "host"
						},
						{
							"value": "example.com"
						},
						{
							"value": "x-amz-content-sha256"
						},
						{
							"value": "bacff6243c850423883052ac3c336fd645994442933408dfd3f9e858e69bda07"
						},
						{
							"value": "x-amz-date"
						},
						{
							"value": "20151228T140825Z"
						}
					],
					"builtin_funcs": [
						{
							"name": "providers.aws.sign_req",
							"decl": {
								"args": [
									{
										"description": "HTTP request object",
										"dynamic": {
											"key": {
												"type": "string"
											},
											"value": {
												"type": "any"
											}
										},
										"name": "request",
										"type": "object"
									},
									{
										"description": "AWS configuration object",
										"dynamic": {
											"key": {
												"type": "string"
											},
											"value": {
												"type": "any"
											}
										},
										"name": "aws_config",
										"type": "object"
									},
									{
										"description": "nanoseconds since the epoch",
										"name": "time_ns",
										"type": "number"
									}
								],
								"result": {
									"description": "HTTP request object with `Authorization` header",
									"dynamic": {
										"key": {
											"type": "any"
										},
										"value": {
											"type": "any"
										}
									},
									"name": "signed_request",
									"type": "object"
								},
								"type": "function"
							}
						}
					],
					"files": [
						{
							"value": "module-0.rego"
						},
						{
							"value": "\u003cquery\u003e"
						}
					]
				},
				"plans": {
					"plans": [
						{
							"name": "eval",
							"blocks": [
								{
									"stmts": [
										{
											"type": "CallStmt",
											"stmt": {
												"func": "g0.data.test.p",
												"args": [
													{
														"type": "local",
														"value": 0
													},
													{
														"type": "local",
														"value": 1
													}
												],
												"result": 2,
												"file": 1,
												"col": 1,
												"row": 1
											}
										},
										{
											"type": "AssignVarStmt",
											"stmt": {
												"source": {
													"type": "local",
													"value": 2
												},
												"target": 3,
												"file": 1,
												"col": 1,
												"row": 1
											}
										},
										{
											"type": "MakeObjectStmt",
											"stmt": {
												"target": 4,
												"file": 1,
												"col": 1,
												"row": 1
											}
										},
										{
											"type": "ObjectInsertStmt",
											"stmt": {
												"key": {
													"type": "string_index",
													"value": 0
												},
												"value": {
													"type": "local",
													"value": 3
												},
												"object": 4,
												"file": 1,
												"col": 1,
												"row": 1
											}
										},
										{
											"type": "ResultSetAddStmt",
											"stmt": {
												"value": 4,
												"file": 1,
												"col": 1,
												"row": 1
											}
										}
									]
								}
							]
						}
					]
				},
				"funcs": {
					"funcs": [
						{
							"name": "g0.data.test.req",
							"params": [
								0,
								1
							],
							"return": 2,
							"blocks": [
								{
									"stmts": [
										{
											"type": "ResetLocalStmt",
											"stmt": {
												"target": 3,
												"file": 0,
												"col": 1,
												"row": 3
											}
										},
										{
											"type": "MakeObjectStmt",
											"stmt": {
												"target": 4,
												"file": 0,
												"col": 1,
												"row": 3
											}
										},
										{
											"type": "MakeObjectStmt",
											"stmt": {
												"target": 5,
												"file": 0,
												"col": 1,
												"row": 3
											}
										},
										{
											"type": "MakeSetStmt",
											"stmt": {
												"target": 6,
												"file": 0,
												"col": 1,
												"row": 3
											}
										},
										{
											"type": "MakeNumberRefStmt",
											"stmt": {
												"Index": 3,
												"target": 7,
												"file": 0,
												"col": 1,
												"row": 3
											}
										},
										{
											"type": "SetAddStmt",
											"stmt": {
												"value": {
													"type": "local",
													"value": 7
												},
												"set": 6,
												"file": 0,
												"col": 1,
												"row": 3
											}
										},
										{
											"type": "MakeNumberRefStmt",
											"stmt": {
												"Index": 4,
												"target": 8,
												"file": 0,
												"col": 1,
												"row": 3
											}
										},
										{
											"type": "SetAddStmt",
											"stmt": {
												"value": {
													"type": "local",
													"value": 8
												},
												"set": 6,
												"file": 0,
												"col": 1,
												"row": 3
											}
										},
										{
											"type": "MakeNumberRefStmt",
											"stmt": {
												"Index": 5,
												"target": 9,
												"file": 0,
												"col": 1,
												"row": 3
											}
										},
										{
											"type": "SetAddStmt",
											"stmt": {
												"value": {
													"type": "local",
													"value": 9
												},
												"set": 6,
												"file": 0,
												"col": 1,
												"row": 3
											}
										},
										{
											"type": "MakeNumberRefStmt",
											"stmt": {
												"Index": 6,
												"target": 10,
												"file": 0,
												"col": 1,
												"row": 3
											}
										},
										{
											"type": "SetAddStmt",
											"stmt": {
												"value": {
													"type": "local",
													"value": 10
												},
												"set": 6,
												"file": 0,
												"col": 1,
												"row": 3
											}
										},
										{
											"type": "ObjectInsertStmt",
											"stmt": {
												"key": {
													"type": "string_index",
													"value": 2
												},
												"value": {
													"type": "local",
													"value": 6
												},
												"object": 5,
												"file": 0,
												"col": 1,
												"row": 3
											}
										},
										{
											"type": "ObjectInsertStmt",
											"stmt": {
												"key": {
													"type": "string_index",
													"value": 1
												},
												"value": {
													"type": "local",
													"value": 5
												},
												"object": 4,
												"file": 0,
												"col": 1,
												"row": 3
											}
										},
										{
											"type": "MakeObjectStmt",
											"stmt": {
												"target": 11,
												"file": 0,
												"col": 1,
												"row": 3
											}
										},
										{
											"type": "ObjectInsertStmt",
											"stmt": {
												"key": {
													"type": "string_index",
													"value": 8
												},
												"value": {
													"type": "string_index",
													"value": 9
												},
												"object": 11,
												"file": 0,
												"col": 1,
												"row": 3
											}
										},
										{
											"type": "ObjectInsertStmt",
											"stmt": {
												"key": {
													"type": "string_index",
													"value": 7
												},
												"value": {
													"type": "local",
													"value": 11
												},
												"object": 4,
												"file": 0,
												"col": 1,
												"row": 3
											}
										},
										{
											"type": "ObjectInsertStmt",
											"stmt": {
												"key": {
													"type": "string_index",
													"value": 10
												},
												"value": {
													"type": "string_index",
													"value": 11
												},
												"object": 4,
												"file": 0,
												"col": 1,
												"row": 3
											}
										},
										{
											"type": "ObjectInsertStmt",
											"stmt": {
												"key": {
													"type": "string_index",
													"value": 12
												},
												"value": {
													"type": "string_index",
													"value": 13
												},
												"object": 4,
												"file": 0,
												"col": 1,
												"row": 3
											}
										},
										{
											"type": "AssignVarOnceStmt",
											"stmt": {
												"source": {
													"type": "local",
													"value": 4
												},
												"target": 3,
												"file": 0,
												"col": 1,
												"row": 3
											}
										}
									]
								},
								{
									"stmts": [
										{
											"type": "IsDefinedStmt",
											"stmt": {
												"source": 3,
												"file": 0,
												"col": 1,
												"row": 3
											}
										},
										{
											"type": "AssignVarOnceStmt",
											"stmt": {
												"source": {
													"type": "local",
													"value": 3
												},
												"target": 2,
												"file": 0,
												"col": 1,
												"row": 3
											}
										}
									]
								},
								{
									"stmts": [
										{
											"type": "ReturnLocalStmt",
											"stmt": {
												"source": 2,
												"file": 0,
												"col": 1,
												"row": 3
											}
										}
									]
								}
							],
							"path": [
								"g0",
								"test",
								"req"
							]
						},
						{
							"name": "g0.data.test.aws_config",
							"params": [
								0,
								1
							],
							"return": 2,
							"blocks": [
								{
									"stmts": [
										{
											"type": "ResetLocalStmt",
											"stmt": {
												"target": 3,
												"file": 0,
												"col": 1,
												"row": 5
											}
										},
										{
											"type": "MakeObjectStmt",
											"stmt": {
												"target": 4,
												"file": 0,
												"col": 1,
												"row": 5
											}
										},
										{
											"type": "ObjectInsertStmt",
											"stmt": {
												"key": {
													"type": "string_index",
													"value": 14
												},
												"value": {
													"type": "string_index",
													"value": 15
												},
												"object": 4,
												"file": 0,
												"col": 1,
												"row": 5
											}
										},
										{
											"type": "ObjectInsertStmt",
											"stmt": {
												"key": {
													"type": "string_index",
													"value": 16
												},
												"value": {
													"type": "string_index",
													"value": 17
												},
												"object": 4,
												"file": 0,
												"col": 1,
												"row": 5
											}
										},
										{
											"type": "ObjectInsertStmt",
											"stmt": {
												"key": {
													"type": "string_index",
													"value": 18
												},
												"value": {
													"type": "string_index",
													"value": 19
												},
												"object": 4,
												"file": 0,
												"col": 1,
												"row": 5
											}
										},
										{
											"type": "ObjectInsertStmt",
											"stmt": {
												"key": {
													"type": "string_index",
													"value": 20
												},
												"value": {
													"type": "string_index",
													"value": 21
												},
												"object": 4,
												"file": 0,
												"col": 1,
												"row": 5
											}
										},
										{
											"type": "ObjectInsertStmt",
											"stmt": {
												"key": {
													"type": "string_index",
													"value": 22
												},
												"value": {
													"type": "bool",
													"value": false
												},
												"object": 4,
												"file": 0,
												"col": 1,
												"row": 5
											}
										},
										{
											"type": "AssignVarOnceStmt",
											"stmt": {
												"source": {
													"type": "local",
													"value": 4
												},
												"target": 3,
												"file": 0,
												"col": 1,
												"row": 5
											}
										}
									]
								},
								{
									"stmts": [
										{
											"type": "IsDefinedStmt",
											"stmt": {
												"source": 3,
												"file": 0,
												"col": 1,
												"row": 5
											}
										},
										{
											"type": "AssignVarOnceStmt",
											"stmt": {
												"source": {
													"type": "local",
													"value": 3
												},
												"target": 2,
												"file": 0,
												"col": 1,
												"row": 5
											}
										}
									]
								},
								{
									"stmts": [
										{
											"type": "ReturnLocalStmt",
											"stmt": {
												"source": 2,
												"file": 0,
												"col": 1,
												"row": 5
											}
										}
									]
								}
							],
							"path": [
								"g0",
								"test",
								"aws_config"
							]
						},
						{
							"name": "g0.data.test.expected",
							"params": [
								0,
								1
							],
							"return": 2,
							"blocks": [
								{
									"stmts": [
										{
											"type": "ResetLocalStmt",
											"stmt": {
												"target": 3,
												"file": 0,
												"col": 1,
												"row": 7
											}
										},
										{
											"type": "MakeObjectStmt",
											"stmt": {
												"target": 4,
												"file": 0,
												"col": 1,
												"row": 7
											}
										},
										{
											"type": "MakeObjectStmt",
											"stmt": {
												"target": 5,
												"file": 0,
												"col": 1,
												"row": 7
											}
										},
										{
											"type": "MakeSetStmt",
											"stmt": {
												"target": 6,
												"file": 0,
												"col": 1,
												"row": 7
											}
										},
										{
											"type": "MakeNumberRefStmt",
											"stmt": {
												"Index": 3,
												"target": 7,
												"file": 0,
												"col": 1,
												"row": 7
											}
										},
										{
											"type": "SetAddStmt",
											"stmt": {
												"value": {
													"type": "local",
													"value": 7
												},
												"set": 6,
												"file": 0,
												"col": 1,
												"row": 7
											}
										},
										{
											"type": "MakeNumberRefStmt",
											"stmt": {
												"Index": 4,
												"target": 8,
												"file": 0,
												"col": 1,
												"row": 7
											}
										},
										{
											"type": "SetAddStmt",
											"stmt": {
												"value": {
													"type": "local",
													"value": 8
												},
												"set": 6,
												"file": 0,
												"col": 1,
												"row": 7
											}
										},
										{
											"type": "MakeNumberRefStmt",
											"stmt": {
												"Index": 5,
												"target": 9,
												"file": 0,
												"col": 1,
												"row": 7
											}
										},
										{
											"type": "SetAddStmt",
											"stmt": {
												"value": {
													"type": "local",
													"value": 9
												},
												"set": 6,
												"file": 0,
												"col": 1,
												"row": 7
											}
										},
										{
											"type": "MakeNumberRefStmt",
											"stmt": {
												"Index": 6,
												"target": 10,
												"file": 0,
												"col": 1,
												"row": 7
											}
										},
										{
											"type": "SetAddStmt",
											"stmt": {
												"value": {
													"type": "local",
													"value": 10
												},
												"set": 6,
												"file": 0,
												"col": 1,
												"row": 7
											}
										},
										{
											"type": "ObjectInsertStmt",
											"stmt": {
												"key": {
													"type": "string_index",
													"value": 2
												},
												"value": {
													"type": "local",
													"value": 6
												},
												"object": 5,
												"file": 0,
												"col": 1,
												"row": 7
											}
										},
										{
											"type": "ObjectInsertStmt",
											"stmt": {
												"key": {
													"type": "string_index",
													"value": 1
												},
												"value": {
													"type": "local",
													"value": 5
												},
												"object": 4,
												"file": 0,
												"col": 1,
												"row": 7
											}
										},
										{
											"type": "MakeObjectStmt",
											"stmt": {
												"target": 11,
												"file": 0,
												"col": 1,
												"row": 7
											}
										},
										{
											"type": "ObjectInsertStmt",
											"stmt": {
												"key": {
													"type": "string_index",
													"value": 24
												},
												"value": {
													"type": "string_index",
													"value": 25
												},
												"object": 11,
												"file": 0,
												"col": 1,
												"row": 7
											}
										},
										{
											"type": "ObjectInsertStmt",
											"stmt": {
												"key": {
													"type": "string_index",
													"value": 8
												},
												"value": {
													"type": "string_index",
													"value": 9
												},
												"object": 11,
												"file": 0,
												"col": 1,
												"row": 7
											}
										},
										{
											"type": "ObjectInsertStmt",
											"stmt": {
												"key": {
													"type": "string_index",
													"value": 26
												},
												"value": {
													"type": "string_index",
													"value": 27
												},
												"object": 11,
												"file": 0,
												"col": 1,
												"row": 7
											}
										},
										{
											"type": "ObjectInsertStmt",
											"stmt": {
												"key": {
													"type": "string_index",
													"value": 28
												},
												"value": {
													"type": "string_index",
													"value": 29
												},
												"object": 11,
												"file": 0,
												"col": 1,
												"row": 7
											}
										},
										{
											"type": "ObjectInsertStmt",
											"stmt": {
												"key": {
													"type": "string_index",
													"value": 30
												},
												"value": {
													"type": "string_index",
													"value": 31
												},
												"object": 11,
												"file": 0,
												"col": 1,
												"row": 7
											}
										},
										{
											"type": "ObjectInsertStmt",
											"stmt": {
												"key": {
													"type": "string_index",
													"value": 7
												},
												"value": {
													"type": "local",
													"value": 11
												},
												"object": 4,
												"file": 0,
												"col": 1,
												"row": 7
											}
										},
										{
											"type": "ObjectInsertStmt",
											"stmt": {
												"key": {
													"type": "string_index",
													"value": 10
												},
												"value": {
													"type": "string_index",
													"value": 11
												},
												"object": 4,
												"file": 0,
												"col": 1,
												"row": 7
											}
										},
										{
											"type": "ObjectInsertStmt",
											"stmt": {
												"key": {
													"type": "string_index",
													"value": 12
												},
												"value": {
													"type": "string_index",
													"value": 13
												},
												"object": 4,
												"file": 0,
												"col": 1,
												"row": 7
											}
										},
										{
											"type": "AssignVarOnceStmt",
											"stmt": {
												"source": {
													"type": "local",
													"value": 4
												},
												"target": 3,
												"file": 0,
												"col": 1,
												"row": 7
											}
										}
									]
								},
								{
									"stmts": [
										{
											"type": "IsDefinedStmt",
											"stmt": {
												"source": 3,
												"file": 0,
												"col": 1,
												"row": 7
											}
										},
										{
											"type": "AssignVarOnceStmt",
											"stmt": {
												"source": {
													"type": "local",
													"value": 3
												},
												"target": 2,
												"file": 0,
												"col": 1,
												"row": 7
											}
										}
									]
								},
								{
									"stmts": [
										{
											"type": "ReturnLocalStmt",
											"stmt": {
												"source": 2,
												"file": 0,
												"col": 1,
												"row": 7
											}
										}
									]
								}
							],
							"path": [
								"g0",
								"test",
								"expected"
							]
						},
						{
							"name": "g0.data.test.p",
							"params": [
								0,
								1
							],
							"return": 2,
							"blocks": [
								{
									"stmts": [
										{
											"type": "ResetLocalStmt",
											"stmt": {
												"target": 3,
												"file": 0,
												"col": 1,
												"row": 20
											}
										},
										{
											"type": "CallStmt",
											"stmt": {
												"func": "g0.data.test.req",
												"args": [
													{
														"type": "local",
														"value": 0
													},
													{
														"type": "local",
														"value": 1
													}
												],
												"result": 4,
												"file": 0,
												"col": 25,
												"row": 21
											}
										},
										{
											"type": "AssignVarStmt",
											"stmt": {
												"source": {
													"type": "local",
													"value": 4
												},
												"target": 5,
												"file": 0,
												"col": 25,
												"row": 21
											}
										},
										{
											"type": "CallStmt",
											"stmt": {
												"func": "g0.data.test.aws_config",
												"args": [
													{
														"type": "local",
														"value": 0
													},
													{
														"type": "local",
														"value": 1
													}
												],
												"result": 6,
												"file": 0,
												"col": 30,
												"row": 21
											}
										},
										{
											"type": "AssignVarStmt",
											"stmt": {
												"source": {
													"type": "local",
													"value": 6
												},
												"target": 7,
												"file": 0,
												"col": 30,
												"row": 21
											}
										},
										{
											"type": "MakeNumberRefStmt",
											"stmt": {
												"Index": 23,
												"target": 8,
												"file": 0,
												"col": 2,
												"row": 21
											}
										},
										{
											"type": "CallStmt",
											"stmt": {
												"func": "providers.aws.sign_req",
												"args": [
													{
														"type": "local",
														"value": 5
													},
													{
														"type": "local",
														"value": 7
													},
													{
														"type": "local",
														"value": 8
													}
												],
												"result": 9,
												"file": 0,
												"col": 2,
												"row": 21
											}
										},
										{
											"type": "AssignVarStmt",
											"stmt": {
												"source": {
													"type": "local",
													"value": 9
												},
												"target": 10,
												"file": 0,
												"col": 2,
												"row": 21
											}
										},
										{
											"type": "CallStmt",
											"stmt": {
												"func": "g0.data.test.expected",
												"args": [
													{
														"type": "local",
														"value": 0
													},
													{
														"type": "local",
														"value": 1
													}
												],
												"result": 11,
												"file": 0,
												"col": 2,
												"row": 21
											}
										},
										{
											"type": "EqualStmt",
											"stmt": {
												"a": {
													"type": "local",
													"value": 10
												},
												"b": {
													"type": "local",
													"value": 11
												},
												"file": 0,
												"col": 2,
												"row": 21
											}
										},
										{
											"type": "AssignVarOnceStmt",
											"stmt": {
												"source": {
													"type": "bool",
													"value": true
												},
												"target": 3,
												"file": 0,
												"col": 1,
												"row": 20
											}
										}
									]
								},
								{
									"stmts": [
										{
											"type": "IsDefinedStmt",
											"stmt": {
												"source": 3,
												"file": 0,
												"col": 1,
												"row": 20
											}
										},
										{
											"type": "AssignVarOnceStmt",
											"stmt": {
												"source": {
													"type": "local",
													"value": 3
												},
												"target": 2,
												"file": 0,
												"col": 1,
												"row": 20
											}
										}
									]
								},
								{
									"stmts": [
										{
											"type": "ReturnLocalStmt",
											"stmt": {
												"source": 2,
												"file": 0,
												"col": 1,
												"row": 20
											}
										}
									]
								}
							],
							"path": [
								"g0",
								"test",
								"p"
							]
						}
					]
				}
			},
			"want_plan_result": [
				{
					"x": true
				}
			]
		},
		{
			"note": "providers-aws-sign_req/success-simple-with-headers-with-body-no-payload-signing",
			"query": "data.test.p = x",
			"modules": [
				"package test\n\nreq := {\"method\": \"get\", \"url\": \"https://example.com\", \"headers\": {\"foo\": \"bar\"}, \"body\": {\"example\": {1, 2, 3, 4}}}\n\naws_config := {\"aws_access_key\": \"MYAWSACCESSKEYGOESHERE\", \"aws_secret_access_key\": \"MYAWSSECRETACCESSKEYGOESHERE\", \"aws_service\": \"s3\", \"aws_region\": \"us-east-1\", \"disable_payload_signing\": true}\n\nexpected := {\n\t\"body\": {\"example\": {1, 2, 3, 4}},\n\t\"headers\": {\n\t\t\"Authorization\": \"AWS4-HMAC-SHA256 Credential=MYAWSACCESSKEYGOESHERE/20151228/us-east-1/s3/aws4_request,SignedHeaders=foo;host;x-amz-content-sha256;x-amz-date,Signature=c6e6db654e92172f71e18c714c123711de069ac6fd7df1348e5b28fd05532028\",\n\t\t\"foo\": \"bar\",\n\t\t\"host\": \"example.com\",\n\t\t\"x-amz-content-sha256\": \"UNSIGNED-PAYLOAD\",\n\t\t\"x-amz-date\": \"20151228T140825Z\",\n\t},\n\t\"method\": \"get\",\n\t\"url\": \"https://example.com\",\n}\n\np if {\n\tproviders.aws.sign_req(req, aws_config, 1451311705000000000) == expected\n}\n"
			],
			"want_result": [
				{
					"x": true
				}
			],
			"entrypoints": [
				"eval"
			],
			"plan": {
				"static": {
					"strings": [
						{
							"value": "x"
						},
						{
							"value": "body"
						},
						{
							"value": "example"
						},
						{
							"value": "1"
						},
						{
							"value": "2"
						},
						{
							"value": "3"
						},
						{
							"value": "4"
						},
						{
							"value": "headers"
						},
						{
							"value": "foo"
						},
						{
							"value": "bar"
						},
						{
							"value": "method"
						},
						{
							"value": "get"
						},
						{
							"value": "url"
						},
						{
							"value": "https://example.com"
						},
						{
							"value": "aws_access_key"
						},
						{
							"value": "MYAWSACCESSKEYGOESHERE"
						},
						{
							"value": "aws_region"
						},
						{
							"value": "us-east-1"
						},
						{
							"value": "aws_secret_access_key"
						},
						{
							"value": "MYAWSSECRETACCESSKEYGOESHERE"
						},
						{
							"value": "aws_service"
						},
						{
							"value": "s3"
						},
						{
							"value": "disable_payload_signing"
						},
						{
							"value": "1451311705000000000"
						},
						{
							"value": "Authorization"
						},
						{
							"value": "AWS4-HMAC-SHA256 Credential=MYAWSACCESSKEYGOESHERE/20151228/us-east-1/s3/aws4_request,SignedHeaders=foo;host;x-amz-content-sha256;x-amz-date,Signature=c6e6db654e92172f71e18c714c123711de069ac6fd7df1348e5b28fd05532028"
						},
						{
							"value": "host"
						},
						{
							"value": "example.com"
						},
						{
							"value": "x-amz-content-sha256"
						},
						{
							"value": "UNSIGNED-PAYLOAD"
						},
						{
							"value": "x-amz-date"
						},
						{
							"value": "20151228T140825Z"
						}
					],
					"builtin_funcs": [
						{
							"name": "providers.aws.sign_req",
							"decl": {
								"args": [
									{
										"description": "HTTP request object",
										"dynamic": {
											"key": {
												"type": "string"
											},
											"value": {
												"type": "any"
											}
										},
										"name": "request",
										"type": "object"
									},
									{
										"description": "AWS configuration object",
										"dynamic": {
											"key": {
												"type": "string"
											},
											"value": {
												"type": "any"
											}
										},
										"name": "aws_config",
										"type": "object"
									},
									{
										"description": "nanoseconds since the epoch",
										"name": "time_ns",
										"type": "number"
									}
								],
								"result": {
									"description": "HTTP request object with `Authorization` header",
									"dynamic": {
										"key": {
											"type": "any"
										},
										"value": {
											"type": "any"
										}
									},
									"name": "signed_request",
									"type": "object"
								},
								"type": "function"
							}
						}
					],
					"files": [
						{
							"value": "module-0.rego"
						},
						{
							"value": "\u003cquery\u003e"
						}
					]
				},
				"plans": {
					"plans": [
						{
							"name": "eval",
							"blocks": [
								{
									"stmts": [
										{
											"type": "CallStmt",
											"stmt": {
												"func": "g0.data.test.p",
												"args": [
													{
														"type": "local",
														"value": 0
													},
													{
														"type": "local",
														"value": 1
													}
												],
												"result": 2,
												"file": 1,
												"col": 1,
												"row": 1
											}
										},
										{
											"type": "AssignVarStmt",
											"stmt": {
												"source": {
													"type": "local",
													"value": 2
												},
												"target": 3,
												"file": 1,
												"col": 1,
												"row": 1
											}
										},
										{
											"type": "MakeObjectStmt",
											"stmt": {
												"target": 4,
												"file": 1,
												"col": 1,
												"row": 1
											}
										},
										{
											"type": "ObjectInsertStmt",
											"stmt": {
												"key": {
													"type": "string_index",
													"value": 0
												},
												"value": {
													"type": "local",
													"value": 3
												},
												"object": 4,
												"file": 1,
												"col": 1,
												"row": 1
											}
										},
										{
											"type": "ResultSetAddStmt",
											"stmt": {
												"value": 4,
												"file": 1,
												"col": 1,
												"row": 1
											}
										}
									]
								}
							]
						}
					]
				},
				"funcs": {
					"funcs": [
						{
							"name": "g0.data.test.req",
							"params": [
								0,
								1
							],
							"return": 2,
							"blocks": [
								{
									"stmts": [
										{
											"type": "ResetLocalStmt",
											"stmt": {
												"target": 3,
												"file": 0,
												"col": 1,
												"row": 3
											}
										},
										{
											"type": "MakeObjectStmt",
											"stmt": {
												"target": 4,
												"file": 0,
												"col": 1,
												"row": 3
											}
										},
										{
											"type": "MakeObjectStmt",
											"stmt": {
												"target": 5,
												"file": 0,
												"col": 1,
												"row": 3
											}
										},
										{
											"type": "MakeSetStmt",
											"stmt": {
												"target": 6,
												"file": 0,
												"col": 1,
												"row": 3
											}
										},
										{
											"type": "MakeNumberRefStmt",
											"stmt": {
												"Index": 3,
												"target": 7,
												"file": 0,
												"col": 1,
												"row": 3
											}
										},
										{
											"type": "SetAddStmt",
											"stmt": {
												"value": {
													"type": "local",
													"value": 7
												},
												"set": 6,
												"file": 0,
												"col": 1,
												"row": 3
											}
										},
										{
											"type": "MakeNumberRefStmt",
											"stmt": {
												"Index": 4,
												"target": 8,
												"file": 0,
												"col": 1,
												"row": 3
											}
										},
										{
											"type": "SetAddStmt",
											"stmt": {
												"value": {
													"type": "local",
													"value": 8
												},
												"set": 6,
												"file": 0,
												"col": 1,
												"row": 3
											}
										},
										{
											"type": "MakeNumberRefStmt",
											"stmt": {
												"Index": 5,
												"target": 9,
												"file": 0,
												"col": 1,
												"row": 3
											}
										},
										{
											"type": "SetAddStmt",
											"stmt": {
												"value": {
													"type": "local",
													"value": 9
												},
												"set": 6,
												"file": 0,
												"col": 1,
												"row": 3
											}
										},
										{
											"type": "MakeNumberRefStmt",
											"stmt": {
												"Index": 6,
												"target": 10,
												"file": 0,
												"col": 1,
												"row": 3
											}
										},
										{
											"type": "SetAddStmt",
											"stmt": {
												"value": {
													"type": "local",
													"value": 10
												},
												"set": 6,
												"file": 0,
												"col": 1,
												"row": 3
											}
										},
										{
											"type": "ObjectInsertStmt",
											"stmt": {
												"key": {
													"type": "string_index",
													"value": 2
												},
												"value": {
													"type": "local",
													"value": 6
												},
												"object": 5,
												"file": 0,
												"col": 1,
												"row": 3
											}
										},
										{
											"type": "ObjectInsertStmt",
											"stmt": {
												"key": {
													"type": "string_index",
													"value": 1
												},
												"value": {
													"type": "local",
													"value": 5
												},
												"object": 4,
												"file": 0,
												"col": 1,
												"row": 3
											}
										},
										{
											"type": "MakeObjectStmt",
											"stmt": {
												"target": 11,
												"file": 0,
												"col": 1,
												"row": 3
											}
										},
										{
											"type": "ObjectInsertStmt",
											"stmt": {
												"key": {
													"type": "string_index",
													"value": 8
												},
												"value": {
													"type": "string_index",
													"value": 9
												},
												"object": 11,
												"file": 0,
												"col": 1,
												"row": 3
											}
										},
										{
											"type": "ObjectInsertStmt",
											"stmt": {
												"key": {
													"type": "string_index",
													"value": 7
												},
												"value": {
													"type": "local",
													"value": 11
												},
												"object": 4,
												"file": 0,
												"col": 1,
												"row": 3
											}
										},
										{
											"type": "ObjectInsertStmt",
											"stmt": {
												"key": {
													"type": "string_index",
													"value": 10
												},
												"value": {
													"type": "string_index",
													"value": 11
												},
												"object": 4,
												"file": 0,
												"col": 1,
												"row": 3
											}
										},
										{
											"type": "ObjectInsertStmt",
											"stmt": {
												"key": {
													"type": "string_index",
													"value": 12
												},
												"value": {
													"type": "string_index",
													"value": 13
												},
												"object": 4,
												"file": 0,
												"col": 1,
												"row": 3
											}
										},
										{
											"type": "AssignVarOnceStmt",
											"stmt": {
												"source": {
													"type": "local",
													"value": 4
												},
												"target": 3,
												"file": 0,
												"col": 1,
												"row": 3
											}
										}
									]
								},
								{
									"stmts": [
										{
											"type": "IsDefinedStmt",
											"stmt": {
												"source": 3,
												"file": 0,
												"col": 1,
												"row": 3
											}
										},
										{
											"type": "AssignVarOnceStmt",
											"stmt": {
												"source": {
													"type": "local",
													"value": 3
												},
												"target": 2,
												"file": 0,
												"col": 1,
												"row": 3
											}
										}
									]
								},
								{
									"stmts": [
										{
											"type": "ReturnLocalStmt",
											"stmt": {
												"source": 2,
												"file": 0,
												"col": 1,
												"row": 3
											}
										}
									]
								}
							],
							"path": [
								"g0",
								"test",
								"req"
							]
						},
						{
							"name": "g0.data.test.aws_config",
							"params": [
								0,
								1
							],
							"return": 2,
							"blocks": [
								{
									"stmts": [
										{
											"type": "ResetLocalStmt",
											"stmt": {
												"target": 3,
												"file": 0,
												"col": 1,
												"row": 5
											}
										},
										{
											"type": "MakeObjectStmt",
											"stmt": {
												"target": 4,
												"file": 0,
												"col": 1,
												"row": 5
											}
										},
										{
											"type": "ObjectInsertStmt",
											"stmt": {
												"key": {
													"type": "string_index",
													"value": 14
												},
												"value": {
													"type": "string_index",
													"value": 15
												},
												"object": 4,
												"file": 0,
												"col": 1,
												"row": 5
											}
										},
										{
											"type": "ObjectInsertStmt",
											"stmt": {
												"key": {
													"type": "string_index",
													"value": 16
												},
												"value": {
													"type": "string_index",
													"value": 17
												},
												"object": 4,
												"file": 0,
												"col": 1,
												"row": 5
											}
										},
										{
											"type": "ObjectInsertStmt",
											"stmt": {
												"key": {
													"type": "string_index",
													"value": 18
												},
												"value": {
													"type": "string_index",
													"value": 19
												},
												"object": 4,
												"file": 0,
												"col": 1,
												"row": 5
											}
										},
										{
											"type": "ObjectInsertStmt",
											"stmt": {
												"key": {
													"type": "string_index",
													"value": 20
												},
												"value": {
													"type": "string_index",
													"value": 21
												},
												"object": 4,
												"file": 0,
												"col": 1,
												"row": 5
											}
										},
										{
											"type": "ObjectInsertStmt",
											"stmt": {
												"key": {
													"type": "string_index",
													"value": 22
												},
												"value": {
													"type": "bool",
													"value": true
												},
												"object": 4,
												"file": 0,
												"col": 1,
												"row": 5
											}
										},
										{
											"type": "AssignVarOnceStmt",
											"stmt": {
												"source": {
													"type": "local",
													"value": 4
												},
												"target": 3,
												"file": 0,
												"col": 1,
												"row": 5
											}
										}
									]
								},
								{
									"stmts": [
										{
											"type": "IsDefinedStmt",
											"stmt": {
												"source": 3,
												"file": 0,
												"col": 1,
												"row": 5
											}
										},
										{
											"type": "AssignVarOnceStmt",
											"stmt": {
												"source": {
													"type": "local",
													"value": 3
												},
												"target": 2,
												"file": 0,
												"col": 1,
												"row": 5
											}
										}
									]
								},
								{
									"stmts": [
										{
											"type": "ReturnLocalStmt",
											"stmt": {
												"source": 2,
												"file": 0,
												"col": 1,
												"row": 5
											}
										}
									]
								}
							],
							"path": [
								"g0",
								"test",
								"aws_config"
							]
						},
						{
							"name": "g0.data.test.expected",
							"params": [
								0,
								1
							],
							"return": 2,
							"blocks": [
								{
									"stmts": [
										{
											"type": "ResetLocalStmt",
											"stmt": {
												"target": 3,
												"file": 0,
												"col": 1,
												"row": 7
											}
										},
										{
											"type": "MakeObjectStmt",
											"stmt": {
												"target": 4,
												"file": 0,
												"col": 1,
												"row": 7
											}
										},
										{
											"type": "MakeObjectStmt",
											"stmt": {
												"target": 5,
												"file": 0,
												"col": 1,
												"row": 7
											}
										},
										{
											"type": "MakeSetStmt",
											"stmt": {
												"target": 6,
												"file": 0,
												"col": 1,
												"row": 7
											}
										},
										{
											"type": "MakeNumberRefStmt",
											"stmt": {
												"Index": 3,
												"target": 7,
												"file": 0,
												"col": 1,
												"row": 7
											}
										},
										{
											"type": "SetAddStmt",
											"stmt": {
												"value": {
													"type": "local",
													"value": 7
												},
												"set": 6,
												"file": 0,
												"col": 1,
												"row": 7
											}
										},
										{
											"type": "MakeNumberRefStmt",
											"stmt": {
												"Index": 4,
												"target": 8,
												"file": 0,
												"col": 1,
												"row": 7
											}
										},
										{
											"type": "SetAddStmt",
											"stmt": {
												"value": {
													"type": "local",
													"value": 8
												},
												"set": 6,
												"file": 0,
												"col": 1,
												"row": 7
											}
										},
										{
											"type": "MakeNumberRefStmt",
											"stmt": {
												"Index": 5,
												"target": 9,
												"file": 0,
												"col": 1,
												"row": 7
											}
										},
										{
											"type": "SetAddStmt",
											"stmt": {
												"value": {
													"type": "local",
													"value": 9
												},
												"set": 6,
												"file": 0,
												"col": 1,
												"row": 7
											}
										},
										{
											"type": "MakeNumberRefStmt",
											"stmt": {
												"Index": 6,
												"target": 10,
												"file": 0,
												"col": 1,
												"row": 7
											}
										},
										{
											"type": "SetAddStmt",
											"stmt": {
												"value": {
													"type": "local",
													"value": 10
												},
												"set": 6,
												"file": 0,
												"col": 1,
												"row": 7
											}
										},
										{
											"type": "ObjectInsertStmt",
											"stmt": {
												"key": {
													"type": "string_index",
													"value": 2
												},
												"value": {
													"type": "local",
													"value": 6
												},
												"object": 5,
												"file": 0,
												"col": 1,
												"row": 7
											}
										},
										{
											"type": "ObjectInsertStmt",
											"stmt": {
												"key": {
													"type": "string_index",
													"value": 1
												},
												"value": {
													"type": "local",
													"value": 5
												},
												"object": 4,
												"file": 0,
												"col": 1,
												"row": 7
											}
										},
										{
											"type": "MakeObjectStmt",
											"stmt": {
												"target": 11,
												"file": 0,
												"col": 1,
												"row": 7
											}
										},
										{
											"type": "ObjectInsertStmt",
											"stmt": {
												"key": {
													"type": "string_index",
													"value": 24
												},
												"value": {
													"type": "string_index",
													"value": 25
												},
												"object": 11,
												"file": 0,
												"col": 1,
												"row": 7
											}
										},
										{
											"type": "ObjectInsertStmt",
											"stmt": {
												"key": {
													"type": "string_index",
													"value": 8
												},
												"value": {
													"type": "string_index",
													"value": 9
												},
												"object": 11,
												"file": 0,
												"col": 1,
												"row": 7
											}
										},
										{
											"type": "ObjectInsertStmt",
											"stmt": {
												"key": {
													"type": "string_index",
													"value": 26
												},
												"value": {
													"type": "string_index",
													"value": 27
												},
												"object": 11,
												"file": 0,
												"col": 1,
												"row": 7
											}
										},
										{
											"type": "ObjectInsertStmt",
											"stmt": {
												"key": {
													"type": "string_index",
													"value": 28
												},
												"value": {
													"type": "string_index",
													"value": 29
												},
												"object": 11,
												"file": 0,
												"col": 1,
												"row": 7
											}
										},
										{
											"type": "ObjectInsertStmt",
											"stmt": {
												"key": {
													"type": "string_index",
													"value": 30
												},
												"value": {
													"type": "string_index",
													"value": 31
												},
												"object": 11,
												"file": 0,
												"col": 1,
												"row": 7
											}
										},
										{
											"type": "ObjectInsertStmt",
											"stmt": {
												"key": {
													"type": "string_index",
													"value": 7
												},
												"value": {
													"type": "local",
													"value": 11
												},
												"object": 4,
												"file": 0,
												"col": 1,
												"row": 7
											}
										},
										{
											"type": "ObjectInsertStmt",
											"stmt": {
												"key": {
													"type": "string_index",
													"value": 10
												},
												"value": {
													"type": "string_index",
													"value": 11
												},
												"object": 4,
												"file": 0,
												"col": 1,
												"row": 7
											}
										},
										{
											"type": "ObjectInsertStmt",
											"stmt": {
												"key": {
													"type": "string_index",
													"value": 12
												},
												"value": {
													"type": "string_index",
													"value": 13
												},
												"object": 4,
												"file": 0,
												"col": 1,
												"row": 7
											}
										},
										{
											"type": "AssignVarOnceStmt",
											"stmt": {
												"source": {
													"type": "local",
													"value": 4
												},
												"target": 3,
												"file": 0,
												"col": 1,
												"row": 7
											}
										}
									]
								},
								{
									"stmts": [
										{
											"type": "IsDefinedStmt",
											"stmt": {
												"source": 3,
												"file": 0,
												"col": 1,
												"row": 7
											}
										},
										{
											"type": "AssignVarOnceStmt",
											"stmt": {
												"source": {
													"type": "local",
													"value": 3
												},
												"target": 2,
												"file": 0,
												"col": 1,
												"row": 7
											}
										}
									]
								},
								{
									"stmts": [
										{
											"type": "ReturnLocalStmt",
											"stmt": {
												"source": 2,
												"file": 0,
												"col": 1,
												"row": 7
											}
										}
									]
								}
							],
							"path": [
								"g0",
								"test",
								"expected"
							]
						},
						{
							"name": "g0.data.test.p",
							"params": [
								0,
								1
							],
							"return": 2,
							"blocks": [
								{
									"stmts": [
										{
											"type": "ResetLocalStmt",
											"stmt": {
												"target": 3,
												"file": 0,
												"col": 1,
												"row": 20
											}
										},
										{
											"type": "CallStmt",
											"stmt": {
												"func": "g0.data.test.req",
												"args": [
													{
														"type": "local",
														"value": 0
													},
													{
														"type": "local",
														"value": 1
													}
												],
												"result": 4,
												"file": 0,
												"col": 25,
												"row": 21
											}
										},
										{
											"type": "AssignVarStmt",
											"stmt": {
												"source": {
													"type": "local",
													"value": 4
												},
												"target": 5,
												"file": 0,
												"col": 25,
												"row": 21
											}
										},
										{
											"type": "CallStmt",
											"stmt": {
												"func": "g0.data.test.aws_config",
												"args": [
													{
														"type": "local",
														"value": 0
													},
													{
														"type": "local",
														"value": 1
													}
												],
												"result": 6,
												"file": 0,
												"col": 30,
												"row": 21
											}
										},
										{
											"type": "AssignVarStmt",
											"stmt": {
												"source": {
													"type": "local",
													"value": 6
												},
												"target": 7,
												"file": 0,
												"col": 30,
												"row": 21
											}
										},
										{
											"type": "MakeNumberRefStmt",
											"stmt": {
												"Index": 23,
												"target": 8,
												"file": 0,
												"col": 2,
												"row": 21
											}
										},
										{
											"type": "CallStmt",
											"stmt": {
												"func": "providers.aws.sign_req",
												"args": [
													{
														"type": "local",
														"value": 5
													},
													{
														"type": "local",
														"value": 7
													},
													{
														"type": "local",
														"value": 8
													}
												],
												"result": 9,
												"file": 0,
												"col": 2,
												"row": 21
											}
										},
										{
											"type": "AssignVarStmt",
											"stmt": {
												"source": {
													"type": "local",
													"value": 9
												},
												"target": 10,
												"file": 0,
												"col": 2,
												"row": 21
											}
										},
										{
											"type": "CallStmt",
											"stmt": {
												"func": "g0.data.test.expected",
												"args": [
													{
														"type": "local",
														"value": 0
													},
													{
														"type": "local",
														"value": 1
													}
												],
												"result": 11,
												"file": 0,
												"col": 2,
												"row": 21
											}
										},
										{
											"type": "EqualStmt",
											"stmt": {
												"a": {
													"type": "local",
													"value": 10
												},
												"b": {
													"type": "local",
													"value": 11
												},
												"file": 0,
												"col": 2,
												"row": 21
											}
										},
										{
											"type": "AssignVarOnceStmt",
											"stmt": {
												"source": {
													"type": "bool",
													"value": true
												},
												"target": 3,
												"file": 0,
												"col": 1,
												"row": 20
											}
										}
									]
								},
								{
									"stmts": [
										{
											"type": "IsDefinedStmt",
											"stmt": {
												"source": 3,
												"file": 0,
												"col": 1,
												"row": 20
											}
										},
										{
											"type": "AssignVarOnceStmt",
											"stmt": {
												"source": {
													"type": "local",
													"value": 3
												},
												"target": 2,
												"file": 0,
												"col": 1,
												"row": 20
											}
										}
									]
								},
								{
									"stmts": [
										{
											"type": "ReturnLocalStmt",
											"stmt": {
												"source": 2,
												"file": 0,
												"col": 1,
												"row": 20
											}
										}
									]
								}
							],
							"path": [
								"g0",
								"test",
								"p"
							]
						}
					]
				}
			},
			"want_plan_result": [
				{
					"x": true
				}
			]
		},
		{
			"note": "providers-aws-sign_req/success-simple-with-existing-sha-header-with-body-with-payload-signing",
			"query": "data.test.p = x",
			"modules": [
				"package test\n\nreq := {\"method\": \"get\", \"url\": \"https://example.com\", \"headers\": {\"foo\": \"bar\", \"x-amz-content-sha256\": \"existing-value\"}, \"body\": {\"example\": {1, 2, 3, 4}}}\n\naws_config := {\"aws_access_key\": \"MYAWSACCESSKEYGOESHERE\", \"aws_secret_access_key\": \"MYAWSSECRETACCESSKEYGOESHERE\", \"aws_service\": \"s3\", \"aws_region\": \"us-east-1\", \"disable_payload_signing\": false}\n\nexpected := {\n\t\"body\": {\"example\": {1, 2, 3, 4}},\n\t\"headers\": {\n\t\t\"Authorization\": \"AWS4-HMAC-SHA256 Credential=MYAWSACCESSKEYGOESHERE/20151228/us-east-1/s3/aws4_request,SignedHeaders=foo;host;x-amz-content-sha256;x-amz-date,Signature=42bcac7fc6d170e09be72fdf38b62e59361265bc59d5f9156f0d6faf889e98ba\",\n\t\t\"foo\": \"bar\",\n\t\t\"host\": \"example.com\",\n\t\t\"x-amz-content-sha256\": \"bacff6243c850423883052ac3c336fd645994442933408dfd3f9e858e69bda07\",\n\t\t\"x-amz-date\": \"20151228T140825Z\",\n\t},\n\t\"method\": \"get\",\n\t\"url\": \"https://example.com\",\n}\n\np if {\n\tproviders.aws.sign_req(req, aws_config, 1451311705000000000) == expected\n}\n"
			],
			"want_result": [
				{
					"x": true
				}
			],
			"entrypoints": [
				"eval"
			],
			"plan": {
				"static": {
					"strings": [
						{
							"value": "x"
						},
						{
							"value": "body"
						},
						{
							"value": "example"
						},
						{
							"value": "1"
						},
						{
							"value": "2"
						},
						{
							"value": "3"
						},
						{
							"value": "4"
						},
						{
							"value": "headers"
						},
						{
							"value": "foo"
						},
						{
							"value": "bar"
						},
						{
							"value": "x-amz-content-sha256"
						},
						{
							"value": "existing-value"
						},
						{
							"value": "method"
						},
						{
							"value": "get"
						},
						{
							"value": "url"
						},
						{
							"value": "https://example.com"
						},
						{
							"value": "aws_access_key"
						},
						{
							"value": "MYAWSACCESSKEYGOESHERE"
						},
						{
							"value": "aws_region"
						},
						{
							"value": "us-east-1"
						},
						{
							"value": "aws_secret_access_key"
						},
						{
							"value": "MYAWSSECRETACCESSKEYGOESHERE"
						},
						{
							"value": "aws_service"
						},
						{
							"value": "s3"
						},
						{
							"value": "disable_payload_signing"
						},
						{
							"value": "1451311705000000000"
						},
						{
							"value": "Authorization"
						},
						{
							"value": "AWS4-HMAC-SHA256 Credential=MYAWSACCESSKEYGOESHERE/20151228/us-east-1/s3/aws4_request,SignedHeaders=foo;host;x-amz-content-sha256;x-amz-date,Signature=42bcac7fc6d170e09be72fdf38b62e59361265bc59d5f9156f0d6faf889e98ba"
						},
						{
							"value": "host"
						},
						{
							"value": "example.com"
						},
						{
							"value": "bacff6243c850423883052ac3c336fd645994442933408dfd3f9e858e69bda07"
						},
						{
							"value": "x-amz-date"
						},
						{
							"value": "20151228T140825Z"
						}
					],
					"builtin_funcs": [
						{
							"name": "providers.aws.sign_req",
							"decl": {
								"args": [
									{
										"description": "HTTP request object",
										"dynamic": {
											"key": {
												"type": "string"
											},
											"value": {
												"type": "any"
											}
										},
										"name": "request",
										"type": "object"
									},
									{
										"description": "AWS configuration object",
										"dynamic": {
											"key": {
												"type": "string"
											},
											"value": {
												"type": "any"
											}
										},
										"name": "aws_config",
										"type": "object"
									},
									{
										"description": "nanoseconds since the epoch",
										"name": "time_ns",
										"type": "number"
									}
								],
								"result": {
									"description": "HTTP request object with `Authorization` header",
									"dynamic": {
										"key": {
											"type": "any"
										},
										"value": {
											"type": "any"
										}
									},
									"name": "signed_request",
									"type": "object"
								},
								"type": "function"
							}
						}
					],
					"files": [
						{
							"value": "module-0.rego"
						},
						{
							"value": "\u003cquery\u003e"
						}
					]
				},
				"plans": {
					"plans": [
						{
							"name": "eval",
							"blocks": [
								{
									"stmts": [
										{
											"type": "CallStmt",
											"stmt": {
												"func": "g0.data.test.p",
												"args": [
													{
														"type": "local",
														"value": 0
													},
													{
														"type": "local",
														"value": 1
													}
												],
												"result": 2,
												"file": 1,
												"col": 1,
												"row": 1
											}
										},
										{
											"type": "AssignVarStmt",
											"stmt": {
												"source": {
													"type": "local",
													"value": 2
												},
												"target": 3,
												"file": 1,
												"col": 1,
												"row": 1
											}
										},
										{
											"type": "MakeObjectStmt",
											"stmt": {
												"target": 4,
												"file": 1,
												"col": 1,
												"row": 1
											}
										},
										{
											"type": "ObjectInsertStmt",
											"stmt": {
												"key": {
													"type": "string_index",
													"value": 0
												},
												"value": {
													"type": "local",
													"value": 3
												},
												"object": 4,
												"file": 1,
												"col": 1,
												"row": 1
											}
										},
										{
											"type": "ResultSetAddStmt",
											"stmt": {
												"value": 4,
												"file": 1,
												"col": 1,
												"row": 1
											}
										}
									]
								}
							]
						}
					]
				},
				"funcs": {
					"funcs": [
						{
							"name": "g0.data.test.req",
							"params": [
								0,
								1
							],
							"return": 2,
							"blocks": [
								{
									"stmts": [
										{
											"type": "ResetLocalStmt",
											"stmt": {
												"target": 3,
												"file": 0,
												"col": 1,
												"row": 3
											}
										},
										{
											"type": "MakeObjectStmt",
											"stmt": {
												"target": 4,
												"file": 0,
												"col": 1,
												"row": 3
											}
										},
										{
											"type": "MakeObjectStmt",
											"stmt": {
												"target": 5,
												"file": 0,
												"col": 1,
												"row": 3
											}
										},
										{
											"type": "MakeSetStmt",
											"stmt": {
												"target": 6,
												"file": 0,
												"col": 1,
												"row": 3
											}
										},
										{
											"type": "MakeNumberRefStmt",
											"stmt": {
												"Index": 3,
												"target": 7,
												"file": 0,
												"col": 1,
												"row": 3
											}
										},
										{
											"type": "SetAddStmt",
											"stmt": {
												"value": {
													"type": "local",
													"value": 7
												},
												"set": 6,
												"file": 0,
												"col": 1,
												"row": 3
											}
										},
										{
											"type": "MakeNumberRefStmt",
											"stmt": {
												"Index": 4,
												"target": 8,
												"file": 0,
												"col": 1,
												"row": 3
											}
										},
										{
											"type": "SetAddStmt",
											"stmt": {
												"value": {
													"type": "local",
													"value": 8
												},
												"set": 6,
												"file": 0,
												"col": 1,
												"row": 3
											}
										},
										{
											"type": "MakeNumberRefStmt",
											"stmt": {
												"Index": 5,
												"target": 9,
												"file": 0,
												"col": 1,
												"row": 3
											}
										},
										{
											"type": "SetAddStmt",
											"stmt": {
												"value": {
													"type": "local",
													"value": 9
												},
												"set": 6,
												"file": 0,
												"col": 1,
												"row": 3
											}
										},
										{
											"type": "MakeNumberRefStmt",
											"stmt": {
												"Index": 6,
												"target": 10,
												"file": 0,
												"col": 1,
												"row": 3
											}
										},
										{
											"type": "SetAddStmt",
											"stmt": {
												"value": {
													"type": "local",
													"value": 10
												},
												"set": 6,
												"file": 0,
												"col": 1,
												"row": 3
											}
										},
										{
											"type": "ObjectInsertStmt",
											"stmt": {
												"key": {
													"type": "string_index",
													"value": 2
												},
												"value": {
													"type": "local",
													"value": 6
												},
												"object": 5,
												"file": 0,
												"col": 1,
												"row": 3
											}
										},
										{
											"type": "ObjectInsertStmt",
											"stmt": {
												"key": {
													"type": "string_index",
													"value": 1
												},
												"value": {
													"type": "local",
													"value": 5
												},
												"object": 4,
												"file": 0,
												"col": 1,
												"row": 3
											}
										},
										{
											"type": "MakeObjectStmt",
											"stmt": {
												"target": 11,
												"file": 0,
												"col": 1,
												"row": 3
											}
										},
										{
											"type": "ObjectInsertStmt",
											"stmt": {
												"key": {
													"type": "string_index",
													"value": 8
												},
												"value": {
													"type": "string_index",
													"value": 9
												},
												"object": 11,
												"file": 0,
												"col": 1,
												"row": 3
											}
										},
										{
											"type": "ObjectInsertStmt",
											"stmt": {
												"key": {
													"type": "string_index",
													"value": 10
												},
												"value": {
													"type": "string_index",
													"value": 11
												},
												"object": 11,
												"file": 0,
												"col": 1,
												"row": 3
											}
										},
										{
											"type": "ObjectInsertStmt",
											"stmt": {
												"key": {
													"type": "string_index",
													"value": 7
												},
												"value": {
													"type": "local",
													"value": 11
												},
												"object": 4,
												"file": 0,
												"col": 1,
												"row": 3
											}
										},
										{
											"type": "ObjectInsertStmt",
											"stmt": {
												"key": {
													"type": "string_index",
													"value": 12
												},
												"value": {
													"type": "string_index",
													"value": 13
												},
												"object": 4,
												"file": 0,
												"col": 1,
												"row": 3
											}
										},
										{
											"type": "ObjectInsertStmt",
											"stmt": {
												"key": {
													"type": "string_index",
													"value": 14
												},
												"value": {
													"type": "string_index",
													"value": 15
												},
												"object": 4,
												"file": 0,
												"col": 1,
												"row": 3
											}
										},
										{
											"type": "AssignVarOnceStmt",
											"stmt": {
												"source": {
													"type": "local",
													"value": 4
												},
												"target": 3,
												"file": 0,
												"col": 1,
												"row": 3
											}
										}
									]
								},
								{
									"stmts": [
										{
											"type": "IsDefinedStmt",
											"stmt": {
												"source": 3,
												"file": 0,
												"col": 1,
												"row": 3
											}
										},
										{
											"type": "AssignVarOnceStmt",
											"stmt": {
												"source": {
													"type": "local",
													"value": 3
												},
												"target": 2,
												"file": 0,
												"col": 1,
												"row": 3
											}
										}
									]
								},
								{
									"stmts": [
										{
											"type": "ReturnLocalStmt",
											"stmt": {
												"source": 2,
												"file": 0,
												"col": 1,
												"row": 3
											}
										}
									]
								}
							],
							"path": [
								"g0",
								"test",
								"req"
							]
						},
						{
							"name": "g0.data.test.aws_config",
							"params": [
								0,
								1
							],
							"return": 2,
							"blocks": [
								{
									"stmts": [
										{
											"type": "ResetLocalStmt",
											"stmt": {
												"target": 3,
												"file": 0,
												"col": 1,
												"row": 5
											}
										},
										{
											"type": "MakeObjectStmt",
											"stmt": {
												"target": 4,
												"file": 0,
												"col": 1,
												"row": 5
											}
										},
										{
											"type": "ObjectInsertStmt",
											"stmt": {
												"key": {
													"type": "string_index",
													"value": 16
												},
												"value": {
													"type": "string_index",
													"value": 17
												},
												"object": 4,
												"file": 0,
												"col": 1,
												"row": 5
											}
										},
										{
											"type": "ObjectInsertStmt",
											"stmt": {
												"key": {
													"type": "string_index",
													"value": 18
												},
												"value": {
													"type": "string_index",
													"value": 19
												},
												"object": 4,
												"file": 0,
												"col": 1,
												"row": 5
											}
										},
										{
											"type": "ObjectInsertStmt",
											"stmt": {
												"key": {
													"type": "string_index",
													"value": 20
												},
												"value": {
													"type": "string_index",
													"value": 21
												},
												"object": 4,
												"file": 0,
												"col": 1,
												"row": 5
											}
										},
										{
											"type": "ObjectInsertStmt",
											"stmt": {
												"key": {
													"type": "string_index",
													"value": 22
												},
												"value": {
													"type": "string_index",
													"value": 23
												},
												"object": 4,
												"file": 0,
												"col": 1,
												"row": 5
											}
										},
										{
											"type": "ObjectInsertStmt",
											"stmt": {
												"key": {
													"type": "string_index",
													"value": 24
												},
												"value": {
													"type": "bool",
													"value": false
												},
												"object": 4,
												"file": 0,
												"col": 1,
												"row": 5
											}
										},
										{
											"type": "AssignVarOnceStmt",
											"stmt": {
												"source": {
													"type": "local",
													"value": 4
												},
												"target": 3,
												"file": 0,
												"col": 1,
												"row": 5
											}
										}
									]
								},
								{
									"stmts": [
										{
											"type": "IsDefinedStmt",
											"stmt": {
												"source": 3,
												"file": 0,
												"col": 1,
												"row": 5
											}
										},
										{
											"type": "AssignVarOnceStmt",
											"stmt": {
												"source": {
													"type": "local",
													"value": 3
												},
												"target": 2,
												"file": 0,
												"col": 1,
												"row": 5
											}
										}
									]
								},
								{
									"stmts": [
										{
											"type": "ReturnLocalStmt",
											"stmt": {
												"source": 2,
												"file": 0,
												"col": 1,
												"row": 5
											}
										}
									]
								}
							],
							"path": [
								"g0",
								"test",
								"aws_config"
							]
						},
						{
							"name": "g0.data.test.expected",
							"params": [
								0,
								1
							],
							"return": 2,
							"blocks": [
								{
									"stmts": [
										{
											"type": "ResetLocalStmt",
											"stmt": {
												"target": 3,
												"file": 0,
												"col": 1,
												"row": 7
											}
										},
										{
											"type": "MakeObjectStmt",
											"stmt": {
												"target": 4,
												"file": 0,
												"col": 1,
												"row": 7
											}
										},
										{
											"type": "MakeObjectStmt",
											"stmt": {
												"target": 5,
												"file": 0,
												"col": 1,
												"row": 7
											}
										},
										{
											"type": "MakeSetStmt",
											"stmt": {
												"target": 6,
												"file": 0,
												"col": 1,
												"row": 7
											}
										},
										{
											"type": "MakeNumberRefStmt",
											"stmt": {
												"Index": 3,
												"target": 7,
												"file": 0,
												"col": 1,
												"row": 7
											}
										},
										{
											"type": "SetAddStmt",
											"stmt": {
												"value": {
													"type": "local",
													"value": 7
												},
												"set": 6,
												"file": 0,
												"col": 1,
												"row": 7
											}
										},
										{
											"type": "MakeNumberRefStmt",
											"stmt": {
												"Index": 4,
												"target": 8,
												"file": 0,
												"col": 1,
												"row": 7
											}
										},
										{
											"type": "SetAddStmt",
											"stmt": {
												"value": {
													"type": "local",
													"value": 8
												},
												"set": 6,
												"file": 0,
												"col": 1,
												"row": 7
											}
										},
										{
											"type": "MakeNumberRefStmt",
											"stmt": {
												"Index": 5,
												"target": 9,
												"file": 0,
												"col": 1,
												"row": 7
											}
										},
										{
											"type": "SetAddStmt",
											"stmt": {
												"value": {
													"type": "local",
													"value": 9
												},
												"set": 6,
												"file": 0,
												"col": 1,
												"row": 7
											}
										},
										{
											"type": "MakeNumberRefStmt",
											"stmt": {
												"Index": 6,
												"target": 10,
												"file": 0,
												"col": 1,
												"row": 7
											}
										},
										{
											"type": "SetAddStmt",
											"stmt": {
												"value": {
													"type": "local",
													"value": 10
												},
												"set": 6,
												"file": 0,
												"col": 1,
												"row": 7
											}
										},
										{
											"type": "ObjectInsertStmt",
											"stmt": {
												"key": {
													"type": "string_index",
													"value": 2
												},
												"value": {
													"type": "local",
													"value": 6
												},
												"object": 5,
												"file": 0,
												"col": 1,
												"row": 7
											}
										},
										{
											"type": "ObjectInsertStmt",
											"stmt": {
												"key": {
													"type": "string_index",
													"value": 1
												},
												"value": {
													"type": "local",
													"value": 5
												},
												"object": 4,
												"file": 0,
												"col": 1,
												"row": 7
											}
										},
										{
											"type": "MakeObjectStmt",
											"stmt": {
												"target": 11,
												"file": 0,
												"col": 1,
												"row": 7
											}
										},
										{
											"type": "ObjectInsertStmt",
											"stmt": {
												"key": {
													"type": "string_index",
													"value": 26
												},
												"value": {
													"type": "string_index",
													"value": 27
												},
												"object": 11,
												"file": 0,
												"col": 1,
												"row": 7
											}
										},
										{
											"type": "ObjectInsertStmt",
											"stmt": {
												"key": {
													"type": "string_index",
													"value": 8
												},
												"value": {
													"type": "string_index",
													"value": 9
												},
												"object": 11,
												"file": 0,
												"col": 1,
												"row": 7
											}
										},
										{
											"type": "ObjectInsertStmt",
											"stmt": {
												"key": {
													"type": "string_index",
													"value": 28
												},
												"value": {
													"type": "string_index",
													"value": 29
												},
												"object": 11,
												"file": 0,
												"col": 1,
												"row": 7
											}
										},
										{
											"type": "ObjectInsertStmt",
											"stmt": {
												"key": {
													"type": "string_index",
													"value": 10
												},
												"value": {
													"type": "string_index",
													"value": 30
												},
												"object": 11,
												"file": 0,
												"col": 1,
												"row": 7
											}
										},
										{
											"type": "ObjectInsertStmt",
											"stmt": {
												"key": {
													"type": "string_index",
													"value": 31
												},
												"value": {
													"type": "string_index",
													"value": 32
												},
												"object": 11,
												"file": 0,
												"col": 1,
												"row": 7
											}
										},
										{
											"type": "ObjectInsertStmt",
											"stmt": {
												"key": {
													"type": "string_index",
													"value": 7
												},
												"value": {
													"type": "local",
													"value": 11
												},
												"object": 4,
												"file": 0,
												"col": 1,
												"row": 7
											}
										},
										{
											"type": "ObjectInsertStmt",
											"stmt": {
												"key": {
													"type": "string_index",
													"value": 12
												},
												"value": {
													"type": "string_index",
													"value": 13
												},
												"object": 4,
												"file": 0,
												"col": 1,
												"row": 7
											}
										},
										{
											"type": "ObjectInsertStmt",
											"stmt": {
												"key": {
													"type": "string_index",
													"value": 14
												},
												"value": {
													"type": "string_index",
													"value": 15
												},
												"object": 4,
												"file": 0,
												"col": 1,
												"row": 7
											}
										},
										{
											"type": "AssignVarOnceStmt",
											"stmt": {
												"source": {
													"type": "local",
													"value": 4
												},
												"target": 3,
												"file": 0,
												"col": 1,
												"row": 7
											}
										}
									]
								},
								{
									"stmts": [
										{
											"type": "IsDefinedStmt",
											"stmt": {
												"source": 3,
												"file": 0,
												"col": 1,
												"row": 7
											}
										},
										{
											"type": "AssignVarOnceStmt",
											"stmt": {
												"source": {
													"type": "local",
													"value": 3
												},
												"target": 2,
												"file": 0,
												"col": 1,
												"row": 7
											}
										}
									]
								},
								{
									"stmts": [
										{
											"type": "ReturnLocalStmt",
											"stmt": {
												"source": 2,
												"file": 0,
												"col": 1,
												"row": 7
											}
										}
									]
								}
							],
							"path": [
								"g0",
								"test",
								"expected"
							]
						},
						{
							"name": "g0.data.test.p",
							"params": [
								0,
								1
							],
							"return": 2,
							"blocks": [
								{
									"stmts": [
										{
											"type": "ResetLocalStmt",
											"stmt": {
												"target": 3,
												"file": 0,
												"col": 1,
												"row": 20
											}
										},
										{
											"type": "CallStmt",
											"stmt": {
												"func": "g0.data.test.req",
												"args": [
													{
														"type": "local",
														"value": 0
													},
													{
														"type": "local",
														"value": 1
													}
												],
												"result": 4,
												"file": 0,
												"col": 25,
												"row": 21
											}
										},
										{
											"type": "AssignVarStmt",
											"stmt": {
												"source": {
													"type": "local",
													"value": 4
												},
												"target": 5,
												"file": 0,
												"col": 25,
												"row": 21
											}
										},
										{
											"type": "CallStmt",
											"stmt": {
												"func": "g0.data.test.aws_config",
												"args": [
													{
														"type": "local",
														"value": 0
													},
													{
														"type": "local",
														"value": 1
													}
												],
												"result": 6,
												"file": 0,
												"col": 30,
												"row": 21
											}
										},
										{
											"type": "AssignVarStmt",
											"stmt": {
												"source": {
													"type": "local",
													"value": 6
												},
												"target": 7,
												"file": 0,
												"col": 30,
												"row": 21
											}
										},
										{
											"type": "MakeNumberRefStmt",
											"stmt": {
												"Index": 25,
												"target": 8,
												"file": 0,
												"col": 2,
												"row": 21
											}
										},
										{
											"type": "CallStmt",
											"stmt": {
												"func": "providers.aws.sign_req",
												"args": [
													{
														"type": "local",
														"value": 5
													},
													{
														"type": "local",
														"value": 7
													},
													{
														"type": "local",
														"value": 8
													}
												],
												"result": 9,
												"file": 0,
												"col": 2,
												"row": 21
											}
										},
										{
											"type": "AssignVarStmt",
											"stmt": {
												"source": {
													"type": "local",
													"value": 9
												},
												"target": 10,
												"file": 0,
												"col": 2,
												"row": 21
											}
										},
										{
											"type": "CallStmt",
											"stmt": {
												"func": "g0.data.test.expected",
												"args": [
													{
														"type": "local",
														"value": 0
													},
													{
														"type": "local",
														"value": 1
													}
												],
												"result": 11,
												"file": 0,
												"col": 2,
												"row": 21
											}
										},
										{
											"type": "EqualStmt",
											"stmt": {
												"a": {
													"type": "local",
													"value": 10
												},
												"b": {
													"type": "local",
													"value": 11
												},
												"file": 0,
												"col": 2,
												"row": 21
											}
										},
										{
											"type": "AssignVarOnceStmt",
											"stmt": {
												"source": {
													"type": "bool",
													"value": true
												},
												"target": 3,
												"file": 0,
												"col": 1,
												"row": 20
											}
										}
									]
								},
								{
									"stmts": [
										{
											"type": "IsDefinedStmt",
											"stmt": {
												"source": 3,
												"file": 0,
												"col": 1,
												"row": 20
											}
										},
										{
											"type": "AssignVarOnceStmt",
											"stmt": {
												"source": {
													"type": "local",
													"value": 3
												},
												"target": 2,
												"file": 0,
												"col": 1,
												"row": 20
											}
										}
									]
								},
								{
									"stmts": [
										{
											"type": "ReturnLocalStmt",
											"stmt": {
												"source": 2,
												"file": 0,
												"col": 1,
												"row": 20
											}
										}
									]
								}
							],
							"path": [
								"g0",
								"test",
								"p"
							]
						}
					]
				}
			},
			"want_plan_result": [
				{
					"x": true
				}
			]
		},
		{
			"note": "providers-aws-sign_req/success-simple-with-existing-sha-header-with-body-no-payload-signing",
			"query": "data.test.p = x",
			"modules": [
				"package test\n\nreq := {\"method\": \"get\", \"url\": \"https://example.com\", \"headers\": {\"foo\": \"bar\", \"x-amz-content-sha256\": \"existing-value\"}, \"body\": {\"example\": {1, 2, 3, 4}}}\n\naws_config := {\"aws_access_key\": \"MYAWSACCESSKEYGOESHERE\", \"aws_secret_access_key\": \"MYAWSSECRETACCESSKEYGOESHERE\", \"aws_service\": \"s3\", \"aws_region\": \"us-east-1\", \"disable_payload_signing\": true}\n\nexpected := {\n\t\"body\": {\"example\": {1, 2, 3, 4}},\n\t\"headers\": {\n\t\t\"Authorization\": \"AWS4-HMAC-SHA256 Credential=MYAWSACCESSKEYGOESHERE/20151228/us-east-1/s3/aws4_request,SignedHeaders=foo;host;x-amz-content-sha256;x-amz-date,Signature=edcd3ca3fd3acdfbcecad1a1d8062dbc6562d90352e294c336f9727397f9c383\",\n\t\t\"foo\": \"bar\",\n\t\t\"host\": \"example.com\",\n\t\t\"x-amz-content-sha256\": \"UNSIGNED-PAYLOAD\",\n\t\t\"x-amz-date\": \"20151228T140825Z\",\n\t},\n\t\"method\": \"get\",\n\t\"url\": \"https://example.com\",\n}\n\np if {\n\tproviders.aws.sign_req(req, aws_config, 1451311705000000000) == expected\n}\n"
			],
			"want_result": [
				{
					"x": true
				}
			],
			"entrypoints": [
				"eval"
			],
			"plan": {
				"static": {
					"strings": [
						{
							"value": "x"
						},
						{
							"value": "body"
						},
						{
							"value": "example"
						},
						{
							"value": "1"
						},
						{
							"value": "2"
						},
						{
							"value": "3"
						},
						{
							"value": "4"
						},
						{
							"value": "headers"
						},
						{
							"value": "foo"
						},
						{
							"value": "bar"
						},
						{
							"value": "x-amz-content-sha256"
						},
						{
							"value": "existing-value"
						},
						{
							"value": "method"
						},
						{
							"value": "get"
						},
						{
							"value": "url"
						},
						{
							"value": "https://example.com"
						},
						{
							"value": "aws_access_key"
						},
						{
							"value": "MYAWSACCESSKEYGOESHERE"
						},
						{
							"value": "aws_region"
						},
						{
							"value": "us-east-1"
						},
						{
							"value": "aws_secret_access_key"
						},
						{
							"value": "MYAWSSECRETACCESSKEYGOESHERE"
						},
						{
							"value": "aws_service"
						},
						{
							"value": "s3"
						},
						{
							"value": "disable_payload_signing"
						},
						{
							"value": "1451311705000000000"
						},
						{
							"value": "Authorization"
						},
						{
							"value": "AWS4-HMAC-SHA256 Credential=MYAWSACCESSKEYGOESHERE/20151228/us-east-1/s3/aws4_request,SignedHeaders=foo;host;x-amz-content-sha256;x-amz-date,Signature=edcd3ca3fd3acdfbcecad1a1d8062dbc6562d90352e294c336f9727397f9c383"
						},
						{
							"value": "host"
						},
						{
							"value": "example.com"
						},
						{
							"value": "UNSIGNED-PAYLOAD"
						},
						{
							"value": "x-amz-date"
						},
						{
							"value": "20151228T140825Z"
						}
					],
					"builtin_funcs": [
						{
							"name": "providers.aws.sign_req",
							"decl": {
								"args": [
									{
										"description": "HTTP request object",
										"dynamic": {
											"key": {
												"type": "string"
											},
											"value": {
												"type": "any"
											}
										},
										"name": "request",
										"type": "object"
									},
									{
										"description": "AWS configuration object",
										"dynamic": {
											"key": {
												"type": "string"
											},
											"value": {
												"type": "any"
											}
										},
										"name": "aws_config",
										"type": "object"
									},
									{
										"description": "nanoseconds since the epoch",
										"name": "time_ns",
										"type": "number"
									}
								],
								"result": {
									"description": "HTTP request object with `Authorization` header",
									"dynamic": {
										"key": {
											"type": "any"
										},
										"value": {
											"type": "any"
										}
									},
									"name": "signed_request",
									"type": "object"
								},
								"type": "function"
							}
						}
					],
					"files": [
						{
							"value": "module-0.rego"
						},
						{
							"value": "\u003cquery\u003e"
						}
					]
				},
				"plans": {
					"plans": [
						{
							"name": "eval",
							"blocks": [
								{
									"stmts": [
										{
											"type": "CallStmt",
											"stmt": {
												"func": "g0.data.test.p",
												"args": [
													{
														"type": "local",
														"value": 0
													},
													{
														"type": "local",
														"value": 1
													}
												],
												"result": 2,
												"file": 1,
												"col": 1,
												"row": 1
											}
										},
										{
											"type": "AssignVarStmt",
											"stmt": {
												"source": {
													"type": "local",
													"value": 2
												},
												"target": 3,
												"file": 1,
												"col": 1,
												"row": 1
											}
										},
										{
											"type": "MakeObjectStmt",
											"stmt": {
												"target": 4,
												"file": 1,
												"col": 1,
												"row": 1
											}
										},
										{
											"type": "ObjectInsertStmt",
											"stmt": {
												"key": {
													"type": "string_index",
													"value": 0
												},
												"value": {
													"type": "local",
													"value": 3
												},
												"object": 4,
												"file": 1,
												"col": 1,
												"row": 1
											}
										},
										{
											"type": "ResultSetAddStmt",
											"stmt": {
												"value": 4,
												"file": 1,
												"col": 1,
												"row": 1
											}
										}
									]
								}
							]
						}
					]
				},
				"funcs": {
					"funcs": [
						{
							"name": "g0.data.test.req",
							"params": [
								0,
								1
							],
							"return": 2,
							"blocks": [
								{
									"stmts": [
										{
											"type": "ResetLocalStmt",
											"stmt": {
												"target": 3,
												"file": 0,
												"col": 1,
												"row": 3
											}
										},
										{
											"type": "MakeObjectStmt",
											"stmt": {
												"target": 4,
												"file": 0,
												"col": 1,
												"row": 3
											}
										},
										{
											"type": "MakeObjectStmt",
											"stmt": {
												"target": 5,
												"file": 0,
												"col": 1,
												"row": 3
											}
										},
										{
											"type": "MakeSetStmt",
											"stmt": {
												"target": 6,
												"file": 0,
												"col": 1,
												"row": 3
											}
										},
										{
											"type": "MakeNumberRefStmt",
											"stmt": {
												"Index": 3,
												"target": 7,
												"file": 0,
												"col": 1,
												"row": 3
											}
										},
										{
											"type": "SetAddStmt",
											"stmt": {
												"value": {
													"type": "local",
													"value": 7
												},
												"set": 6,
												"file": 0,
												"col": 1,
												"row": 3
											}
										},
										{
											"type": "MakeNumberRefStmt",
											"stmt": {
												"Index": 4,
												"target": 8,
												"file": 0,
												"col": 1,
												"row": 3
											}
										},
										{
											"type": "SetAddStmt",
											"stmt": {
												"value": {
													"type": "local",
													"value": 8
												},
												"set": 6,
												"file": 0,
												"col": 1,
												"row": 3
											}
										},
										{
											"type": "MakeNumberRefStmt",
											"stmt": {
												"Index": 5,
												"target": 9,
												"file": 0,
												"col": 1,
												"row": 3
											}
										},
										{
											"type": "SetAddStmt",
											"stmt": {
												"value": {
													"type": "local",
													"value": 9
												},
												"set": 6,
												"file": 0,
												"col": 1,
												"row": 3
											}
										},
										{
											"type": "MakeNumberRefStmt",
											"stmt": {
												"Index": 6,
												"target": 10,
												"file": 0,
												"col": 1,
												"row": 3
											}
										},
										{
											"type": "SetAddStmt",
											"stmt": {
												"value": {
													"type": "local",
													"value": 10
												},
												"set": 6,
												"file": 0,
												"col": 1,
												"row": 3
											}
										},
										{
											"type": "ObjectInsertStmt",
											"stmt": {
												"key": {
													"type": "string_index",
													"value": 2
												},
												"value": {
													"type": "local",
													"value": 6
												},
												"object": 5,
												"file": 0,
												"col": 1,
												"row": 3
											}
										},
										{
											"type": "ObjectInsertStmt",
											"stmt": {
												"key": {
													"type": "string_index",
													"value": 1
												},
												"value": {
													"type": "local",
													"value": 5
												},
												"object": 4,
												"file": 0,
												"col": 1,
												"row": 3
											}
										},
										{
											"type": "MakeObjectStmt",
											"stmt": {
												"target": 11,
												"file": 0,
												"col": 1,
												"row": 3
											}
										},
										{
											"type": "ObjectInsertStmt",
											"stmt": {
												"key": {
													"type": "string_index",
													"value": 8
												},
												"value": {
													"type": "string_index",
													"value": 9
												},
												"object": 11,
												"file": 0,
												"col": 1,
												"row": 3
											}
										},
										{
											"type": "ObjectInsertStmt",
											"stmt": {
												"key": {
													"type": "string_index",
													"value": 10
												},
												"value": {
													"type": "string_index",
													"value": 11
												},
												"object": 11,
												"file": 0,
												"col": 1,
												"row": 3
											}
										},
										{
											"type": "ObjectInsertStmt",
											"stmt": {
												"key": {
													"type": "string_index",
													"value": 7
												},
												"value": {
													"type": "local",
													"value": 11
												},
												"object": 4,
												"file": 0,
												"col": 1,
												"row": 3
											}
										},
										{
											"type": "ObjectInsertStmt",
											"stmt": {
												"key": {
													"type": "string_index",
													"value": 12
												},
												"value": {
													"type": "string_index",
													"value": 13
												},
												"object": 4,
												"file": 0,
												"col": 1,
												"row": 3
											}
										},
										{
											"type": "ObjectInsertStmt",
											"stmt": {
												"key": {
													"type": "string_index",
													"value": 14
												},
												"value": {
													"type": "string_index",
													"value": 15
												},
												"object": 4,
												"file": 0,
												"col": 1,
												"row": 3
											}
										},
										{
											"type": "AssignVarOnceStmt",
											"stmt": {
												"source": {
													"type": "local",
													"value": 4
												},
												"target": 3,
												"file": 0,
												"col": 1,
												"row": 3
											}
										}
									]
								},
								{
									"stmts": [
										{
											"type": "IsDefinedStmt",
											"stmt": {
												"source": 3,
												"file": 0,
												"col": 1,
												"row": 3
											}
										},
										{
											"type": "AssignVarOnceStmt",
											"stmt": {
												"source": {
													"type": "local",
													"value": 3
												},
												"target": 2,
												"file": 0,
												"col": 1,
												"row": 3
											}
										}
									]
								},
								{
									"stmts": [
										{
											"type": "ReturnLocalStmt",
											"stmt": {
												"source": 2,
												"file": 0,
												"col": 1,
												"row": 3
											}
										}
									]
								}
							],
							"path": [
								"g0",
								"test",
								"req"
							]
						},
						{
							"name": "g0.data.test.aws_config",
							"params": [
								0,
								1
							],
							"return": 2,
							"blocks": [
								{
									"stmts": [
										{
											"type": "ResetLocalStmt",
											"stmt": {
												"target": 3,
												"file": 0,
												"col": 1,
												"row": 5
											}
										},
										{
											"type": "MakeObjectStmt",
											"stmt": {
												"target": 4,
												"file": 0,
												"col": 1,
												"row": 5
											}
										},
										{
											"type": "ObjectInsertStmt",
											"stmt": {
												"key": {
													"type": "string_index",
													"value": 16
												},
												"value": {
													"type": "string_index",
													"value": 17
												},
												"object": 4,
												"file": 0,
												"col": 1,
												"row": 5
											}
										},
										{
											"type": "ObjectInsertStmt",
											"stmt": {
												"key": {
													"type": "string_index",
													"value": 18
												},
												"value": {
													"type": "string_index",
													"value": 19
												},
												"object": 4,
												"file": 0,
												"col": 1,
												"row": 5
											}
										},
										{
											"type": "ObjectInsertStmt",
											"stmt": {
												"key": {
													"type": "string_index",
													"value": 20
												},
												"value": {
													"type": "string_index",
													"value": 21
												},
												"object": 4,
												"file": 0,
												"col": 1,
												"row": 5
											}
										},
										{
											"type": "ObjectInsertStmt",
											"stmt": {
												"key": {
													"type": "string_index",
													"value": 22
												},
												"value": {
													"type": "string_index",
													"value": 23
												},
												"object": 4,
												"file": 0,
												"col": 1,
												"row": 5
											}
										},
										{
											"type": "ObjectInsertStmt",
											"stmt": {
												"key": {
													"type": "string_index",
													"value": 24
												},
												"value": {
													"type": "bool",
													"value": true
												},
												"object": 4,
												"file": 0,
												"col": 1,
												"row": 5
											}
										},
										{
											"type": "AssignVarOnceStmt",
											"stmt": {
												"source": {
													"type": "local",
													"value": 4
												},
												"target": 3,
												"file": 0,
												"col": 1,
												"row": 5
											}
										}
									]
								},
								{
									"stmts": [
										{
											"type": "IsDefinedStmt",
											"stmt": {
												"source": 3,
												"file": 0,
												"col": 1,
												"row": 5
											}
										},
										{
											"type": "AssignVarOnceStmt",
											"stmt": {
												"source": {
													"type": "local",
													"value": 3
												},
												"target": 2,
												"file": 0,
												"col": 1,
												"row": 5
											}
										}
									]
								},
								{
									"stmts": [
										{
											"type": "ReturnLocalStmt",
											"stmt": {
												"source": 2,
												"file": 0,
												"col": 1,
												"row": 5
											}
										}
									]
								}
							],
							"path": [
								"g0",
								"test",
								"aws_config"
							]
						},
						{
							"name": "g0.data.test.expected",
							"params": [
								0,
								1
							],
							"return": 2,
							"blocks": [
								{
									"stmts": [
										{
											"type": "ResetLocalStmt",
											"stmt": {
												"target": 3,
												"file": 0,
												"col": 1,
												"row": 7
											}
										},
										{
											"type": "MakeObjectStmt",
											"stmt": {
												"target": 4,
												"file": 0,
												"col": 1,
												"row": 7
											}
										},
										{
											"type": "MakeObjectStmt",
											"stmt": {
												"target": 5,
												"file": 0,
												"col": 1,
												"row": 7
											}
										},
										{
											"type": "MakeSetStmt",
											"stmt": {
												"target": 6,
												"file": 0,
												"col": 1,
												"row": 7
											}
										},
										{
											"type": "MakeNumberRefStmt",
											"stmt": {
												"Index": 3,
												"target": 7,
												"file": 0,
												"col": 1,
												"row": 7
											}
										},
										{
											"type": "SetAddStmt",
											"stmt": {
												"value": {
													"type": "local",
													"value": 7
												},
												"set": 6,
												"file": 0,
												"col": 1,
												"row": 7
											}
										},
										{
											"type": "MakeNumberRefStmt",
											"stmt": {
												"Index": 4,
												"target": 8,
												"file": 0,
												"col": 1,
												"row": 7
											}
										},
										{
											"type": "SetAddStmt",
											"stmt": {
												"value": {
													"type": "local",
													"value": 8
												},
												"set": 6,
												"file": 0,
												"col": 1,
												"row": 7
											}
										},
										{
											"type": "MakeNumberRefStmt",
											"stmt": {
												"Index": 5,
												"target": 9,
												"file": 0,
												"col": 1,
												"row": 7
											}
										},
										{
											"type": "SetAddStmt",
											"stmt": {
												"value": {
													"type": "local",
													"value": 9
												},
												"set": 6,
												"file": 0,
												"col": 1,
												"row": 7
											}
										},
										{
											"type": "MakeNumberRefStmt",
											"stmt": {
												"Index": 6,
												"target": 10,
												"file": 0,
												"col": 1,
												"row": 7
											}
										},
										{
											"type": "SetAddStmt",
											"stmt": {
												"value": {
													"type": "local",
													"value": 10
												},
												"set": 6,
												"file": 0,
												"col": 1,
												"row": 7
											}
										},
										{
											"type": "ObjectInsertStmt",
											"stmt": {
												"key": {
													"type": "string_index",
													"value": 2
												},
												"value": {
													"type": "local",
													"value": 6
												},
												"object": 5,
												"file": 0,
												"col": 1,
												"row": 7
											}
										},
										{
											"type": "ObjectInsertStmt",
											"stmt": {
												"key": {
													"type": "string_index",
													"value": 1
												},
												"value": {
													"type": "local",
													"value": 5
												},
												"object": 4,
												"file": 0,
												"col": 1,
												"row": 7
											}
										},
										{
											"type": "MakeObjectStmt",
											"stmt": {
												"target": 11,
												"file": 0,
												"col": 1,
												"row": 7
											}
										},
										{
											"type": "ObjectInsertStmt",
											"stmt": {
												"key": {
													"type": "string_index",
													"value": 26
												},
												"value": {
													"type": "string_index",
													"value": 27
												},
												"object": 11,
												"file": 0,
												"col": 1,
												"row": 7
											}
										},
										{
											"type": "ObjectInsertStmt",
											"stmt": {
												"key": {
													"type": "string_index",
													"value": 8
												},
												"value": {
													"type": "string_index",
													"value": 9
												},
												"object": 11,
												"file": 0,
												"col": 1,
												"row": 7
											}
										},
										{
											"type": "ObjectInsertStmt",
											"stmt": {
												"key": {
													"type": "string_index",
													"value": 28
												},
												"value": {
													"type": "string_index",
													"value": 29
												},
												"object": 11,
												"file": 0,
												"col": 1,
												"row": 7
											}
										},
										{
											"type": "ObjectInsertStmt",
											"stmt": {
												"key": {
													"type": "string_index",
													"value": 10
												},
												"value": {
													"type": "string_index",
													"value": 30
												},
												"object": 11,
												"file": 0,
												"col": 1,
												"row": 7
											}
										},
										{
											"type": "ObjectInsertStmt",
											"stmt": {
												"key": {
													"type": "string_index",
													"value": 31
												},
												"value": {
													"type": "string_index",
													"value": 32
												},
												"object": 11,
												"file": 0,
												"col": 1,
												"row": 7
											}
										},
										{
											"type": "ObjectInsertStmt",
											"stmt": {
												"key": {
													"type": "string_index",
													"value": 7
												},
												"value": {
													"type": "local",
													"value": 11
												},
												"object": 4,
												"file": 0,
												"col": 1,
												"row": 7
											}
										},
										{
											"type": "ObjectInsertStmt",
											"stmt": {
												"key": {
													"type": "string_index",
													"value": 12
												},
												"value": {
													"type": "string_index",
													"value": 13
												},
												"object": 4,
												"file": 0,
												"col": 1,
												"row": 7
											}
										},
										{
											"type": "ObjectInsertStmt",
											"stmt": {
												"key": {
													"type": "string_index",
													"value": 14
												},
												"value": {
													"type": "string_index",
													"value": 15
												},
												"object": 4,
												"file": 0,
												"col": 1,
												"row": 7
											}
										},
										{
											"type": "AssignVarOnceStmt",
											"stmt": {
												"source": {
													"type": "local",
													"value": 4
												},
												"target": 3,
												"file": 0,
												"col": 1,
												"row": 7
											}
										}
									]
								},
								{
									"stmts": [
										{
											"type": "IsDefinedStmt",
											"stmt": {
												"source": 3,
												"file": 0,
												"col": 1,
												"row": 7
											}
										},
										{
											"type": "AssignVarOnceStmt",
											"stmt": {
												"source": {
													"type": "local",
													"value": 3
												},
												"target": 2,
												"file": 0,
												"col": 1,
												"row": 7
											}
										}
									]
								},
								{
									"stmts": [
										{
											"type": "ReturnLocalStmt",
											"stmt": {
												"source": 2,
												"file": 0,
												"col": 1,
												"row": 7
											}
										}
									]
								}
							],
							"path": [
								"g0",
								"test",
								"expected"
							]
						},
						{
							"name": "g0.data.test.p",
							"params": [
								0,
								1
							],
							"return": 2,
							"blocks": [
								{
									"stmts": [
										{
											"type": "ResetLocalStmt",
											"stmt": {
												"target": 3,
												"file": 0,
												"col": 1,
												"row": 20
											}
										},
										{
											"type": "CallStmt",
											"stmt": {
												"func": "g0.data.test.req",
												"args": [
													{
														"type": "local",
														"value": 0
													},
													{
														"type": "local",
														"value": 1
													}
												],
												"result": 4,
												"file": 0,
												"col": 25,
												"row": 21
											}
										},
										{
											"type": "AssignVarStmt",
											"stmt": {
												"source": {
													"type": "local",
													"value": 4
												},
												"target": 5,
												"file": 0,
												"col": 25,
												"row": 21
											}
										},
										{
											"type": "CallStmt",
											"stmt": {
												"func": "g0.data.test.aws_config",
												"args": [
													{
														"type": "local",
														"value": 0
													},
													{
														"type": "local",
														"value": 1
													}
												],
												"result": 6,
												"file": 0,
												"col": 30,
												"row": 21
											}
										},
										{
											"type": "AssignVarStmt",
											"stmt": {
												"source": {
													"type": "local",
													"value": 6
												},
												"target": 7,
												"file": 0,
												"col": 30,
												"row": 21
											}
										},
										{
											"type": "MakeNumberRefStmt",
											"stmt": {
												"Index": 25,
												"target": 8,
												"file": 0,
												"col": 2,
												"row": 21
											}
										},
										{
											"type": "CallStmt",
											"stmt": {
												"func": "providers.aws.sign_req",
												"args": [
													{
														"type": "local",
														"value": 5
													},
													{
														"type": "local",
														"value": 7
													},
													{
														"type": "local",
														"value": 8
													}
												],
												"result": 9,
												"file": 0,
												"col": 2,
												"row": 21
											}
										},
										{
											"type": "AssignVarStmt",
											"stmt": {
												"source": {
													"type": "local",
													"value": 9
												},
												"target": 10,
												"file": 0,
												"col": 2,
												"row": 21
											}
										},
										{
											"type": "CallStmt",
											"stmt": {
												"func": "g0.data.test.expected",
												"args": [
													{
														"type": "local",
														"value": 0
													},
													{
														"type": "local",
														"value": 1
													}
												],
												"result": 11,
												"file": 0,
												"col": 2,
												"row": 21
											}
										},
										{
											"type": "EqualStmt",
											"stmt": {
												"a": {
													"type": "local",
													"value": 10
												},
												"b": {
													"type": "local",
													"value": 11
												},
												"file": 0,
												"col": 2,
												"row": 21
											}
										},
										{
											"type": "AssignVarOnceStmt",
											"stmt": {
												"source": {
													"type": "bool",
													"value": true
												},
												"target": 3,
												"file": 0,
												"col": 1,
												"row": 20
											}
										}
									]
								},
								{
									"stmts": [
										{
											"type": "IsDefinedStmt",
											"stmt": {
												"source": 3,
												"file": 0,
												"col": 1,
												"row": 20
											}
										},
										{
											"type": "AssignVarOnceStmt",
											"stmt": {
												"source": {
													"type": "local",
													"value": 3
												},
												"target": 2,
												"file": 0,
												"col": 1,
												"row": 20
											}
										}
									]
								},
								{
									"stmts": [
										{
											"type": "ReturnLocalStmt",
											"stmt": {
												"source": 2,
												"file": 0,
												"col": 1,
												"row": 20
											}
										}
									]
								}
							],
							"path": [
								"g0",
								"test",
								"p"
							]
						}
					]
				}
			},
			"want_plan_result": [
				{
					"x": true
				}
			]
		}
	]
}